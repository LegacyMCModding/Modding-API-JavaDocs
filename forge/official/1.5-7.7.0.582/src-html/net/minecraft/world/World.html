<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span>package net.minecraft.world;<a name="line.1"></a>
<span class="sourceLineNo">002</span><a name="line.2"></a>
<span class="sourceLineNo">003</span>import cpw.mods.fml.common.FMLLog;<a name="line.3"></a>
<span class="sourceLineNo">004</span>import cpw.mods.fml.relauncher.Side;<a name="line.4"></a>
<span class="sourceLineNo">005</span>import cpw.mods.fml.relauncher.SideOnly;<a name="line.5"></a>
<span class="sourceLineNo">006</span>import java.util.ArrayList;<a name="line.6"></a>
<span class="sourceLineNo">007</span>import java.util.Calendar;<a name="line.7"></a>
<span class="sourceLineNo">008</span>import java.util.Collection;<a name="line.8"></a>
<span class="sourceLineNo">009</span>import java.util.HashSet;<a name="line.9"></a>
<span class="sourceLineNo">010</span>import java.util.Iterator;<a name="line.10"></a>
<span class="sourceLineNo">011</span>import java.util.List;<a name="line.11"></a>
<span class="sourceLineNo">012</span>import java.util.Random;<a name="line.12"></a>
<span class="sourceLineNo">013</span>import java.util.Set;<a name="line.13"></a>
<span class="sourceLineNo">014</span>import net.minecraft.block.Block;<a name="line.14"></a>
<span class="sourceLineNo">015</span>import net.minecraft.block.BlockFluid;<a name="line.15"></a>
<span class="sourceLineNo">016</span>import net.minecraft.block.BlockHalfSlab;<a name="line.16"></a>
<span class="sourceLineNo">017</span>import net.minecraft.block.BlockHopper;<a name="line.17"></a>
<span class="sourceLineNo">018</span>import net.minecraft.block.BlockSnow;<a name="line.18"></a>
<span class="sourceLineNo">019</span>import net.minecraft.block.BlockStairs;<a name="line.19"></a>
<span class="sourceLineNo">020</span>import net.minecraft.block.material.Material;<a name="line.20"></a>
<span class="sourceLineNo">021</span>import net.minecraft.command.IEntitySelector;<a name="line.21"></a>
<span class="sourceLineNo">022</span>import net.minecraft.crash.CrashReport;<a name="line.22"></a>
<span class="sourceLineNo">023</span>import net.minecraft.crash.CrashReportCategory;<a name="line.23"></a>
<span class="sourceLineNo">024</span>import net.minecraft.entity.Entity;<a name="line.24"></a>
<span class="sourceLineNo">025</span>import net.minecraft.entity.item.EntityMinecart;<a name="line.25"></a>
<span class="sourceLineNo">026</span>import net.minecraft.entity.player.EntityPlayer;<a name="line.26"></a>
<span class="sourceLineNo">027</span>import net.minecraft.item.ItemStack;<a name="line.27"></a>
<span class="sourceLineNo">028</span>import net.minecraft.logging.ILogAgent;<a name="line.28"></a>
<span class="sourceLineNo">029</span>import net.minecraft.nbt.NBTTagCompound;<a name="line.29"></a>
<span class="sourceLineNo">030</span>import net.minecraft.pathfinding.PathEntity;<a name="line.30"></a>
<span class="sourceLineNo">031</span>import net.minecraft.pathfinding.PathFinder;<a name="line.31"></a>
<span class="sourceLineNo">032</span>import net.minecraft.profiler.Profiler;<a name="line.32"></a>
<span class="sourceLineNo">033</span>import net.minecraft.scoreboard.Scoreboard;<a name="line.33"></a>
<span class="sourceLineNo">034</span>import net.minecraft.server.gui.IUpdatePlayerListBox;<a name="line.34"></a>
<span class="sourceLineNo">035</span>import net.minecraft.tileentity.TileEntity;<a name="line.35"></a>
<span class="sourceLineNo">036</span>import net.minecraft.util.AxisAlignedBB;<a name="line.36"></a>
<span class="sourceLineNo">037</span>import net.minecraft.util.ChunkCoordinates;<a name="line.37"></a>
<span class="sourceLineNo">038</span>import net.minecraft.util.Direction;<a name="line.38"></a>
<span class="sourceLineNo">039</span>import net.minecraft.util.Facing;<a name="line.39"></a>
<span class="sourceLineNo">040</span>import net.minecraft.util.MathHelper;<a name="line.40"></a>
<span class="sourceLineNo">041</span>import net.minecraft.util.MovingObjectPosition;<a name="line.41"></a>
<span class="sourceLineNo">042</span>import net.minecraft.util.ReportedException;<a name="line.42"></a>
<span class="sourceLineNo">043</span>import net.minecraft.util.Vec3;<a name="line.43"></a>
<span class="sourceLineNo">044</span>import net.minecraft.util.Vec3Pool;<a name="line.44"></a>
<span class="sourceLineNo">045</span>import net.minecraft.village.VillageCollection;<a name="line.45"></a>
<span class="sourceLineNo">046</span>import net.minecraft.village.VillageSiege;<a name="line.46"></a>
<span class="sourceLineNo">047</span>import net.minecraft.world.biome.BiomeGenBase;<a name="line.47"></a>
<span class="sourceLineNo">048</span>import net.minecraft.world.biome.WorldChunkManager;<a name="line.48"></a>
<span class="sourceLineNo">049</span>import net.minecraft.world.chunk.Chunk;<a name="line.49"></a>
<span class="sourceLineNo">050</span>import net.minecraft.world.chunk.IChunkProvider;<a name="line.50"></a>
<span class="sourceLineNo">051</span>import net.minecraft.world.storage.ISaveHandler;<a name="line.51"></a>
<span class="sourceLineNo">052</span>import net.minecraft.world.storage.MapStorage;<a name="line.52"></a>
<span class="sourceLineNo">053</span>import net.minecraft.world.storage.WorldInfo;<a name="line.53"></a>
<span class="sourceLineNo">054</span><a name="line.54"></a>
<span class="sourceLineNo">055</span>import com.google.common.collect.ImmutableSetMultimap;<a name="line.55"></a>
<span class="sourceLineNo">056</span><a name="line.56"></a>
<span class="sourceLineNo">057</span>import net.minecraftforge.common.ForgeChunkManager;<a name="line.57"></a>
<span class="sourceLineNo">058</span>import net.minecraftforge.common.ForgeChunkManager.Ticket;<a name="line.58"></a>
<span class="sourceLineNo">059</span>import net.minecraftforge.common.ForgeDummyContainer;<a name="line.59"></a>
<span class="sourceLineNo">060</span>import net.minecraftforge.common.ForgeHooks;<a name="line.60"></a>
<span class="sourceLineNo">061</span>import net.minecraftforge.common.MinecraftForge;<a name="line.61"></a>
<span class="sourceLineNo">062</span>import net.minecraftforge.common.ForgeDirection;<a name="line.62"></a>
<span class="sourceLineNo">063</span>import net.minecraftforge.common.WorldSpecificSaveHandler;<a name="line.63"></a>
<span class="sourceLineNo">064</span>import net.minecraftforge.event.entity.EntityEvent;<a name="line.64"></a>
<span class="sourceLineNo">065</span>import net.minecraftforge.event.entity.EntityJoinWorldEvent;<a name="line.65"></a>
<span class="sourceLineNo">066</span>import net.minecraftforge.event.world.WorldEvent;<a name="line.66"></a>
<span class="sourceLineNo">067</span>import net.minecraftforge.event.entity.PlaySoundAtEntityEvent;<a name="line.67"></a>
<span class="sourceLineNo">068</span>import net.minecraft.entity.EnumCreatureType;<a name="line.68"></a>
<span class="sourceLineNo">069</span><a name="line.69"></a>
<span class="sourceLineNo">070</span>public abstract class World implements IBlockAccess<a name="line.70"></a>
<span class="sourceLineNo">071</span>{<a name="line.71"></a>
<span class="sourceLineNo">072</span>    /**<a name="line.72"></a>
<span class="sourceLineNo">073</span>     * Used in the getEntitiesWithinAABB functions to expand the search area for entities.<a name="line.73"></a>
<span class="sourceLineNo">074</span>     * Modders should change this variable to a higher value if it is less then the radius<a name="line.74"></a>
<span class="sourceLineNo">075</span>     * of one of there entities.<a name="line.75"></a>
<span class="sourceLineNo">076</span>     */<a name="line.76"></a>
<span class="sourceLineNo">077</span>    public static double MAX_ENTITY_RADIUS = 2.0D;<a name="line.77"></a>
<span class="sourceLineNo">078</span><a name="line.78"></a>
<span class="sourceLineNo">079</span>    public final MapStorage perWorldStorage;<a name="line.79"></a>
<span class="sourceLineNo">080</span><a name="line.80"></a>
<span class="sourceLineNo">081</span>    /**<a name="line.81"></a>
<span class="sourceLineNo">082</span>     * boolean; if true updates scheduled by scheduleBlockUpdate happen immediately<a name="line.82"></a>
<span class="sourceLineNo">083</span>     */<a name="line.83"></a>
<span class="sourceLineNo">084</span>    public boolean scheduledUpdatesAreImmediate = false;<a name="line.84"></a>
<span class="sourceLineNo">085</span><a name="line.85"></a>
<span class="sourceLineNo">086</span>    /** A list of all Entities in all currently-loaded chunks */<a name="line.86"></a>
<span class="sourceLineNo">087</span>    public List loadedEntityList = new ArrayList();<a name="line.87"></a>
<span class="sourceLineNo">088</span>    protected List unloadedEntityList = new ArrayList();<a name="line.88"></a>
<span class="sourceLineNo">089</span><a name="line.89"></a>
<span class="sourceLineNo">090</span>    /** A list of all TileEntities in all currently-loaded chunks */<a name="line.90"></a>
<span class="sourceLineNo">091</span>    public List loadedTileEntityList = new ArrayList();<a name="line.91"></a>
<span class="sourceLineNo">092</span>    private List addedTileEntityList = new ArrayList();<a name="line.92"></a>
<span class="sourceLineNo">093</span><a name="line.93"></a>
<span class="sourceLineNo">094</span>    /** Entities marked for removal. */<a name="line.94"></a>
<span class="sourceLineNo">095</span>    private List entityRemoval = new ArrayList();<a name="line.95"></a>
<span class="sourceLineNo">096</span><a name="line.96"></a>
<span class="sourceLineNo">097</span>    /** Array list of players in the world. */<a name="line.97"></a>
<span class="sourceLineNo">098</span>    public List playerEntities = new ArrayList();<a name="line.98"></a>
<span class="sourceLineNo">099</span><a name="line.99"></a>
<span class="sourceLineNo">100</span>    /** a list of all the lightning entities */<a name="line.100"></a>
<span class="sourceLineNo">101</span>    public List weatherEffects = new ArrayList();<a name="line.101"></a>
<span class="sourceLineNo">102</span>    private long cloudColour = 16777215L;<a name="line.102"></a>
<span class="sourceLineNo">103</span><a name="line.103"></a>
<span class="sourceLineNo">104</span>    /** How much light is subtracted from full daylight */<a name="line.104"></a>
<span class="sourceLineNo">105</span>    public int skylightSubtracted = 0;<a name="line.105"></a>
<span class="sourceLineNo">106</span><a name="line.106"></a>
<span class="sourceLineNo">107</span>    /**<a name="line.107"></a>
<span class="sourceLineNo">108</span>     * Contains the current Linear Congruential Generator seed for block updates. Used with an A value of 3 and a C<a name="line.108"></a>
<span class="sourceLineNo">109</span>     * value of 0x3c6ef35f, producing a highly planar series of values ill-suited for choosing random blocks in a<a name="line.109"></a>
<span class="sourceLineNo">110</span>     * 16x128x16 field.<a name="line.110"></a>
<span class="sourceLineNo">111</span>     */<a name="line.111"></a>
<span class="sourceLineNo">112</span>    protected int updateLCG = (new Random()).nextInt();<a name="line.112"></a>
<span class="sourceLineNo">113</span><a name="line.113"></a>
<span class="sourceLineNo">114</span>    /**<a name="line.114"></a>
<span class="sourceLineNo">115</span>     * magic number used to generate fast random numbers for 3d distribution within a chunk<a name="line.115"></a>
<span class="sourceLineNo">116</span>     */<a name="line.116"></a>
<span class="sourceLineNo">117</span>    protected final int DIST_HASH_MAGIC = 1013904223;<a name="line.117"></a>
<span class="sourceLineNo">118</span>    public float prevRainingStrength;<a name="line.118"></a>
<span class="sourceLineNo">119</span>    public float rainingStrength;<a name="line.119"></a>
<span class="sourceLineNo">120</span>    public float prevThunderingStrength;<a name="line.120"></a>
<span class="sourceLineNo">121</span>    public float thunderingStrength;<a name="line.121"></a>
<span class="sourceLineNo">122</span><a name="line.122"></a>
<span class="sourceLineNo">123</span>    /**<a name="line.123"></a>
<span class="sourceLineNo">124</span>     * Set to 2 whenever a lightning bolt is generated in SSP. Decrements if &gt; 0 in updateWeather(). Value appears to be<a name="line.124"></a>
<span class="sourceLineNo">125</span>     * unused.<a name="line.125"></a>
<span class="sourceLineNo">126</span>     */<a name="line.126"></a>
<span class="sourceLineNo">127</span>    public int lastLightningBolt = 0;<a name="line.127"></a>
<span class="sourceLineNo">128</span><a name="line.128"></a>
<span class="sourceLineNo">129</span>    /** Option &gt; Difficulty setting (0 - 3) */<a name="line.129"></a>
<span class="sourceLineNo">130</span>    public int difficultySetting;<a name="line.130"></a>
<span class="sourceLineNo">131</span><a name="line.131"></a>
<span class="sourceLineNo">132</span>    /** RNG for World. */<a name="line.132"></a>
<span class="sourceLineNo">133</span>    public Random rand = new Random();<a name="line.133"></a>
<span class="sourceLineNo">134</span><a name="line.134"></a>
<span class="sourceLineNo">135</span>    /** The WorldProvider instance that World uses. */<a name="line.135"></a>
<span class="sourceLineNo">136</span>    public final WorldProvider provider;<a name="line.136"></a>
<span class="sourceLineNo">137</span>    protected List worldAccesses = new ArrayList();<a name="line.137"></a>
<span class="sourceLineNo">138</span><a name="line.138"></a>
<span class="sourceLineNo">139</span>    /** Handles chunk operations and caching */<a name="line.139"></a>
<span class="sourceLineNo">140</span>    protected IChunkProvider chunkProvider;<a name="line.140"></a>
<span class="sourceLineNo">141</span>    protected final ISaveHandler saveHandler;<a name="line.141"></a>
<span class="sourceLineNo">142</span><a name="line.142"></a>
<span class="sourceLineNo">143</span>    /**<a name="line.143"></a>
<span class="sourceLineNo">144</span>     * holds information about a world (size on disk, time, spawn point, seed, ...)<a name="line.144"></a>
<span class="sourceLineNo">145</span>     */<a name="line.145"></a>
<span class="sourceLineNo">146</span>    protected WorldInfo worldInfo;<a name="line.146"></a>
<span class="sourceLineNo">147</span><a name="line.147"></a>
<span class="sourceLineNo">148</span>    /** Boolean that is set to true when trying to find a spawn point */<a name="line.148"></a>
<span class="sourceLineNo">149</span>    public boolean findingSpawnPoint;<a name="line.149"></a>
<span class="sourceLineNo">150</span>    public MapStorage mapStorage;<a name="line.150"></a>
<span class="sourceLineNo">151</span>    public VillageCollection villageCollectionObj;<a name="line.151"></a>
<span class="sourceLineNo">152</span>    protected final VillageSiege villageSiegeObj = new VillageSiege(this);<a name="line.152"></a>
<span class="sourceLineNo">153</span>    public final Profiler theProfiler;<a name="line.153"></a>
<span class="sourceLineNo">154</span><a name="line.154"></a>
<span class="sourceLineNo">155</span>    /** The world-local pool of vectors */<a name="line.155"></a>
<span class="sourceLineNo">156</span>    private final Vec3Pool vecPool = new Vec3Pool(300, 2000);<a name="line.156"></a>
<span class="sourceLineNo">157</span>    private final Calendar theCalendar = Calendar.getInstance();<a name="line.157"></a>
<span class="sourceLineNo">158</span>    protected Scoreboard field_96442_D = new Scoreboard();<a name="line.158"></a>
<span class="sourceLineNo">159</span>    private final ILogAgent field_98181_L;<a name="line.159"></a>
<span class="sourceLineNo">160</span>    private ArrayList collidingBoundingBoxes = new ArrayList();<a name="line.160"></a>
<span class="sourceLineNo">161</span>    private boolean scanningTileEntities;<a name="line.161"></a>
<span class="sourceLineNo">162</span><a name="line.162"></a>
<span class="sourceLineNo">163</span>    /** indicates if enemies are spawned or not */<a name="line.163"></a>
<span class="sourceLineNo">164</span>    protected boolean spawnHostileMobs = true;<a name="line.164"></a>
<span class="sourceLineNo">165</span><a name="line.165"></a>
<span class="sourceLineNo">166</span>    /** A flag indicating whether we should spawn peaceful mobs. */<a name="line.166"></a>
<span class="sourceLineNo">167</span>    protected boolean spawnPeacefulMobs = true;<a name="line.167"></a>
<span class="sourceLineNo">168</span><a name="line.168"></a>
<span class="sourceLineNo">169</span>    /** Positions to update */<a name="line.169"></a>
<span class="sourceLineNo">170</span>    public Set activeChunkSet = new HashSet();<a name="line.170"></a>
<span class="sourceLineNo">171</span><a name="line.171"></a>
<span class="sourceLineNo">172</span>    /** number of ticks until the next random ambients play */<a name="line.172"></a>
<span class="sourceLineNo">173</span>    private int ambientTickCountdown;<a name="line.173"></a>
<span class="sourceLineNo">174</span><a name="line.174"></a>
<span class="sourceLineNo">175</span>    /**<a name="line.175"></a>
<span class="sourceLineNo">176</span>     * is a temporary list of blocks and light values used when updating light levels. Holds up to 32x32x32 blocks (the<a name="line.176"></a>
<span class="sourceLineNo">177</span>     * maximum influence of a light source.) Every element is a packed bit value: 0000000000LLLLzzzzzzyyyyyyxxxxxx. The<a name="line.177"></a>
<span class="sourceLineNo">178</span>     * 4-bit L is a light level used when darkening blocks. 6-bit numbers x, y and z represent the block's offset from<a name="line.178"></a>
<span class="sourceLineNo">179</span>     * the original block, plus 32 (i.e. value of 31 would mean a -1 offset<a name="line.179"></a>
<span class="sourceLineNo">180</span>     */<a name="line.180"></a>
<span class="sourceLineNo">181</span>    int[] lightUpdateBlockList;<a name="line.181"></a>
<span class="sourceLineNo">182</span><a name="line.182"></a>
<span class="sourceLineNo">183</span>    /** This is set to true for client worlds, and false for server worlds. */<a name="line.183"></a>
<span class="sourceLineNo">184</span>    public boolean isRemote;<a name="line.184"></a>
<span class="sourceLineNo">185</span><a name="line.185"></a>
<span class="sourceLineNo">186</span>    /**<a name="line.186"></a>
<span class="sourceLineNo">187</span>     * Gets the biome for a given set of x/z coordinates<a name="line.187"></a>
<span class="sourceLineNo">188</span>     */<a name="line.188"></a>
<span class="sourceLineNo">189</span>    public BiomeGenBase getBiomeGenForCoords(int par1, int par2)<a name="line.189"></a>
<span class="sourceLineNo">190</span>    {<a name="line.190"></a>
<span class="sourceLineNo">191</span>        return provider.getBiomeGenForCoords(par1, par2);<a name="line.191"></a>
<span class="sourceLineNo">192</span>    }<a name="line.192"></a>
<span class="sourceLineNo">193</span><a name="line.193"></a>
<span class="sourceLineNo">194</span>    public BiomeGenBase getBiomeGenForCoordsBody(int par1, int par2)<a name="line.194"></a>
<span class="sourceLineNo">195</span>    {<a name="line.195"></a>
<span class="sourceLineNo">196</span>        if (this.blockExists(par1, 0, par2))<a name="line.196"></a>
<span class="sourceLineNo">197</span>        {<a name="line.197"></a>
<span class="sourceLineNo">198</span>            Chunk chunk = this.getChunkFromBlockCoords(par1, par2);<a name="line.198"></a>
<span class="sourceLineNo">199</span><a name="line.199"></a>
<span class="sourceLineNo">200</span>            if (chunk != null)<a name="line.200"></a>
<span class="sourceLineNo">201</span>            {<a name="line.201"></a>
<span class="sourceLineNo">202</span>                return chunk.getBiomeGenForWorldCoords(par1 &amp; 15, par2 &amp; 15, this.provider.worldChunkMgr);<a name="line.202"></a>
<span class="sourceLineNo">203</span>            }<a name="line.203"></a>
<span class="sourceLineNo">204</span>        }<a name="line.204"></a>
<span class="sourceLineNo">205</span><a name="line.205"></a>
<span class="sourceLineNo">206</span>        return this.provider.worldChunkMgr.getBiomeGenAt(par1, par2);<a name="line.206"></a>
<span class="sourceLineNo">207</span>    }<a name="line.207"></a>
<span class="sourceLineNo">208</span><a name="line.208"></a>
<span class="sourceLineNo">209</span>    public WorldChunkManager getWorldChunkManager()<a name="line.209"></a>
<span class="sourceLineNo">210</span>    {<a name="line.210"></a>
<span class="sourceLineNo">211</span>        return this.provider.worldChunkMgr;<a name="line.211"></a>
<span class="sourceLineNo">212</span>    }<a name="line.212"></a>
<span class="sourceLineNo">213</span><a name="line.213"></a>
<span class="sourceLineNo">214</span>    @SideOnly(Side.CLIENT)<a name="line.214"></a>
<span class="sourceLineNo">215</span>    public World(ISaveHandler par1ISaveHandler, String par2Str, WorldProvider par3WorldProvider, WorldSettings par4WorldSettings, Profiler par5Profiler, ILogAgent par6ILogAgent)<a name="line.215"></a>
<span class="sourceLineNo">216</span>    {<a name="line.216"></a>
<span class="sourceLineNo">217</span>        this.ambientTickCountdown = this.rand.nextInt(12000);<a name="line.217"></a>
<span class="sourceLineNo">218</span>        this.lightUpdateBlockList = new int[32768];<a name="line.218"></a>
<span class="sourceLineNo">219</span>        this.isRemote = false;<a name="line.219"></a>
<span class="sourceLineNo">220</span>        this.saveHandler = par1ISaveHandler;<a name="line.220"></a>
<span class="sourceLineNo">221</span>        this.theProfiler = par5Profiler;<a name="line.221"></a>
<span class="sourceLineNo">222</span>        this.worldInfo = new WorldInfo(par4WorldSettings, par2Str);<a name="line.222"></a>
<span class="sourceLineNo">223</span>        this.provider = par3WorldProvider;<a name="line.223"></a>
<span class="sourceLineNo">224</span>        perWorldStorage = new MapStorage((ISaveHandler)null);<a name="line.224"></a>
<span class="sourceLineNo">225</span>        this.field_98181_L = par6ILogAgent;<a name="line.225"></a>
<span class="sourceLineNo">226</span>    }<a name="line.226"></a>
<span class="sourceLineNo">227</span><a name="line.227"></a>
<span class="sourceLineNo">228</span>    // Broken up so that the WorldClient gets the chance to set the mapstorage object before the dimension initializes<a name="line.228"></a>
<span class="sourceLineNo">229</span>    @SideOnly(Side.CLIENT)<a name="line.229"></a>
<span class="sourceLineNo">230</span>    protected void finishSetup()<a name="line.230"></a>
<span class="sourceLineNo">231</span>    {<a name="line.231"></a>
<span class="sourceLineNo">232</span>        VillageCollection villagecollection = (VillageCollection)this.mapStorage.loadData(VillageCollection.class, "villages");<a name="line.232"></a>
<span class="sourceLineNo">233</span><a name="line.233"></a>
<span class="sourceLineNo">234</span>        if (villagecollection == null)<a name="line.234"></a>
<span class="sourceLineNo">235</span>        {<a name="line.235"></a>
<span class="sourceLineNo">236</span>            this.villageCollectionObj = new VillageCollection(this);<a name="line.236"></a>
<span class="sourceLineNo">237</span>            this.mapStorage.setData("villages", this.villageCollectionObj);<a name="line.237"></a>
<span class="sourceLineNo">238</span>        }<a name="line.238"></a>
<span class="sourceLineNo">239</span>        else<a name="line.239"></a>
<span class="sourceLineNo">240</span>        {<a name="line.240"></a>
<span class="sourceLineNo">241</span>            this.villageCollectionObj = villagecollection;<a name="line.241"></a>
<span class="sourceLineNo">242</span>            this.villageCollectionObj.func_82566_a(this);<a name="line.242"></a>
<span class="sourceLineNo">243</span>        }<a name="line.243"></a>
<span class="sourceLineNo">244</span><a name="line.244"></a>
<span class="sourceLineNo">245</span>        this.provider.registerWorld(this);<a name="line.245"></a>
<span class="sourceLineNo">246</span>        this.chunkProvider = this.createChunkProvider();<a name="line.246"></a>
<span class="sourceLineNo">247</span>        this.calculateInitialSkylight();<a name="line.247"></a>
<span class="sourceLineNo">248</span>        this.calculateInitialWeather();<a name="line.248"></a>
<span class="sourceLineNo">249</span>    }<a name="line.249"></a>
<span class="sourceLineNo">250</span><a name="line.250"></a>
<span class="sourceLineNo">251</span>    public World(ISaveHandler par1ISaveHandler, String par2Str, WorldSettings par3WorldSettings, WorldProvider par4WorldProvider, Profiler par5Profiler, ILogAgent par6ILogAgent)<a name="line.251"></a>
<span class="sourceLineNo">252</span>    {<a name="line.252"></a>
<span class="sourceLineNo">253</span>        this.ambientTickCountdown = this.rand.nextInt(12000);<a name="line.253"></a>
<span class="sourceLineNo">254</span>        this.lightUpdateBlockList = new int[32768];<a name="line.254"></a>
<span class="sourceLineNo">255</span>        this.isRemote = false;<a name="line.255"></a>
<span class="sourceLineNo">256</span>        this.saveHandler = par1ISaveHandler;<a name="line.256"></a>
<span class="sourceLineNo">257</span>        this.theProfiler = par5Profiler;<a name="line.257"></a>
<span class="sourceLineNo">258</span>        this.mapStorage = getMapStorage(par1ISaveHandler);<a name="line.258"></a>
<span class="sourceLineNo">259</span>        this.field_98181_L = par6ILogAgent;<a name="line.259"></a>
<span class="sourceLineNo">260</span>        this.worldInfo = par1ISaveHandler.loadWorldInfo();<a name="line.260"></a>
<span class="sourceLineNo">261</span><a name="line.261"></a>
<span class="sourceLineNo">262</span>        if (par4WorldProvider != null)<a name="line.262"></a>
<span class="sourceLineNo">263</span>        {<a name="line.263"></a>
<span class="sourceLineNo">264</span>            this.provider = par4WorldProvider;<a name="line.264"></a>
<span class="sourceLineNo">265</span>        }<a name="line.265"></a>
<span class="sourceLineNo">266</span>        else if (this.worldInfo != null &amp;&amp; this.worldInfo.getDimension() != 0)<a name="line.266"></a>
<span class="sourceLineNo">267</span>        {<a name="line.267"></a>
<span class="sourceLineNo">268</span>            this.provider = WorldProvider.getProviderForDimension(this.worldInfo.getDimension());<a name="line.268"></a>
<span class="sourceLineNo">269</span>        }<a name="line.269"></a>
<span class="sourceLineNo">270</span>        else<a name="line.270"></a>
<span class="sourceLineNo">271</span>        {<a name="line.271"></a>
<span class="sourceLineNo">272</span>            this.provider = WorldProvider.getProviderForDimension(0);<a name="line.272"></a>
<span class="sourceLineNo">273</span>        }<a name="line.273"></a>
<span class="sourceLineNo">274</span><a name="line.274"></a>
<span class="sourceLineNo">275</span>        if (this.worldInfo == null)<a name="line.275"></a>
<span class="sourceLineNo">276</span>        {<a name="line.276"></a>
<span class="sourceLineNo">277</span>            this.worldInfo = new WorldInfo(par3WorldSettings, par2Str);<a name="line.277"></a>
<span class="sourceLineNo">278</span>        }<a name="line.278"></a>
<span class="sourceLineNo">279</span>        else<a name="line.279"></a>
<span class="sourceLineNo">280</span>        {<a name="line.280"></a>
<span class="sourceLineNo">281</span>            this.worldInfo.setWorldName(par2Str);<a name="line.281"></a>
<span class="sourceLineNo">282</span>        }<a name="line.282"></a>
<span class="sourceLineNo">283</span><a name="line.283"></a>
<span class="sourceLineNo">284</span>        this.provider.registerWorld(this);<a name="line.284"></a>
<span class="sourceLineNo">285</span>        this.chunkProvider = this.createChunkProvider();<a name="line.285"></a>
<span class="sourceLineNo">286</span><a name="line.286"></a>
<span class="sourceLineNo">287</span>        if (!this.worldInfo.isInitialized())<a name="line.287"></a>
<span class="sourceLineNo">288</span>        {<a name="line.288"></a>
<span class="sourceLineNo">289</span>            try<a name="line.289"></a>
<span class="sourceLineNo">290</span>            {<a name="line.290"></a>
<span class="sourceLineNo">291</span>                this.initialize(par3WorldSettings);<a name="line.291"></a>
<span class="sourceLineNo">292</span>            }<a name="line.292"></a>
<span class="sourceLineNo">293</span>            catch (Throwable throwable)<a name="line.293"></a>
<span class="sourceLineNo">294</span>            {<a name="line.294"></a>
<span class="sourceLineNo">295</span>                CrashReport crashreport = CrashReport.makeCrashReport(throwable, "Exception initializing level");<a name="line.295"></a>
<span class="sourceLineNo">296</span><a name="line.296"></a>
<span class="sourceLineNo">297</span>                try<a name="line.297"></a>
<span class="sourceLineNo">298</span>                {<a name="line.298"></a>
<span class="sourceLineNo">299</span>                    this.addWorldInfoToCrashReport(crashreport);<a name="line.299"></a>
<span class="sourceLineNo">300</span>                }<a name="line.300"></a>
<span class="sourceLineNo">301</span>                catch (Throwable throwable1)<a name="line.301"></a>
<span class="sourceLineNo">302</span>                {<a name="line.302"></a>
<span class="sourceLineNo">303</span>                    ;<a name="line.303"></a>
<span class="sourceLineNo">304</span>                }<a name="line.304"></a>
<span class="sourceLineNo">305</span><a name="line.305"></a>
<span class="sourceLineNo">306</span>                throw new ReportedException(crashreport);<a name="line.306"></a>
<span class="sourceLineNo">307</span>            }<a name="line.307"></a>
<span class="sourceLineNo">308</span><a name="line.308"></a>
<span class="sourceLineNo">309</span>            this.worldInfo.setServerInitialized(true);<a name="line.309"></a>
<span class="sourceLineNo">310</span>        }<a name="line.310"></a>
<span class="sourceLineNo">311</span><a name="line.311"></a>
<span class="sourceLineNo">312</span>        if (this instanceof WorldServer)<a name="line.312"></a>
<span class="sourceLineNo">313</span>        {<a name="line.313"></a>
<span class="sourceLineNo">314</span>            this.perWorldStorage = new MapStorage(new WorldSpecificSaveHandler((WorldServer)this, par1ISaveHandler));<a name="line.314"></a>
<span class="sourceLineNo">315</span>        }<a name="line.315"></a>
<span class="sourceLineNo">316</span>        else<a name="line.316"></a>
<span class="sourceLineNo">317</span>        {<a name="line.317"></a>
<span class="sourceLineNo">318</span>            this.perWorldStorage = new MapStorage((ISaveHandler)null);<a name="line.318"></a>
<span class="sourceLineNo">319</span>        }<a name="line.319"></a>
<span class="sourceLineNo">320</span>        VillageCollection villagecollection = (VillageCollection)perWorldStorage.loadData(VillageCollection.class, "villages");<a name="line.320"></a>
<span class="sourceLineNo">321</span><a name="line.321"></a>
<span class="sourceLineNo">322</span>        if (villagecollection == null)<a name="line.322"></a>
<span class="sourceLineNo">323</span>        {<a name="line.323"></a>
<span class="sourceLineNo">324</span>            this.villageCollectionObj = new VillageCollection(this);<a name="line.324"></a>
<span class="sourceLineNo">325</span>            this.perWorldStorage.setData("villages", this.villageCollectionObj);<a name="line.325"></a>
<span class="sourceLineNo">326</span>        }<a name="line.326"></a>
<span class="sourceLineNo">327</span>        else<a name="line.327"></a>
<span class="sourceLineNo">328</span>        {<a name="line.328"></a>
<span class="sourceLineNo">329</span>            this.villageCollectionObj = villagecollection;<a name="line.329"></a>
<span class="sourceLineNo">330</span>            this.villageCollectionObj.func_82566_a(this);<a name="line.330"></a>
<span class="sourceLineNo">331</span>        }<a name="line.331"></a>
<span class="sourceLineNo">332</span><a name="line.332"></a>
<span class="sourceLineNo">333</span>        this.calculateInitialSkylight();<a name="line.333"></a>
<span class="sourceLineNo">334</span>        this.calculateInitialWeather();<a name="line.334"></a>
<span class="sourceLineNo">335</span>    }<a name="line.335"></a>
<span class="sourceLineNo">336</span><a name="line.336"></a>
<span class="sourceLineNo">337</span>    private static MapStorage s_mapStorage;<a name="line.337"></a>
<span class="sourceLineNo">338</span>    private static ISaveHandler s_savehandler;<a name="line.338"></a>
<span class="sourceLineNo">339</span>    //Provides a solution for different worlds getting different copies of the same data, potentially rewriting the data or causing race conditions/stale data<a name="line.339"></a>
<span class="sourceLineNo">340</span>    //Buildcraft has suffered from the issue this fixes.  If you load the same data from two different worlds they can get two different copies of the same object, thus the last saved gets final say.<a name="line.340"></a>
<span class="sourceLineNo">341</span>    private MapStorage getMapStorage(ISaveHandler savehandler)<a name="line.341"></a>
<span class="sourceLineNo">342</span>    {<a name="line.342"></a>
<span class="sourceLineNo">343</span>        if (s_savehandler != savehandler || s_mapStorage == null) {<a name="line.343"></a>
<span class="sourceLineNo">344</span>            s_mapStorage = new MapStorage(savehandler);<a name="line.344"></a>
<span class="sourceLineNo">345</span>            s_savehandler = savehandler;<a name="line.345"></a>
<span class="sourceLineNo">346</span>        }<a name="line.346"></a>
<span class="sourceLineNo">347</span>        return s_mapStorage;<a name="line.347"></a>
<span class="sourceLineNo">348</span>    }<a name="line.348"></a>
<span class="sourceLineNo">349</span><a name="line.349"></a>
<span class="sourceLineNo">350</span>    /**<a name="line.350"></a>
<span class="sourceLineNo">351</span>     * Creates the chunk provider for this world. Called in the constructor. Retrieves provider from worldProvider?<a name="line.351"></a>
<span class="sourceLineNo">352</span>     */<a name="line.352"></a>
<span class="sourceLineNo">353</span>    protected abstract IChunkProvider createChunkProvider();<a name="line.353"></a>
<span class="sourceLineNo">354</span><a name="line.354"></a>
<span class="sourceLineNo">355</span>    protected void initialize(WorldSettings par1WorldSettings)<a name="line.355"></a>
<span class="sourceLineNo">356</span>    {<a name="line.356"></a>
<span class="sourceLineNo">357</span>        this.worldInfo.setServerInitialized(true);<a name="line.357"></a>
<span class="sourceLineNo">358</span>    }<a name="line.358"></a>
<span class="sourceLineNo">359</span><a name="line.359"></a>
<span class="sourceLineNo">360</span>    @SideOnly(Side.CLIENT)<a name="line.360"></a>
<span class="sourceLineNo">361</span><a name="line.361"></a>
<span class="sourceLineNo">362</span>    /**<a name="line.362"></a>
<span class="sourceLineNo">363</span>     * Sets a new spawn location by finding an uncovered block at a random (x,z) location in the chunk.<a name="line.363"></a>
<span class="sourceLineNo">364</span>     */<a name="line.364"></a>
<span class="sourceLineNo">365</span>    public void setSpawnLocation()<a name="line.365"></a>
<span class="sourceLineNo">366</span>    {<a name="line.366"></a>
<span class="sourceLineNo">367</span>        this.setSpawnLocation(8, 64, 8);<a name="line.367"></a>
<span class="sourceLineNo">368</span>    }<a name="line.368"></a>
<span class="sourceLineNo">369</span><a name="line.369"></a>
<span class="sourceLineNo">370</span>    /**<a name="line.370"></a>
<span class="sourceLineNo">371</span>     * Returns the block ID of the first block at this (x,z) location with air above it, searching from sea level<a name="line.371"></a>
<span class="sourceLineNo">372</span>     * upwards.<a name="line.372"></a>
<span class="sourceLineNo">373</span>     */<a name="line.373"></a>
<span class="sourceLineNo">374</span>    public int getFirstUncoveredBlock(int par1, int par2)<a name="line.374"></a>
<span class="sourceLineNo">375</span>    {<a name="line.375"></a>
<span class="sourceLineNo">376</span>        int k;<a name="line.376"></a>
<span class="sourceLineNo">377</span><a name="line.377"></a>
<span class="sourceLineNo">378</span>        for (k = 63; !this.isAirBlock(par1, k + 1, par2); ++k)<a name="line.378"></a>
<span class="sourceLineNo">379</span>        {<a name="line.379"></a>
<span class="sourceLineNo">380</span>            ;<a name="line.380"></a>
<span class="sourceLineNo">381</span>        }<a name="line.381"></a>
<span class="sourceLineNo">382</span><a name="line.382"></a>
<span class="sourceLineNo">383</span>        return this.getBlockId(par1, k, par2);<a name="line.383"></a>
<span class="sourceLineNo">384</span>    }<a name="line.384"></a>
<span class="sourceLineNo">385</span><a name="line.385"></a>
<span class="sourceLineNo">386</span>    /**<a name="line.386"></a>
<span class="sourceLineNo">387</span>     * Returns the block ID at coords x,y,z<a name="line.387"></a>
<span class="sourceLineNo">388</span>     */<a name="line.388"></a>
<span class="sourceLineNo">389</span>    public int getBlockId(int par1, int par2, int par3)<a name="line.389"></a>
<span class="sourceLineNo">390</span>    {<a name="line.390"></a>
<span class="sourceLineNo">391</span>        if (par1 &gt;= -30000000 &amp;&amp; par3 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par3 &lt; 30000000)<a name="line.391"></a>
<span class="sourceLineNo">392</span>        {<a name="line.392"></a>
<span class="sourceLineNo">393</span>            if (par2 &lt; 0)<a name="line.393"></a>
<span class="sourceLineNo">394</span>            {<a name="line.394"></a>
<span class="sourceLineNo">395</span>                return 0;<a name="line.395"></a>
<span class="sourceLineNo">396</span>            }<a name="line.396"></a>
<span class="sourceLineNo">397</span>            else if (par2 &gt;= 256)<a name="line.397"></a>
<span class="sourceLineNo">398</span>            {<a name="line.398"></a>
<span class="sourceLineNo">399</span>                return 0;<a name="line.399"></a>
<span class="sourceLineNo">400</span>            }<a name="line.400"></a>
<span class="sourceLineNo">401</span>            else<a name="line.401"></a>
<span class="sourceLineNo">402</span>            {<a name="line.402"></a>
<span class="sourceLineNo">403</span>                Chunk chunk = null;<a name="line.403"></a>
<span class="sourceLineNo">404</span><a name="line.404"></a>
<span class="sourceLineNo">405</span>                try<a name="line.405"></a>
<span class="sourceLineNo">406</span>                {<a name="line.406"></a>
<span class="sourceLineNo">407</span>                    chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.407"></a>
<span class="sourceLineNo">408</span>                    return chunk.getBlockID(par1 &amp; 15, par2, par3 &amp; 15);<a name="line.408"></a>
<span class="sourceLineNo">409</span>                }<a name="line.409"></a>
<span class="sourceLineNo">410</span>                catch (Throwable throwable)<a name="line.410"></a>
<span class="sourceLineNo">411</span>                {<a name="line.411"></a>
<span class="sourceLineNo">412</span>                    CrashReport crashreport = CrashReport.makeCrashReport(throwable, "Exception getting block type in world");<a name="line.412"></a>
<span class="sourceLineNo">413</span>                    CrashReportCategory crashreportcategory = crashreport.makeCategory("Requested block coordinates");<a name="line.413"></a>
<span class="sourceLineNo">414</span>                    crashreportcategory.addCrashSection("Found chunk", Boolean.valueOf(chunk == null));<a name="line.414"></a>
<span class="sourceLineNo">415</span>                    crashreportcategory.addCrashSection("Location", CrashReportCategory.func_85071_a(par1, par2, par3));<a name="line.415"></a>
<span class="sourceLineNo">416</span>                    throw new ReportedException(crashreport);<a name="line.416"></a>
<span class="sourceLineNo">417</span>                }<a name="line.417"></a>
<span class="sourceLineNo">418</span>            }<a name="line.418"></a>
<span class="sourceLineNo">419</span>        }<a name="line.419"></a>
<span class="sourceLineNo">420</span>        else<a name="line.420"></a>
<span class="sourceLineNo">421</span>        {<a name="line.421"></a>
<span class="sourceLineNo">422</span>            return 0;<a name="line.422"></a>
<span class="sourceLineNo">423</span>        }<a name="line.423"></a>
<span class="sourceLineNo">424</span>    }<a name="line.424"></a>
<span class="sourceLineNo">425</span><a name="line.425"></a>
<span class="sourceLineNo">426</span>    /**<a name="line.426"></a>
<span class="sourceLineNo">427</span>     * Returns true if the block at the specified coordinates is empty<a name="line.427"></a>
<span class="sourceLineNo">428</span>     */<a name="line.428"></a>
<span class="sourceLineNo">429</span>    public boolean isAirBlock(int par1, int par2, int par3)<a name="line.429"></a>
<span class="sourceLineNo">430</span>    {<a name="line.430"></a>
<span class="sourceLineNo">431</span>        int id = getBlockId(par1, par2, par3);<a name="line.431"></a>
<span class="sourceLineNo">432</span>        return id == 0 || Block.blocksList[id] == null || Block.blocksList[id].isAirBlock(this, par1, par2, par3);<a name="line.432"></a>
<span class="sourceLineNo">433</span>    }<a name="line.433"></a>
<span class="sourceLineNo">434</span><a name="line.434"></a>
<span class="sourceLineNo">435</span>    /**<a name="line.435"></a>
<span class="sourceLineNo">436</span>     * Checks if a block at a given position should have a tile entity.<a name="line.436"></a>
<span class="sourceLineNo">437</span>     */<a name="line.437"></a>
<span class="sourceLineNo">438</span>    public boolean blockHasTileEntity(int par1, int par2, int par3)<a name="line.438"></a>
<span class="sourceLineNo">439</span>    {<a name="line.439"></a>
<span class="sourceLineNo">440</span>        int l = this.getBlockId(par1, par2, par3);<a name="line.440"></a>
<span class="sourceLineNo">441</span>        int meta = this.getBlockMetadata(par1, par2, par3);<a name="line.441"></a>
<span class="sourceLineNo">442</span>        return Block.blocksList[l] != null &amp;&amp; Block.blocksList[l].hasTileEntity(meta);<a name="line.442"></a>
<span class="sourceLineNo">443</span>    }<a name="line.443"></a>
<span class="sourceLineNo">444</span><a name="line.444"></a>
<span class="sourceLineNo">445</span>    /**<a name="line.445"></a>
<span class="sourceLineNo">446</span>     * Returns the render type of the block at the given coordinate.<a name="line.446"></a>
<span class="sourceLineNo">447</span>     */<a name="line.447"></a>
<span class="sourceLineNo">448</span>    public int blockGetRenderType(int par1, int par2, int par3)<a name="line.448"></a>
<span class="sourceLineNo">449</span>    {<a name="line.449"></a>
<span class="sourceLineNo">450</span>        int l = this.getBlockId(par1, par2, par3);<a name="line.450"></a>
<span class="sourceLineNo">451</span>        return Block.blocksList[l] != null ? Block.blocksList[l].getRenderType() : -1;<a name="line.451"></a>
<span class="sourceLineNo">452</span>    }<a name="line.452"></a>
<span class="sourceLineNo">453</span><a name="line.453"></a>
<span class="sourceLineNo">454</span>    /**<a name="line.454"></a>
<span class="sourceLineNo">455</span>     * Returns whether a block exists at world coordinates x, y, z<a name="line.455"></a>
<span class="sourceLineNo">456</span>     */<a name="line.456"></a>
<span class="sourceLineNo">457</span>    public boolean blockExists(int par1, int par2, int par3)<a name="line.457"></a>
<span class="sourceLineNo">458</span>    {<a name="line.458"></a>
<span class="sourceLineNo">459</span>        return par2 &gt;= 0 &amp;&amp; par2 &lt; 256 ? this.chunkExists(par1 &gt;&gt; 4, par3 &gt;&gt; 4) : false;<a name="line.459"></a>
<span class="sourceLineNo">460</span>    }<a name="line.460"></a>
<span class="sourceLineNo">461</span><a name="line.461"></a>
<span class="sourceLineNo">462</span>    /**<a name="line.462"></a>
<span class="sourceLineNo">463</span>     * Checks if any of the chunks within distance (argument 4) blocks of the given block exist<a name="line.463"></a>
<span class="sourceLineNo">464</span>     */<a name="line.464"></a>
<span class="sourceLineNo">465</span>    public boolean doChunksNearChunkExist(int par1, int par2, int par3, int par4)<a name="line.465"></a>
<span class="sourceLineNo">466</span>    {<a name="line.466"></a>
<span class="sourceLineNo">467</span>        return this.checkChunksExist(par1 - par4, par2 - par4, par3 - par4, par1 + par4, par2 + par4, par3 + par4);<a name="line.467"></a>
<span class="sourceLineNo">468</span>    }<a name="line.468"></a>
<span class="sourceLineNo">469</span><a name="line.469"></a>
<span class="sourceLineNo">470</span>    /**<a name="line.470"></a>
<span class="sourceLineNo">471</span>     * Checks between a min and max all the chunks inbetween actually exist. Args: minX, minY, minZ, maxX, maxY, maxZ<a name="line.471"></a>
<span class="sourceLineNo">472</span>     */<a name="line.472"></a>
<span class="sourceLineNo">473</span>    public boolean checkChunksExist(int par1, int par2, int par3, int par4, int par5, int par6)<a name="line.473"></a>
<span class="sourceLineNo">474</span>    {<a name="line.474"></a>
<span class="sourceLineNo">475</span>        if (par5 &gt;= 0 &amp;&amp; par2 &lt; 256)<a name="line.475"></a>
<span class="sourceLineNo">476</span>        {<a name="line.476"></a>
<span class="sourceLineNo">477</span>            par1 &gt;&gt;= 4;<a name="line.477"></a>
<span class="sourceLineNo">478</span>            par3 &gt;&gt;= 4;<a name="line.478"></a>
<span class="sourceLineNo">479</span>            par4 &gt;&gt;= 4;<a name="line.479"></a>
<span class="sourceLineNo">480</span>            par6 &gt;&gt;= 4;<a name="line.480"></a>
<span class="sourceLineNo">481</span><a name="line.481"></a>
<span class="sourceLineNo">482</span>            for (int k1 = par1; k1 &lt;= par4; ++k1)<a name="line.482"></a>
<span class="sourceLineNo">483</span>            {<a name="line.483"></a>
<span class="sourceLineNo">484</span>                for (int l1 = par3; l1 &lt;= par6; ++l1)<a name="line.484"></a>
<span class="sourceLineNo">485</span>                {<a name="line.485"></a>
<span class="sourceLineNo">486</span>                    if (!this.chunkExists(k1, l1))<a name="line.486"></a>
<span class="sourceLineNo">487</span>                    {<a name="line.487"></a>
<span class="sourceLineNo">488</span>                        return false;<a name="line.488"></a>
<span class="sourceLineNo">489</span>                    }<a name="line.489"></a>
<span class="sourceLineNo">490</span>                }<a name="line.490"></a>
<span class="sourceLineNo">491</span>            }<a name="line.491"></a>
<span class="sourceLineNo">492</span><a name="line.492"></a>
<span class="sourceLineNo">493</span>            return true;<a name="line.493"></a>
<span class="sourceLineNo">494</span>        }<a name="line.494"></a>
<span class="sourceLineNo">495</span>        else<a name="line.495"></a>
<span class="sourceLineNo">496</span>        {<a name="line.496"></a>
<span class="sourceLineNo">497</span>            return false;<a name="line.497"></a>
<span class="sourceLineNo">498</span>        }<a name="line.498"></a>
<span class="sourceLineNo">499</span>    }<a name="line.499"></a>
<span class="sourceLineNo">500</span><a name="line.500"></a>
<span class="sourceLineNo">501</span>    /**<a name="line.501"></a>
<span class="sourceLineNo">502</span>     * Returns whether a chunk exists at chunk coordinates x, y<a name="line.502"></a>
<span class="sourceLineNo">503</span>     */<a name="line.503"></a>
<span class="sourceLineNo">504</span>    protected boolean chunkExists(int par1, int par2)<a name="line.504"></a>
<span class="sourceLineNo">505</span>    {<a name="line.505"></a>
<span class="sourceLineNo">506</span>        return this.chunkProvider.chunkExists(par1, par2);<a name="line.506"></a>
<span class="sourceLineNo">507</span>    }<a name="line.507"></a>
<span class="sourceLineNo">508</span><a name="line.508"></a>
<span class="sourceLineNo">509</span>    /**<a name="line.509"></a>
<span class="sourceLineNo">510</span>     * Returns a chunk looked up by block coordinates. Args: x, z<a name="line.510"></a>
<span class="sourceLineNo">511</span>     */<a name="line.511"></a>
<span class="sourceLineNo">512</span>    public Chunk getChunkFromBlockCoords(int par1, int par2)<a name="line.512"></a>
<span class="sourceLineNo">513</span>    {<a name="line.513"></a>
<span class="sourceLineNo">514</span>        return this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par2 &gt;&gt; 4);<a name="line.514"></a>
<span class="sourceLineNo">515</span>    }<a name="line.515"></a>
<span class="sourceLineNo">516</span><a name="line.516"></a>
<span class="sourceLineNo">517</span>    /**<a name="line.517"></a>
<span class="sourceLineNo">518</span>     * Returns back a chunk looked up by chunk coordinates Args: x, y<a name="line.518"></a>
<span class="sourceLineNo">519</span>     */<a name="line.519"></a>
<span class="sourceLineNo">520</span>    public Chunk getChunkFromChunkCoords(int par1, int par2)<a name="line.520"></a>
<span class="sourceLineNo">521</span>    {<a name="line.521"></a>
<span class="sourceLineNo">522</span>        return this.chunkProvider.provideChunk(par1, par2);<a name="line.522"></a>
<span class="sourceLineNo">523</span>    }<a name="line.523"></a>
<span class="sourceLineNo">524</span><a name="line.524"></a>
<span class="sourceLineNo">525</span>    /**<a name="line.525"></a>
<span class="sourceLineNo">526</span>     * Sets the block ID and metadata, then notifies neighboring blocks of the change Params: x, y, z, BlockID, Metadata<a name="line.526"></a>
<span class="sourceLineNo">527</span>     */<a name="line.527"></a>
<span class="sourceLineNo">528</span>    public boolean setBlockAndMetadataWithNotify(int par1, int par2, int par3, int par4, int par5, int par6)<a name="line.528"></a>
<span class="sourceLineNo">529</span>    {<a name="line.529"></a>
<span class="sourceLineNo">530</span>        if (par1 &gt;= -30000000 &amp;&amp; par3 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par3 &lt; 30000000)<a name="line.530"></a>
<span class="sourceLineNo">531</span>        {<a name="line.531"></a>
<span class="sourceLineNo">532</span>            if (par2 &lt; 0)<a name="line.532"></a>
<span class="sourceLineNo">533</span>            {<a name="line.533"></a>
<span class="sourceLineNo">534</span>                return false;<a name="line.534"></a>
<span class="sourceLineNo">535</span>            }<a name="line.535"></a>
<span class="sourceLineNo">536</span>            else if (par2 &gt;= 256)<a name="line.536"></a>
<span class="sourceLineNo">537</span>            {<a name="line.537"></a>
<span class="sourceLineNo">538</span>                return false;<a name="line.538"></a>
<span class="sourceLineNo">539</span>            }<a name="line.539"></a>
<span class="sourceLineNo">540</span>            else<a name="line.540"></a>
<span class="sourceLineNo">541</span>            {<a name="line.541"></a>
<span class="sourceLineNo">542</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.542"></a>
<span class="sourceLineNo">543</span>                int k1 = 0;<a name="line.543"></a>
<span class="sourceLineNo">544</span><a name="line.544"></a>
<span class="sourceLineNo">545</span>                if ((par6 &amp; 1) != 0)<a name="line.545"></a>
<span class="sourceLineNo">546</span>                {<a name="line.546"></a>
<span class="sourceLineNo">547</span>                    k1 = chunk.getBlockID(par1 &amp; 15, par2, par3 &amp; 15);<a name="line.547"></a>
<span class="sourceLineNo">548</span>                }<a name="line.548"></a>
<span class="sourceLineNo">549</span><a name="line.549"></a>
<span class="sourceLineNo">550</span>                boolean flag = chunk.setBlockIDWithMetadata(par1 &amp; 15, par2, par3 &amp; 15, par4, par5);<a name="line.550"></a>
<span class="sourceLineNo">551</span>                this.theProfiler.startSection("checkLight");<a name="line.551"></a>
<span class="sourceLineNo">552</span>                this.updateAllLightTypes(par1, par2, par3);<a name="line.552"></a>
<span class="sourceLineNo">553</span>                this.theProfiler.endSection();<a name="line.553"></a>
<span class="sourceLineNo">554</span><a name="line.554"></a>
<span class="sourceLineNo">555</span>                if (flag)<a name="line.555"></a>
<span class="sourceLineNo">556</span>                {<a name="line.556"></a>
<span class="sourceLineNo">557</span>                    if ((par6 &amp; 2) != 0 &amp;&amp; (!this.isRemote || (par6 &amp; 4) == 0))<a name="line.557"></a>
<span class="sourceLineNo">558</span>                    {<a name="line.558"></a>
<span class="sourceLineNo">559</span>                        this.markBlockForUpdate(par1, par2, par3);<a name="line.559"></a>
<span class="sourceLineNo">560</span>                    }<a name="line.560"></a>
<span class="sourceLineNo">561</span><a name="line.561"></a>
<span class="sourceLineNo">562</span>                    if (!this.isRemote &amp;&amp; (par6 &amp; 1) != 0)<a name="line.562"></a>
<span class="sourceLineNo">563</span>                    {<a name="line.563"></a>
<span class="sourceLineNo">564</span>                        this.notifyBlockChange(par1, par2, par3, k1);<a name="line.564"></a>
<span class="sourceLineNo">565</span>                        Block block = Block.blocksList[par4];<a name="line.565"></a>
<span class="sourceLineNo">566</span><a name="line.566"></a>
<span class="sourceLineNo">567</span>                        if (block != null &amp;&amp; block.func_96468_q_())<a name="line.567"></a>
<span class="sourceLineNo">568</span>                        {<a name="line.568"></a>
<span class="sourceLineNo">569</span>                            this.func_96440_m(par1, par2, par3, par4);<a name="line.569"></a>
<span class="sourceLineNo">570</span>                        }<a name="line.570"></a>
<span class="sourceLineNo">571</span>                    }<a name="line.571"></a>
<span class="sourceLineNo">572</span>                }<a name="line.572"></a>
<span class="sourceLineNo">573</span><a name="line.573"></a>
<span class="sourceLineNo">574</span>                return flag;<a name="line.574"></a>
<span class="sourceLineNo">575</span>            }<a name="line.575"></a>
<span class="sourceLineNo">576</span>        }<a name="line.576"></a>
<span class="sourceLineNo">577</span>        else<a name="line.577"></a>
<span class="sourceLineNo">578</span>        {<a name="line.578"></a>
<span class="sourceLineNo">579</span>            return false;<a name="line.579"></a>
<span class="sourceLineNo">580</span>        }<a name="line.580"></a>
<span class="sourceLineNo">581</span>    }<a name="line.581"></a>
<span class="sourceLineNo">582</span><a name="line.582"></a>
<span class="sourceLineNo">583</span>    /**<a name="line.583"></a>
<span class="sourceLineNo">584</span>     * Returns the block's material.<a name="line.584"></a>
<span class="sourceLineNo">585</span>     */<a name="line.585"></a>
<span class="sourceLineNo">586</span>    public Material getBlockMaterial(int par1, int par2, int par3)<a name="line.586"></a>
<span class="sourceLineNo">587</span>    {<a name="line.587"></a>
<span class="sourceLineNo">588</span>        int l = this.getBlockId(par1, par2, par3);<a name="line.588"></a>
<span class="sourceLineNo">589</span>        return l == 0 ? Material.air : Block.blocksList[l].blockMaterial;<a name="line.589"></a>
<span class="sourceLineNo">590</span>    }<a name="line.590"></a>
<span class="sourceLineNo">591</span><a name="line.591"></a>
<span class="sourceLineNo">592</span>    /**<a name="line.592"></a>
<span class="sourceLineNo">593</span>     * Returns the block metadata at coords x,y,z<a name="line.593"></a>
<span class="sourceLineNo">594</span>     */<a name="line.594"></a>
<span class="sourceLineNo">595</span>    public int getBlockMetadata(int par1, int par2, int par3)<a name="line.595"></a>
<span class="sourceLineNo">596</span>    {<a name="line.596"></a>
<span class="sourceLineNo">597</span>        if (par1 &gt;= -30000000 &amp;&amp; par3 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par3 &lt; 30000000)<a name="line.597"></a>
<span class="sourceLineNo">598</span>        {<a name="line.598"></a>
<span class="sourceLineNo">599</span>            if (par2 &lt; 0)<a name="line.599"></a>
<span class="sourceLineNo">600</span>            {<a name="line.600"></a>
<span class="sourceLineNo">601</span>                return 0;<a name="line.601"></a>
<span class="sourceLineNo">602</span>            }<a name="line.602"></a>
<span class="sourceLineNo">603</span>            else if (par2 &gt;= 256)<a name="line.603"></a>
<span class="sourceLineNo">604</span>            {<a name="line.604"></a>
<span class="sourceLineNo">605</span>                return 0;<a name="line.605"></a>
<span class="sourceLineNo">606</span>            }<a name="line.606"></a>
<span class="sourceLineNo">607</span>            else<a name="line.607"></a>
<span class="sourceLineNo">608</span>            {<a name="line.608"></a>
<span class="sourceLineNo">609</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.609"></a>
<span class="sourceLineNo">610</span>                par1 &amp;= 15;<a name="line.610"></a>
<span class="sourceLineNo">611</span>                par3 &amp;= 15;<a name="line.611"></a>
<span class="sourceLineNo">612</span>                return chunk.getBlockMetadata(par1, par2, par3);<a name="line.612"></a>
<span class="sourceLineNo">613</span>            }<a name="line.613"></a>
<span class="sourceLineNo">614</span>        }<a name="line.614"></a>
<span class="sourceLineNo">615</span>        else<a name="line.615"></a>
<span class="sourceLineNo">616</span>        {<a name="line.616"></a>
<span class="sourceLineNo">617</span>            return 0;<a name="line.617"></a>
<span class="sourceLineNo">618</span>        }<a name="line.618"></a>
<span class="sourceLineNo">619</span>    }<a name="line.619"></a>
<span class="sourceLineNo">620</span><a name="line.620"></a>
<span class="sourceLineNo">621</span>    /**<a name="line.621"></a>
<span class="sourceLineNo">622</span>     * Sets the blocks metadata and if set will then notify blocks that this block changed. Args: x, y, z, metadata<a name="line.622"></a>
<span class="sourceLineNo">623</span>     */<a name="line.623"></a>
<span class="sourceLineNo">624</span>    public boolean setBlockMetadataWithNotify(int par1, int par2, int par3, int par4, int par5)<a name="line.624"></a>
<span class="sourceLineNo">625</span>    {<a name="line.625"></a>
<span class="sourceLineNo">626</span>        if (par1 &gt;= -30000000 &amp;&amp; par3 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par3 &lt; 30000000)<a name="line.626"></a>
<span class="sourceLineNo">627</span>        {<a name="line.627"></a>
<span class="sourceLineNo">628</span>            if (par2 &lt; 0)<a name="line.628"></a>
<span class="sourceLineNo">629</span>            {<a name="line.629"></a>
<span class="sourceLineNo">630</span>                return false;<a name="line.630"></a>
<span class="sourceLineNo">631</span>            }<a name="line.631"></a>
<span class="sourceLineNo">632</span>            else if (par2 &gt;= 256)<a name="line.632"></a>
<span class="sourceLineNo">633</span>            {<a name="line.633"></a>
<span class="sourceLineNo">634</span>                return false;<a name="line.634"></a>
<span class="sourceLineNo">635</span>            }<a name="line.635"></a>
<span class="sourceLineNo">636</span>            else<a name="line.636"></a>
<span class="sourceLineNo">637</span>            {<a name="line.637"></a>
<span class="sourceLineNo">638</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.638"></a>
<span class="sourceLineNo">639</span>                int j1 = par1 &amp; 15;<a name="line.639"></a>
<span class="sourceLineNo">640</span>                int k1 = par3 &amp; 15;<a name="line.640"></a>
<span class="sourceLineNo">641</span>                boolean flag = chunk.setBlockMetadata(j1, par2, k1, par4);<a name="line.641"></a>
<span class="sourceLineNo">642</span><a name="line.642"></a>
<span class="sourceLineNo">643</span>                if (flag)<a name="line.643"></a>
<span class="sourceLineNo">644</span>                {<a name="line.644"></a>
<span class="sourceLineNo">645</span>                    int l1 = chunk.getBlockID(j1, par2, k1);<a name="line.645"></a>
<span class="sourceLineNo">646</span><a name="line.646"></a>
<span class="sourceLineNo">647</span>                    if ((par5 &amp; 2) != 0 &amp;&amp; (!this.isRemote || (par5 &amp; 4) == 0))<a name="line.647"></a>
<span class="sourceLineNo">648</span>                    {<a name="line.648"></a>
<span class="sourceLineNo">649</span>                        this.markBlockForUpdate(par1, par2, par3);<a name="line.649"></a>
<span class="sourceLineNo">650</span>                    }<a name="line.650"></a>
<span class="sourceLineNo">651</span><a name="line.651"></a>
<span class="sourceLineNo">652</span>                    if (!this.isRemote &amp;&amp; (par5 &amp; 1) != 0)<a name="line.652"></a>
<span class="sourceLineNo">653</span>                    {<a name="line.653"></a>
<span class="sourceLineNo">654</span>                        this.notifyBlockChange(par1, par2, par3, l1);<a name="line.654"></a>
<span class="sourceLineNo">655</span>                        Block block = Block.blocksList[l1];<a name="line.655"></a>
<span class="sourceLineNo">656</span><a name="line.656"></a>
<span class="sourceLineNo">657</span>                        if (block != null &amp;&amp; block.func_96468_q_())<a name="line.657"></a>
<span class="sourceLineNo">658</span>                        {<a name="line.658"></a>
<span class="sourceLineNo">659</span>                            this.func_96440_m(par1, par2, par3, l1);<a name="line.659"></a>
<span class="sourceLineNo">660</span>                        }<a name="line.660"></a>
<span class="sourceLineNo">661</span>                    }<a name="line.661"></a>
<span class="sourceLineNo">662</span>                }<a name="line.662"></a>
<span class="sourceLineNo">663</span><a name="line.663"></a>
<span class="sourceLineNo">664</span>                return flag;<a name="line.664"></a>
<span class="sourceLineNo">665</span>            }<a name="line.665"></a>
<span class="sourceLineNo">666</span>        }<a name="line.666"></a>
<span class="sourceLineNo">667</span>        else<a name="line.667"></a>
<span class="sourceLineNo">668</span>        {<a name="line.668"></a>
<span class="sourceLineNo">669</span>            return false;<a name="line.669"></a>
<span class="sourceLineNo">670</span>        }<a name="line.670"></a>
<span class="sourceLineNo">671</span>    }<a name="line.671"></a>
<span class="sourceLineNo">672</span><a name="line.672"></a>
<span class="sourceLineNo">673</span>    public boolean func_94571_i(int par1, int par2, int par3)<a name="line.673"></a>
<span class="sourceLineNo">674</span>    {<a name="line.674"></a>
<span class="sourceLineNo">675</span>        return this.setBlockAndMetadataWithNotify(par1, par2, par3, 0, 0, 3);<a name="line.675"></a>
<span class="sourceLineNo">676</span>    }<a name="line.676"></a>
<span class="sourceLineNo">677</span><a name="line.677"></a>
<span class="sourceLineNo">678</span>    public boolean func_94578_a(int par1, int par2, int par3, boolean par4)<a name="line.678"></a>
<span class="sourceLineNo">679</span>    {<a name="line.679"></a>
<span class="sourceLineNo">680</span>        int l = this.getBlockId(par1, par2, par3);<a name="line.680"></a>
<span class="sourceLineNo">681</span><a name="line.681"></a>
<span class="sourceLineNo">682</span>        if (l &gt; 0)<a name="line.682"></a>
<span class="sourceLineNo">683</span>        {<a name="line.683"></a>
<span class="sourceLineNo">684</span>            int i1 = this.getBlockMetadata(par1, par2, par3);<a name="line.684"></a>
<span class="sourceLineNo">685</span>            this.playAuxSFX(2001, par1, par2, par3, l + (i1 &lt;&lt; 12));<a name="line.685"></a>
<span class="sourceLineNo">686</span><a name="line.686"></a>
<span class="sourceLineNo">687</span>            if (par4)<a name="line.687"></a>
<span class="sourceLineNo">688</span>            {<a name="line.688"></a>
<span class="sourceLineNo">689</span>                Block.blocksList[l].dropBlockAsItem(this, par1, par2, par3, i1, 0);<a name="line.689"></a>
<span class="sourceLineNo">690</span>            }<a name="line.690"></a>
<span class="sourceLineNo">691</span><a name="line.691"></a>
<span class="sourceLineNo">692</span>            return this.setBlockAndMetadataWithNotify(par1, par2, par3, 0, 0, 3);<a name="line.692"></a>
<span class="sourceLineNo">693</span>        }<a name="line.693"></a>
<span class="sourceLineNo">694</span>        else<a name="line.694"></a>
<span class="sourceLineNo">695</span>        {<a name="line.695"></a>
<span class="sourceLineNo">696</span>            return false;<a name="line.696"></a>
<span class="sourceLineNo">697</span>        }<a name="line.697"></a>
<span class="sourceLineNo">698</span>    }<a name="line.698"></a>
<span class="sourceLineNo">699</span><a name="line.699"></a>
<span class="sourceLineNo">700</span>    public boolean func_94575_c(int par1, int par2, int par3, int par4)<a name="line.700"></a>
<span class="sourceLineNo">701</span>    {<a name="line.701"></a>
<span class="sourceLineNo">702</span>        return this.setBlockAndMetadataWithNotify(par1, par2, par3, par4, 0, 3);<a name="line.702"></a>
<span class="sourceLineNo">703</span>    }<a name="line.703"></a>
<span class="sourceLineNo">704</span><a name="line.704"></a>
<span class="sourceLineNo">705</span>    /**<a name="line.705"></a>
<span class="sourceLineNo">706</span>     * On the client, re-renders the block. On the server, sends the block to the client (which will re-render it),<a name="line.706"></a>
<span class="sourceLineNo">707</span>     * including the tile entity description packet if applicable. Args: x, y, z<a name="line.707"></a>
<span class="sourceLineNo">708</span>     */<a name="line.708"></a>
<span class="sourceLineNo">709</span>    public void markBlockForUpdate(int par1, int par2, int par3)<a name="line.709"></a>
<span class="sourceLineNo">710</span>    {<a name="line.710"></a>
<span class="sourceLineNo">711</span>        for (int l = 0; l &lt; this.worldAccesses.size(); ++l)<a name="line.711"></a>
<span class="sourceLineNo">712</span>        {<a name="line.712"></a>
<span class="sourceLineNo">713</span>            ((IWorldAccess)this.worldAccesses.get(l)).markBlockForUpdate(par1, par2, par3);<a name="line.713"></a>
<span class="sourceLineNo">714</span>        }<a name="line.714"></a>
<span class="sourceLineNo">715</span>    }<a name="line.715"></a>
<span class="sourceLineNo">716</span><a name="line.716"></a>
<span class="sourceLineNo">717</span>    /**<a name="line.717"></a>
<span class="sourceLineNo">718</span>     * The block type change and need to notify other systems  Args: x, y, z, blockID<a name="line.718"></a>
<span class="sourceLineNo">719</span>     */<a name="line.719"></a>
<span class="sourceLineNo">720</span>    public void notifyBlockChange(int par1, int par2, int par3, int par4)<a name="line.720"></a>
<span class="sourceLineNo">721</span>    {<a name="line.721"></a>
<span class="sourceLineNo">722</span>        this.notifyBlocksOfNeighborChange(par1, par2, par3, par4);<a name="line.722"></a>
<span class="sourceLineNo">723</span>    }<a name="line.723"></a>
<span class="sourceLineNo">724</span><a name="line.724"></a>
<span class="sourceLineNo">725</span>    /**<a name="line.725"></a>
<span class="sourceLineNo">726</span>     * marks a vertical line of blocks as dirty<a name="line.726"></a>
<span class="sourceLineNo">727</span>     */<a name="line.727"></a>
<span class="sourceLineNo">728</span>    public void markBlocksDirtyVertical(int par1, int par2, int par3, int par4)<a name="line.728"></a>
<span class="sourceLineNo">729</span>    {<a name="line.729"></a>
<span class="sourceLineNo">730</span>        int i1;<a name="line.730"></a>
<span class="sourceLineNo">731</span><a name="line.731"></a>
<span class="sourceLineNo">732</span>        if (par3 &gt; par4)<a name="line.732"></a>
<span class="sourceLineNo">733</span>        {<a name="line.733"></a>
<span class="sourceLineNo">734</span>            i1 = par4;<a name="line.734"></a>
<span class="sourceLineNo">735</span>            par4 = par3;<a name="line.735"></a>
<span class="sourceLineNo">736</span>            par3 = i1;<a name="line.736"></a>
<span class="sourceLineNo">737</span>        }<a name="line.737"></a>
<span class="sourceLineNo">738</span><a name="line.738"></a>
<span class="sourceLineNo">739</span>        if (!this.provider.hasNoSky)<a name="line.739"></a>
<span class="sourceLineNo">740</span>        {<a name="line.740"></a>
<span class="sourceLineNo">741</span>            for (i1 = par3; i1 &lt;= par4; ++i1)<a name="line.741"></a>
<span class="sourceLineNo">742</span>            {<a name="line.742"></a>
<span class="sourceLineNo">743</span>                this.updateLightByType(EnumSkyBlock.Sky, par1, i1, par2);<a name="line.743"></a>
<span class="sourceLineNo">744</span>            }<a name="line.744"></a>
<span class="sourceLineNo">745</span>        }<a name="line.745"></a>
<span class="sourceLineNo">746</span><a name="line.746"></a>
<span class="sourceLineNo">747</span>        this.markBlockRangeForRenderUpdate(par1, par3, par2, par1, par4, par2);<a name="line.747"></a>
<span class="sourceLineNo">748</span>    }<a name="line.748"></a>
<span class="sourceLineNo">749</span><a name="line.749"></a>
<span class="sourceLineNo">750</span>    /**<a name="line.750"></a>
<span class="sourceLineNo">751</span>     * On the client, re-renders all blocks in this range, inclusive. On the server, does nothing. Args: min x, min y,<a name="line.751"></a>
<span class="sourceLineNo">752</span>     * min z, max x, max y, max z<a name="line.752"></a>
<span class="sourceLineNo">753</span>     */<a name="line.753"></a>
<span class="sourceLineNo">754</span>    public void markBlockRangeForRenderUpdate(int par1, int par2, int par3, int par4, int par5, int par6)<a name="line.754"></a>
<span class="sourceLineNo">755</span>    {<a name="line.755"></a>
<span class="sourceLineNo">756</span>        for (int k1 = 0; k1 &lt; this.worldAccesses.size(); ++k1)<a name="line.756"></a>
<span class="sourceLineNo">757</span>        {<a name="line.757"></a>
<span class="sourceLineNo">758</span>            ((IWorldAccess)this.worldAccesses.get(k1)).markBlockRangeForRenderUpdate(par1, par2, par3, par4, par5, par6);<a name="line.758"></a>
<span class="sourceLineNo">759</span>        }<a name="line.759"></a>
<span class="sourceLineNo">760</span>    }<a name="line.760"></a>
<span class="sourceLineNo">761</span><a name="line.761"></a>
<span class="sourceLineNo">762</span>    /**<a name="line.762"></a>
<span class="sourceLineNo">763</span>     * Notifies neighboring blocks that this specified block changed  Args: x, y, z, blockID<a name="line.763"></a>
<span class="sourceLineNo">764</span>     */<a name="line.764"></a>
<span class="sourceLineNo">765</span>    public void notifyBlocksOfNeighborChange(int par1, int par2, int par3, int par4)<a name="line.765"></a>
<span class="sourceLineNo">766</span>    {<a name="line.766"></a>
<span class="sourceLineNo">767</span>        this.notifyBlockOfNeighborChange(par1 - 1, par2, par3, par4);<a name="line.767"></a>
<span class="sourceLineNo">768</span>        this.notifyBlockOfNeighborChange(par1 + 1, par2, par3, par4);<a name="line.768"></a>
<span class="sourceLineNo">769</span>        this.notifyBlockOfNeighborChange(par1, par2 - 1, par3, par4);<a name="line.769"></a>
<span class="sourceLineNo">770</span>        this.notifyBlockOfNeighborChange(par1, par2 + 1, par3, par4);<a name="line.770"></a>
<span class="sourceLineNo">771</span>        this.notifyBlockOfNeighborChange(par1, par2, par3 - 1, par4);<a name="line.771"></a>
<span class="sourceLineNo">772</span>        this.notifyBlockOfNeighborChange(par1, par2, par3 + 1, par4);<a name="line.772"></a>
<span class="sourceLineNo">773</span>    }<a name="line.773"></a>
<span class="sourceLineNo">774</span><a name="line.774"></a>
<span class="sourceLineNo">775</span>    public void func_96439_d(int par1, int par2, int par3, int par4, int par5)<a name="line.775"></a>
<span class="sourceLineNo">776</span>    {<a name="line.776"></a>
<span class="sourceLineNo">777</span>        if (par5 != 4)<a name="line.777"></a>
<span class="sourceLineNo">778</span>        {<a name="line.778"></a>
<span class="sourceLineNo">779</span>            this.notifyBlockOfNeighborChange(par1 - 1, par2, par3, par4);<a name="line.779"></a>
<span class="sourceLineNo">780</span>        }<a name="line.780"></a>
<span class="sourceLineNo">781</span><a name="line.781"></a>
<span class="sourceLineNo">782</span>        if (par5 != 5)<a name="line.782"></a>
<span class="sourceLineNo">783</span>        {<a name="line.783"></a>
<span class="sourceLineNo">784</span>            this.notifyBlockOfNeighborChange(par1 + 1, par2, par3, par4);<a name="line.784"></a>
<span class="sourceLineNo">785</span>        }<a name="line.785"></a>
<span class="sourceLineNo">786</span><a name="line.786"></a>
<span class="sourceLineNo">787</span>        if (par5 != 0)<a name="line.787"></a>
<span class="sourceLineNo">788</span>        {<a name="line.788"></a>
<span class="sourceLineNo">789</span>            this.notifyBlockOfNeighborChange(par1, par2 - 1, par3, par4);<a name="line.789"></a>
<span class="sourceLineNo">790</span>        }<a name="line.790"></a>
<span class="sourceLineNo">791</span><a name="line.791"></a>
<span class="sourceLineNo">792</span>        if (par5 != 1)<a name="line.792"></a>
<span class="sourceLineNo">793</span>        {<a name="line.793"></a>
<span class="sourceLineNo">794</span>            this.notifyBlockOfNeighborChange(par1, par2 + 1, par3, par4);<a name="line.794"></a>
<span class="sourceLineNo">795</span>        }<a name="line.795"></a>
<span class="sourceLineNo">796</span><a name="line.796"></a>
<span class="sourceLineNo">797</span>        if (par5 != 2)<a name="line.797"></a>
<span class="sourceLineNo">798</span>        {<a name="line.798"></a>
<span class="sourceLineNo">799</span>            this.notifyBlockOfNeighborChange(par1, par2, par3 - 1, par4);<a name="line.799"></a>
<span class="sourceLineNo">800</span>        }<a name="line.800"></a>
<span class="sourceLineNo">801</span><a name="line.801"></a>
<span class="sourceLineNo">802</span>        if (par5 != 3)<a name="line.802"></a>
<span class="sourceLineNo">803</span>        {<a name="line.803"></a>
<span class="sourceLineNo">804</span>            this.notifyBlockOfNeighborChange(par1, par2, par3 + 1, par4);<a name="line.804"></a>
<span class="sourceLineNo">805</span>        }<a name="line.805"></a>
<span class="sourceLineNo">806</span>    }<a name="line.806"></a>
<span class="sourceLineNo">807</span><a name="line.807"></a>
<span class="sourceLineNo">808</span>    /**<a name="line.808"></a>
<span class="sourceLineNo">809</span>     * Notifies a block that one of its neighbor change to the specified type Args: x, y, z, blockID<a name="line.809"></a>
<span class="sourceLineNo">810</span>     */<a name="line.810"></a>
<span class="sourceLineNo">811</span>    public void notifyBlockOfNeighborChange(int par1, int par2, int par3, int par4)<a name="line.811"></a>
<span class="sourceLineNo">812</span>    {<a name="line.812"></a>
<span class="sourceLineNo">813</span>        if (!this.isRemote)<a name="line.813"></a>
<span class="sourceLineNo">814</span>        {<a name="line.814"></a>
<span class="sourceLineNo">815</span>            int i1 = this.getBlockId(par1, par2, par3);<a name="line.815"></a>
<span class="sourceLineNo">816</span>            Block block = Block.blocksList[i1];<a name="line.816"></a>
<span class="sourceLineNo">817</span><a name="line.817"></a>
<span class="sourceLineNo">818</span>            if (block != null)<a name="line.818"></a>
<span class="sourceLineNo">819</span>            {<a name="line.819"></a>
<span class="sourceLineNo">820</span>                try<a name="line.820"></a>
<span class="sourceLineNo">821</span>                {<a name="line.821"></a>
<span class="sourceLineNo">822</span>                    block.onNeighborBlockChange(this, par1, par2, par3, par4);<a name="line.822"></a>
<span class="sourceLineNo">823</span>                }<a name="line.823"></a>
<span class="sourceLineNo">824</span>                catch (Throwable throwable)<a name="line.824"></a>
<span class="sourceLineNo">825</span>                {<a name="line.825"></a>
<span class="sourceLineNo">826</span>                    CrashReport crashreport = CrashReport.makeCrashReport(throwable, "Exception while updating neighbours");<a name="line.826"></a>
<span class="sourceLineNo">827</span>                    CrashReportCategory crashreportcategory = crashreport.makeCategory("Block being updated");<a name="line.827"></a>
<span class="sourceLineNo">828</span>                    int j1;<a name="line.828"></a>
<span class="sourceLineNo">829</span><a name="line.829"></a>
<span class="sourceLineNo">830</span>                    try<a name="line.830"></a>
<span class="sourceLineNo">831</span>                    {<a name="line.831"></a>
<span class="sourceLineNo">832</span>                        j1 = this.getBlockMetadata(par1, par2, par3);<a name="line.832"></a>
<span class="sourceLineNo">833</span>                    }<a name="line.833"></a>
<span class="sourceLineNo">834</span>                    catch (Throwable throwable1)<a name="line.834"></a>
<span class="sourceLineNo">835</span>                    {<a name="line.835"></a>
<span class="sourceLineNo">836</span>                        j1 = -1;<a name="line.836"></a>
<span class="sourceLineNo">837</span>                    }<a name="line.837"></a>
<span class="sourceLineNo">838</span><a name="line.838"></a>
<span class="sourceLineNo">839</span>                    crashreportcategory.addCrashSectionCallable("Source block type", new CallableLvl1(this, par4));<a name="line.839"></a>
<span class="sourceLineNo">840</span>                    CrashReportCategory.func_85068_a(crashreportcategory, par1, par2, par3, i1, j1);<a name="line.840"></a>
<span class="sourceLineNo">841</span>                    throw new ReportedException(crashreport);<a name="line.841"></a>
<span class="sourceLineNo">842</span>                }<a name="line.842"></a>
<span class="sourceLineNo">843</span>            }<a name="line.843"></a>
<span class="sourceLineNo">844</span>        }<a name="line.844"></a>
<span class="sourceLineNo">845</span>    }<a name="line.845"></a>
<span class="sourceLineNo">846</span><a name="line.846"></a>
<span class="sourceLineNo">847</span>    public boolean func_94573_a(int par1, int par2, int par3, int par4)<a name="line.847"></a>
<span class="sourceLineNo">848</span>    {<a name="line.848"></a>
<span class="sourceLineNo">849</span>        return false;<a name="line.849"></a>
<span class="sourceLineNo">850</span>    }<a name="line.850"></a>
<span class="sourceLineNo">851</span><a name="line.851"></a>
<span class="sourceLineNo">852</span>    /**<a name="line.852"></a>
<span class="sourceLineNo">853</span>     * Checks if the specified block is able to see the sky<a name="line.853"></a>
<span class="sourceLineNo">854</span>     */<a name="line.854"></a>
<span class="sourceLineNo">855</span>    public boolean canBlockSeeTheSky(int par1, int par2, int par3)<a name="line.855"></a>
<span class="sourceLineNo">856</span>    {<a name="line.856"></a>
<span class="sourceLineNo">857</span>        return this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4).canBlockSeeTheSky(par1 &amp; 15, par2, par3 &amp; 15);<a name="line.857"></a>
<span class="sourceLineNo">858</span>    }<a name="line.858"></a>
<span class="sourceLineNo">859</span><a name="line.859"></a>
<span class="sourceLineNo">860</span>    /**<a name="line.860"></a>
<span class="sourceLineNo">861</span>     * Does the same as getBlockLightValue_do but without checking if its not a normal block<a name="line.861"></a>
<span class="sourceLineNo">862</span>     */<a name="line.862"></a>
<span class="sourceLineNo">863</span>    public int getFullBlockLightValue(int par1, int par2, int par3)<a name="line.863"></a>
<span class="sourceLineNo">864</span>    {<a name="line.864"></a>
<span class="sourceLineNo">865</span>        if (par2 &lt; 0)<a name="line.865"></a>
<span class="sourceLineNo">866</span>        {<a name="line.866"></a>
<span class="sourceLineNo">867</span>            return 0;<a name="line.867"></a>
<span class="sourceLineNo">868</span>        }<a name="line.868"></a>
<span class="sourceLineNo">869</span>        else<a name="line.869"></a>
<span class="sourceLineNo">870</span>        {<a name="line.870"></a>
<span class="sourceLineNo">871</span>            if (par2 &gt;= 256)<a name="line.871"></a>
<span class="sourceLineNo">872</span>            {<a name="line.872"></a>
<span class="sourceLineNo">873</span>                par2 = 255;<a name="line.873"></a>
<span class="sourceLineNo">874</span>            }<a name="line.874"></a>
<span class="sourceLineNo">875</span><a name="line.875"></a>
<span class="sourceLineNo">876</span>            return this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4).getBlockLightValue(par1 &amp; 15, par2, par3 &amp; 15, 0);<a name="line.876"></a>
<span class="sourceLineNo">877</span>        }<a name="line.877"></a>
<span class="sourceLineNo">878</span>    }<a name="line.878"></a>
<span class="sourceLineNo">879</span><a name="line.879"></a>
<span class="sourceLineNo">880</span>    /**<a name="line.880"></a>
<span class="sourceLineNo">881</span>     * Gets the light value of a block location<a name="line.881"></a>
<span class="sourceLineNo">882</span>     */<a name="line.882"></a>
<span class="sourceLineNo">883</span>    public int getBlockLightValue(int par1, int par2, int par3)<a name="line.883"></a>
<span class="sourceLineNo">884</span>    {<a name="line.884"></a>
<span class="sourceLineNo">885</span>        return this.getBlockLightValue_do(par1, par2, par3, true);<a name="line.885"></a>
<span class="sourceLineNo">886</span>    }<a name="line.886"></a>
<span class="sourceLineNo">887</span><a name="line.887"></a>
<span class="sourceLineNo">888</span>    /**<a name="line.888"></a>
<span class="sourceLineNo">889</span>     * Gets the light value of a block location. This is the actual function that gets the value and has a bool flag<a name="line.889"></a>
<span class="sourceLineNo">890</span>     * that indicates if its a half step block to get the maximum light value of a direct neighboring block (left,<a name="line.890"></a>
<span class="sourceLineNo">891</span>     * right, forward, back, and up)<a name="line.891"></a>
<span class="sourceLineNo">892</span>     */<a name="line.892"></a>
<span class="sourceLineNo">893</span>    public int getBlockLightValue_do(int par1, int par2, int par3, boolean par4)<a name="line.893"></a>
<span class="sourceLineNo">894</span>    {<a name="line.894"></a>
<span class="sourceLineNo">895</span>        if (par1 &gt;= -30000000 &amp;&amp; par3 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par3 &lt; 30000000)<a name="line.895"></a>
<span class="sourceLineNo">896</span>        {<a name="line.896"></a>
<span class="sourceLineNo">897</span>            if (par4)<a name="line.897"></a>
<span class="sourceLineNo">898</span>            {<a name="line.898"></a>
<span class="sourceLineNo">899</span>                int l = this.getBlockId(par1, par2, par3);<a name="line.899"></a>
<span class="sourceLineNo">900</span><a name="line.900"></a>
<span class="sourceLineNo">901</span>                if (Block.useNeighborBrightness[l])<a name="line.901"></a>
<span class="sourceLineNo">902</span>                {<a name="line.902"></a>
<span class="sourceLineNo">903</span>                    int i1 = this.getBlockLightValue_do(par1, par2 + 1, par3, false);<a name="line.903"></a>
<span class="sourceLineNo">904</span>                    int j1 = this.getBlockLightValue_do(par1 + 1, par2, par3, false);<a name="line.904"></a>
<span class="sourceLineNo">905</span>                    int k1 = this.getBlockLightValue_do(par1 - 1, par2, par3, false);<a name="line.905"></a>
<span class="sourceLineNo">906</span>                    int l1 = this.getBlockLightValue_do(par1, par2, par3 + 1, false);<a name="line.906"></a>
<span class="sourceLineNo">907</span>                    int i2 = this.getBlockLightValue_do(par1, par2, par3 - 1, false);<a name="line.907"></a>
<span class="sourceLineNo">908</span><a name="line.908"></a>
<span class="sourceLineNo">909</span>                    if (j1 &gt; i1)<a name="line.909"></a>
<span class="sourceLineNo">910</span>                    {<a name="line.910"></a>
<span class="sourceLineNo">911</span>                        i1 = j1;<a name="line.911"></a>
<span class="sourceLineNo">912</span>                    }<a name="line.912"></a>
<span class="sourceLineNo">913</span><a name="line.913"></a>
<span class="sourceLineNo">914</span>                    if (k1 &gt; i1)<a name="line.914"></a>
<span class="sourceLineNo">915</span>                    {<a name="line.915"></a>
<span class="sourceLineNo">916</span>                        i1 = k1;<a name="line.916"></a>
<span class="sourceLineNo">917</span>                    }<a name="line.917"></a>
<span class="sourceLineNo">918</span><a name="line.918"></a>
<span class="sourceLineNo">919</span>                    if (l1 &gt; i1)<a name="line.919"></a>
<span class="sourceLineNo">920</span>                    {<a name="line.920"></a>
<span class="sourceLineNo">921</span>                        i1 = l1;<a name="line.921"></a>
<span class="sourceLineNo">922</span>                    }<a name="line.922"></a>
<span class="sourceLineNo">923</span><a name="line.923"></a>
<span class="sourceLineNo">924</span>                    if (i2 &gt; i1)<a name="line.924"></a>
<span class="sourceLineNo">925</span>                    {<a name="line.925"></a>
<span class="sourceLineNo">926</span>                        i1 = i2;<a name="line.926"></a>
<span class="sourceLineNo">927</span>                    }<a name="line.927"></a>
<span class="sourceLineNo">928</span><a name="line.928"></a>
<span class="sourceLineNo">929</span>                    return i1;<a name="line.929"></a>
<span class="sourceLineNo">930</span>                }<a name="line.930"></a>
<span class="sourceLineNo">931</span>            }<a name="line.931"></a>
<span class="sourceLineNo">932</span><a name="line.932"></a>
<span class="sourceLineNo">933</span>            if (par2 &lt; 0)<a name="line.933"></a>
<span class="sourceLineNo">934</span>            {<a name="line.934"></a>
<span class="sourceLineNo">935</span>                return 0;<a name="line.935"></a>
<span class="sourceLineNo">936</span>            }<a name="line.936"></a>
<span class="sourceLineNo">937</span>            else<a name="line.937"></a>
<span class="sourceLineNo">938</span>            {<a name="line.938"></a>
<span class="sourceLineNo">939</span>                if (par2 &gt;= 256)<a name="line.939"></a>
<span class="sourceLineNo">940</span>                {<a name="line.940"></a>
<span class="sourceLineNo">941</span>                    par2 = 255;<a name="line.941"></a>
<span class="sourceLineNo">942</span>                }<a name="line.942"></a>
<span class="sourceLineNo">943</span><a name="line.943"></a>
<span class="sourceLineNo">944</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.944"></a>
<span class="sourceLineNo">945</span>                par1 &amp;= 15;<a name="line.945"></a>
<span class="sourceLineNo">946</span>                par3 &amp;= 15;<a name="line.946"></a>
<span class="sourceLineNo">947</span>                return chunk.getBlockLightValue(par1, par2, par3, this.skylightSubtracted);<a name="line.947"></a>
<span class="sourceLineNo">948</span>            }<a name="line.948"></a>
<span class="sourceLineNo">949</span>        }<a name="line.949"></a>
<span class="sourceLineNo">950</span>        else<a name="line.950"></a>
<span class="sourceLineNo">951</span>        {<a name="line.951"></a>
<span class="sourceLineNo">952</span>            return 15;<a name="line.952"></a>
<span class="sourceLineNo">953</span>        }<a name="line.953"></a>
<span class="sourceLineNo">954</span>    }<a name="line.954"></a>
<span class="sourceLineNo">955</span><a name="line.955"></a>
<span class="sourceLineNo">956</span>    /**<a name="line.956"></a>
<span class="sourceLineNo">957</span>     * Returns the y coordinate with a block in it at this x, z coordinate<a name="line.957"></a>
<span class="sourceLineNo">958</span>     */<a name="line.958"></a>
<span class="sourceLineNo">959</span>    public int getHeightValue(int par1, int par2)<a name="line.959"></a>
<span class="sourceLineNo">960</span>    {<a name="line.960"></a>
<span class="sourceLineNo">961</span>        if (par1 &gt;= -30000000 &amp;&amp; par2 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par2 &lt; 30000000)<a name="line.961"></a>
<span class="sourceLineNo">962</span>        {<a name="line.962"></a>
<span class="sourceLineNo">963</span>            if (!this.chunkExists(par1 &gt;&gt; 4, par2 &gt;&gt; 4))<a name="line.963"></a>
<span class="sourceLineNo">964</span>            {<a name="line.964"></a>
<span class="sourceLineNo">965</span>                return 0;<a name="line.965"></a>
<span class="sourceLineNo">966</span>            }<a name="line.966"></a>
<span class="sourceLineNo">967</span>            else<a name="line.967"></a>
<span class="sourceLineNo">968</span>            {<a name="line.968"></a>
<span class="sourceLineNo">969</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par2 &gt;&gt; 4);<a name="line.969"></a>
<span class="sourceLineNo">970</span>                return chunk.getHeightValue(par1 &amp; 15, par2 &amp; 15);<a name="line.970"></a>
<span class="sourceLineNo">971</span>            }<a name="line.971"></a>
<span class="sourceLineNo">972</span>        }<a name="line.972"></a>
<span class="sourceLineNo">973</span>        else<a name="line.973"></a>
<span class="sourceLineNo">974</span>        {<a name="line.974"></a>
<span class="sourceLineNo">975</span>            return 0;<a name="line.975"></a>
<span class="sourceLineNo">976</span>        }<a name="line.976"></a>
<span class="sourceLineNo">977</span>    }<a name="line.977"></a>
<span class="sourceLineNo">978</span><a name="line.978"></a>
<span class="sourceLineNo">979</span>    public int func_82734_g(int par1, int par2)<a name="line.979"></a>
<span class="sourceLineNo">980</span>    {<a name="line.980"></a>
<span class="sourceLineNo">981</span>        if (par1 &gt;= -30000000 &amp;&amp; par2 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par2 &lt; 30000000)<a name="line.981"></a>
<span class="sourceLineNo">982</span>        {<a name="line.982"></a>
<span class="sourceLineNo">983</span>            if (!this.chunkExists(par1 &gt;&gt; 4, par2 &gt;&gt; 4))<a name="line.983"></a>
<span class="sourceLineNo">984</span>            {<a name="line.984"></a>
<span class="sourceLineNo">985</span>                return 0;<a name="line.985"></a>
<span class="sourceLineNo">986</span>            }<a name="line.986"></a>
<span class="sourceLineNo">987</span>            else<a name="line.987"></a>
<span class="sourceLineNo">988</span>            {<a name="line.988"></a>
<span class="sourceLineNo">989</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par2 &gt;&gt; 4);<a name="line.989"></a>
<span class="sourceLineNo">990</span>                return chunk.field_82912_p;<a name="line.990"></a>
<span class="sourceLineNo">991</span>            }<a name="line.991"></a>
<span class="sourceLineNo">992</span>        }<a name="line.992"></a>
<span class="sourceLineNo">993</span>        else<a name="line.993"></a>
<span class="sourceLineNo">994</span>        {<a name="line.994"></a>
<span class="sourceLineNo">995</span>            return 0;<a name="line.995"></a>
<span class="sourceLineNo">996</span>        }<a name="line.996"></a>
<span class="sourceLineNo">997</span>    }<a name="line.997"></a>
<span class="sourceLineNo">998</span><a name="line.998"></a>
<span class="sourceLineNo">999</span>    @SideOnly(Side.CLIENT)<a name="line.999"></a>
<span class="sourceLineNo">1000</span><a name="line.1000"></a>
<span class="sourceLineNo">1001</span>    /**<a name="line.1001"></a>
<span class="sourceLineNo">1002</span>     * Brightness for SkyBlock.Sky is clear white and (through color computing it is assumed) DEPENDENT ON DAYTIME.<a name="line.1002"></a>
<span class="sourceLineNo">1003</span>     * Brightness for SkyBlock.Block is yellowish and independent.<a name="line.1003"></a>
<span class="sourceLineNo">1004</span>     */<a name="line.1004"></a>
<span class="sourceLineNo">1005</span>    public int getSkyBlockTypeBrightness(EnumSkyBlock par1EnumSkyBlock, int par2, int par3, int par4)<a name="line.1005"></a>
<span class="sourceLineNo">1006</span>    {<a name="line.1006"></a>
<span class="sourceLineNo">1007</span>        if (this.provider.hasNoSky &amp;&amp; par1EnumSkyBlock == EnumSkyBlock.Sky)<a name="line.1007"></a>
<span class="sourceLineNo">1008</span>        {<a name="line.1008"></a>
<span class="sourceLineNo">1009</span>            return 0;<a name="line.1009"></a>
<span class="sourceLineNo">1010</span>        }<a name="line.1010"></a>
<span class="sourceLineNo">1011</span>        else<a name="line.1011"></a>
<span class="sourceLineNo">1012</span>        {<a name="line.1012"></a>
<span class="sourceLineNo">1013</span>            if (par3 &lt; 0)<a name="line.1013"></a>
<span class="sourceLineNo">1014</span>            {<a name="line.1014"></a>
<span class="sourceLineNo">1015</span>                par3 = 0;<a name="line.1015"></a>
<span class="sourceLineNo">1016</span>            }<a name="line.1016"></a>
<span class="sourceLineNo">1017</span><a name="line.1017"></a>
<span class="sourceLineNo">1018</span>            if (par3 &gt;= 256)<a name="line.1018"></a>
<span class="sourceLineNo">1019</span>            {<a name="line.1019"></a>
<span class="sourceLineNo">1020</span>                return par1EnumSkyBlock.defaultLightValue;<a name="line.1020"></a>
<span class="sourceLineNo">1021</span>            }<a name="line.1021"></a>
<span class="sourceLineNo">1022</span>            else if (par2 &gt;= -30000000 &amp;&amp; par4 &gt;= -30000000 &amp;&amp; par2 &lt; 30000000 &amp;&amp; par4 &lt; 30000000)<a name="line.1022"></a>
<span class="sourceLineNo">1023</span>            {<a name="line.1023"></a>
<span class="sourceLineNo">1024</span>                int l = par2 &gt;&gt; 4;<a name="line.1024"></a>
<span class="sourceLineNo">1025</span>                int i1 = par4 &gt;&gt; 4;<a name="line.1025"></a>
<span class="sourceLineNo">1026</span><a name="line.1026"></a>
<span class="sourceLineNo">1027</span>                if (!this.chunkExists(l, i1))<a name="line.1027"></a>
<span class="sourceLineNo">1028</span>                {<a name="line.1028"></a>
<span class="sourceLineNo">1029</span>                    return par1EnumSkyBlock.defaultLightValue;<a name="line.1029"></a>
<span class="sourceLineNo">1030</span>                }<a name="line.1030"></a>
<span class="sourceLineNo">1031</span>                else if (Block.useNeighborBrightness[this.getBlockId(par2, par3, par4)])<a name="line.1031"></a>
<span class="sourceLineNo">1032</span>                {<a name="line.1032"></a>
<span class="sourceLineNo">1033</span>                    int j1 = this.getSavedLightValue(par1EnumSkyBlock, par2, par3 + 1, par4);<a name="line.1033"></a>
<span class="sourceLineNo">1034</span>                    int k1 = this.getSavedLightValue(par1EnumSkyBlock, par2 + 1, par3, par4);<a name="line.1034"></a>
<span class="sourceLineNo">1035</span>                    int l1 = this.getSavedLightValue(par1EnumSkyBlock, par2 - 1, par3, par4);<a name="line.1035"></a>
<span class="sourceLineNo">1036</span>                    int i2 = this.getSavedLightValue(par1EnumSkyBlock, par2, par3, par4 + 1);<a name="line.1036"></a>
<span class="sourceLineNo">1037</span>                    int j2 = this.getSavedLightValue(par1EnumSkyBlock, par2, par3, par4 - 1);<a name="line.1037"></a>
<span class="sourceLineNo">1038</span><a name="line.1038"></a>
<span class="sourceLineNo">1039</span>                    if (k1 &gt; j1)<a name="line.1039"></a>
<span class="sourceLineNo">1040</span>                    {<a name="line.1040"></a>
<span class="sourceLineNo">1041</span>                        j1 = k1;<a name="line.1041"></a>
<span class="sourceLineNo">1042</span>                    }<a name="line.1042"></a>
<span class="sourceLineNo">1043</span><a name="line.1043"></a>
<span class="sourceLineNo">1044</span>                    if (l1 &gt; j1)<a name="line.1044"></a>
<span class="sourceLineNo">1045</span>                    {<a name="line.1045"></a>
<span class="sourceLineNo">1046</span>                        j1 = l1;<a name="line.1046"></a>
<span class="sourceLineNo">1047</span>                    }<a name="line.1047"></a>
<span class="sourceLineNo">1048</span><a name="line.1048"></a>
<span class="sourceLineNo">1049</span>                    if (i2 &gt; j1)<a name="line.1049"></a>
<span class="sourceLineNo">1050</span>                    {<a name="line.1050"></a>
<span class="sourceLineNo">1051</span>                        j1 = i2;<a name="line.1051"></a>
<span class="sourceLineNo">1052</span>                    }<a name="line.1052"></a>
<span class="sourceLineNo">1053</span><a name="line.1053"></a>
<span class="sourceLineNo">1054</span>                    if (j2 &gt; j1)<a name="line.1054"></a>
<span class="sourceLineNo">1055</span>                    {<a name="line.1055"></a>
<span class="sourceLineNo">1056</span>                        j1 = j2;<a name="line.1056"></a>
<span class="sourceLineNo">1057</span>                    }<a name="line.1057"></a>
<span class="sourceLineNo">1058</span><a name="line.1058"></a>
<span class="sourceLineNo">1059</span>                    return j1;<a name="line.1059"></a>
<span class="sourceLineNo">1060</span>                }<a name="line.1060"></a>
<span class="sourceLineNo">1061</span>                else<a name="line.1061"></a>
<span class="sourceLineNo">1062</span>                {<a name="line.1062"></a>
<span class="sourceLineNo">1063</span>                    Chunk chunk = this.getChunkFromChunkCoords(l, i1);<a name="line.1063"></a>
<span class="sourceLineNo">1064</span>                    return chunk.getSavedLightValue(par1EnumSkyBlock, par2 &amp; 15, par3, par4 &amp; 15);<a name="line.1064"></a>
<span class="sourceLineNo">1065</span>                }<a name="line.1065"></a>
<span class="sourceLineNo">1066</span>            }<a name="line.1066"></a>
<span class="sourceLineNo">1067</span>            else<a name="line.1067"></a>
<span class="sourceLineNo">1068</span>            {<a name="line.1068"></a>
<span class="sourceLineNo">1069</span>                return par1EnumSkyBlock.defaultLightValue;<a name="line.1069"></a>
<span class="sourceLineNo">1070</span>            }<a name="line.1070"></a>
<span class="sourceLineNo">1071</span>        }<a name="line.1071"></a>
<span class="sourceLineNo">1072</span>    }<a name="line.1072"></a>
<span class="sourceLineNo">1073</span><a name="line.1073"></a>
<span class="sourceLineNo">1074</span>    /**<a name="line.1074"></a>
<span class="sourceLineNo">1075</span>     * Returns saved light value without taking into account the time of day.  Either looks in the sky light map or<a name="line.1075"></a>
<span class="sourceLineNo">1076</span>     * block light map based on the enumSkyBlock arg.<a name="line.1076"></a>
<span class="sourceLineNo">1077</span>     */<a name="line.1077"></a>
<span class="sourceLineNo">1078</span>    public int getSavedLightValue(EnumSkyBlock par1EnumSkyBlock, int par2, int par3, int par4)<a name="line.1078"></a>
<span class="sourceLineNo">1079</span>    {<a name="line.1079"></a>
<span class="sourceLineNo">1080</span>        if (par3 &lt; 0)<a name="line.1080"></a>
<span class="sourceLineNo">1081</span>        {<a name="line.1081"></a>
<span class="sourceLineNo">1082</span>            par3 = 0;<a name="line.1082"></a>
<span class="sourceLineNo">1083</span>        }<a name="line.1083"></a>
<span class="sourceLineNo">1084</span><a name="line.1084"></a>
<span class="sourceLineNo">1085</span>        if (par3 &gt;= 256)<a name="line.1085"></a>
<span class="sourceLineNo">1086</span>        {<a name="line.1086"></a>
<span class="sourceLineNo">1087</span>            par3 = 255;<a name="line.1087"></a>
<span class="sourceLineNo">1088</span>        }<a name="line.1088"></a>
<span class="sourceLineNo">1089</span><a name="line.1089"></a>
<span class="sourceLineNo">1090</span>        if (par2 &gt;= -30000000 &amp;&amp; par4 &gt;= -30000000 &amp;&amp; par2 &lt; 30000000 &amp;&amp; par4 &lt; 30000000)<a name="line.1090"></a>
<span class="sourceLineNo">1091</span>        {<a name="line.1091"></a>
<span class="sourceLineNo">1092</span>            int l = par2 &gt;&gt; 4;<a name="line.1092"></a>
<span class="sourceLineNo">1093</span>            int i1 = par4 &gt;&gt; 4;<a name="line.1093"></a>
<span class="sourceLineNo">1094</span><a name="line.1094"></a>
<span class="sourceLineNo">1095</span>            if (!this.chunkExists(l, i1))<a name="line.1095"></a>
<span class="sourceLineNo">1096</span>            {<a name="line.1096"></a>
<span class="sourceLineNo">1097</span>                return par1EnumSkyBlock.defaultLightValue;<a name="line.1097"></a>
<span class="sourceLineNo">1098</span>            }<a name="line.1098"></a>
<span class="sourceLineNo">1099</span>            else<a name="line.1099"></a>
<span class="sourceLineNo">1100</span>            {<a name="line.1100"></a>
<span class="sourceLineNo">1101</span>                Chunk chunk = this.getChunkFromChunkCoords(l, i1);<a name="line.1101"></a>
<span class="sourceLineNo">1102</span>                return chunk.getSavedLightValue(par1EnumSkyBlock, par2 &amp; 15, par3, par4 &amp; 15);<a name="line.1102"></a>
<span class="sourceLineNo">1103</span>            }<a name="line.1103"></a>
<span class="sourceLineNo">1104</span>        }<a name="line.1104"></a>
<span class="sourceLineNo">1105</span>        else<a name="line.1105"></a>
<span class="sourceLineNo">1106</span>        {<a name="line.1106"></a>
<span class="sourceLineNo">1107</span>            return par1EnumSkyBlock.defaultLightValue;<a name="line.1107"></a>
<span class="sourceLineNo">1108</span>        }<a name="line.1108"></a>
<span class="sourceLineNo">1109</span>    }<a name="line.1109"></a>
<span class="sourceLineNo">1110</span><a name="line.1110"></a>
<span class="sourceLineNo">1111</span>    /**<a name="line.1111"></a>
<span class="sourceLineNo">1112</span>     * Sets the light value either into the sky map or block map depending on if enumSkyBlock is set to sky or block.<a name="line.1112"></a>
<span class="sourceLineNo">1113</span>     * Args: enumSkyBlock, x, y, z, lightValue<a name="line.1113"></a>
<span class="sourceLineNo">1114</span>     */<a name="line.1114"></a>
<span class="sourceLineNo">1115</span>    public void setLightValue(EnumSkyBlock par1EnumSkyBlock, int par2, int par3, int par4, int par5)<a name="line.1115"></a>
<span class="sourceLineNo">1116</span>    {<a name="line.1116"></a>
<span class="sourceLineNo">1117</span>        if (par2 &gt;= -30000000 &amp;&amp; par4 &gt;= -30000000 &amp;&amp; par2 &lt; 30000000 &amp;&amp; par4 &lt; 30000000)<a name="line.1117"></a>
<span class="sourceLineNo">1118</span>        {<a name="line.1118"></a>
<span class="sourceLineNo">1119</span>            if (par3 &gt;= 0)<a name="line.1119"></a>
<span class="sourceLineNo">1120</span>            {<a name="line.1120"></a>
<span class="sourceLineNo">1121</span>                if (par3 &lt; 256)<a name="line.1121"></a>
<span class="sourceLineNo">1122</span>                {<a name="line.1122"></a>
<span class="sourceLineNo">1123</span>                    if (this.chunkExists(par2 &gt;&gt; 4, par4 &gt;&gt; 4))<a name="line.1123"></a>
<span class="sourceLineNo">1124</span>                    {<a name="line.1124"></a>
<span class="sourceLineNo">1125</span>                        Chunk chunk = this.getChunkFromChunkCoords(par2 &gt;&gt; 4, par4 &gt;&gt; 4);<a name="line.1125"></a>
<span class="sourceLineNo">1126</span>                        chunk.setLightValue(par1EnumSkyBlock, par2 &amp; 15, par3, par4 &amp; 15, par5);<a name="line.1126"></a>
<span class="sourceLineNo">1127</span><a name="line.1127"></a>
<span class="sourceLineNo">1128</span>                        for (int i1 = 0; i1 &lt; this.worldAccesses.size(); ++i1)<a name="line.1128"></a>
<span class="sourceLineNo">1129</span>                        {<a name="line.1129"></a>
<span class="sourceLineNo">1130</span>                            ((IWorldAccess)this.worldAccesses.get(i1)).markBlockForRenderUpdate(par2, par3, par4);<a name="line.1130"></a>
<span class="sourceLineNo">1131</span>                        }<a name="line.1131"></a>
<span class="sourceLineNo">1132</span>                    }<a name="line.1132"></a>
<span class="sourceLineNo">1133</span>                }<a name="line.1133"></a>
<span class="sourceLineNo">1134</span>            }<a name="line.1134"></a>
<span class="sourceLineNo">1135</span>        }<a name="line.1135"></a>
<span class="sourceLineNo">1136</span>    }<a name="line.1136"></a>
<span class="sourceLineNo">1137</span><a name="line.1137"></a>
<span class="sourceLineNo">1138</span>    /**<a name="line.1138"></a>
<span class="sourceLineNo">1139</span>     * On the client, re-renders this block. On the server, does nothing. Used for lighting updates.<a name="line.1139"></a>
<span class="sourceLineNo">1140</span>     */<a name="line.1140"></a>
<span class="sourceLineNo">1141</span>    public void markBlockForRenderUpdate(int par1, int par2, int par3)<a name="line.1141"></a>
<span class="sourceLineNo">1142</span>    {<a name="line.1142"></a>
<span class="sourceLineNo">1143</span>        for (int l = 0; l &lt; this.worldAccesses.size(); ++l)<a name="line.1143"></a>
<span class="sourceLineNo">1144</span>        {<a name="line.1144"></a>
<span class="sourceLineNo">1145</span>            ((IWorldAccess)this.worldAccesses.get(l)).markBlockForRenderUpdate(par1, par2, par3);<a name="line.1145"></a>
<span class="sourceLineNo">1146</span>        }<a name="line.1146"></a>
<span class="sourceLineNo">1147</span>    }<a name="line.1147"></a>
<span class="sourceLineNo">1148</span><a name="line.1148"></a>
<span class="sourceLineNo">1149</span>    @SideOnly(Side.CLIENT)<a name="line.1149"></a>
<span class="sourceLineNo">1150</span><a name="line.1150"></a>
<span class="sourceLineNo">1151</span>    /**<a name="line.1151"></a>
<span class="sourceLineNo">1152</span>     * Any Light rendered on a 1.8 Block goes through here<a name="line.1152"></a>
<span class="sourceLineNo">1153</span>     */<a name="line.1153"></a>
<span class="sourceLineNo">1154</span>    public int getLightBrightnessForSkyBlocks(int par1, int par2, int par3, int par4)<a name="line.1154"></a>
<span class="sourceLineNo">1155</span>    {<a name="line.1155"></a>
<span class="sourceLineNo">1156</span>        int i1 = this.getSkyBlockTypeBrightness(EnumSkyBlock.Sky, par1, par2, par3);<a name="line.1156"></a>
<span class="sourceLineNo">1157</span>        int j1 = this.getSkyBlockTypeBrightness(EnumSkyBlock.Block, par1, par2, par3);<a name="line.1157"></a>
<span class="sourceLineNo">1158</span><a name="line.1158"></a>
<span class="sourceLineNo">1159</span>        if (j1 &lt; par4)<a name="line.1159"></a>
<span class="sourceLineNo">1160</span>        {<a name="line.1160"></a>
<span class="sourceLineNo">1161</span>            j1 = par4;<a name="line.1161"></a>
<span class="sourceLineNo">1162</span>        }<a name="line.1162"></a>
<span class="sourceLineNo">1163</span><a name="line.1163"></a>
<span class="sourceLineNo">1164</span>        return i1 &lt;&lt; 20 | j1 &lt;&lt; 4;<a name="line.1164"></a>
<span class="sourceLineNo">1165</span>    }<a name="line.1165"></a>
<span class="sourceLineNo">1166</span><a name="line.1166"></a>
<span class="sourceLineNo">1167</span>    @SideOnly(Side.CLIENT)<a name="line.1167"></a>
<span class="sourceLineNo">1168</span>    public float getBrightness(int par1, int par2, int par3, int par4)<a name="line.1168"></a>
<span class="sourceLineNo">1169</span>    {<a name="line.1169"></a>
<span class="sourceLineNo">1170</span>        int i1 = this.getBlockLightValue(par1, par2, par3);<a name="line.1170"></a>
<span class="sourceLineNo">1171</span><a name="line.1171"></a>
<span class="sourceLineNo">1172</span>        if (i1 &lt; par4)<a name="line.1172"></a>
<span class="sourceLineNo">1173</span>        {<a name="line.1173"></a>
<span class="sourceLineNo">1174</span>            i1 = par4;<a name="line.1174"></a>
<span class="sourceLineNo">1175</span>        }<a name="line.1175"></a>
<span class="sourceLineNo">1176</span><a name="line.1176"></a>
<span class="sourceLineNo">1177</span>        return this.provider.lightBrightnessTable[i1];<a name="line.1177"></a>
<span class="sourceLineNo">1178</span>    }<a name="line.1178"></a>
<span class="sourceLineNo">1179</span><a name="line.1179"></a>
<span class="sourceLineNo">1180</span>    /**<a name="line.1180"></a>
<span class="sourceLineNo">1181</span>     * Returns how bright the block is shown as which is the block's light value looked up in a lookup table (light<a name="line.1181"></a>
<span class="sourceLineNo">1182</span>     * values aren't linear for brightness). Args: x, y, z<a name="line.1182"></a>
<span class="sourceLineNo">1183</span>     */<a name="line.1183"></a>
<span class="sourceLineNo">1184</span>    public float getLightBrightness(int par1, int par2, int par3)<a name="line.1184"></a>
<span class="sourceLineNo">1185</span>    {<a name="line.1185"></a>
<span class="sourceLineNo">1186</span>        return this.provider.lightBrightnessTable[this.getBlockLightValue(par1, par2, par3)];<a name="line.1186"></a>
<span class="sourceLineNo">1187</span>    }<a name="line.1187"></a>
<span class="sourceLineNo">1188</span><a name="line.1188"></a>
<span class="sourceLineNo">1189</span>    /**<a name="line.1189"></a>
<span class="sourceLineNo">1190</span>     * Checks whether its daytime by seeing if the light subtracted from the skylight is less than 4<a name="line.1190"></a>
<span class="sourceLineNo">1191</span>     */<a name="line.1191"></a>
<span class="sourceLineNo">1192</span>    public boolean isDaytime()<a name="line.1192"></a>
<span class="sourceLineNo">1193</span>    {<a name="line.1193"></a>
<span class="sourceLineNo">1194</span>        return provider.isDaytime();<a name="line.1194"></a>
<span class="sourceLineNo">1195</span>    }<a name="line.1195"></a>
<span class="sourceLineNo">1196</span><a name="line.1196"></a>
<span class="sourceLineNo">1197</span>    /**<a name="line.1197"></a>
<span class="sourceLineNo">1198</span>     * ray traces all blocks, including non-collideable ones<a name="line.1198"></a>
<span class="sourceLineNo">1199</span>     */<a name="line.1199"></a>
<span class="sourceLineNo">1200</span>    public MovingObjectPosition rayTraceBlocks(Vec3 par1Vec3, Vec3 par2Vec3)<a name="line.1200"></a>
<span class="sourceLineNo">1201</span>    {<a name="line.1201"></a>
<span class="sourceLineNo">1202</span>        return this.rayTraceBlocks_do_do(par1Vec3, par2Vec3, false, false);<a name="line.1202"></a>
<span class="sourceLineNo">1203</span>    }<a name="line.1203"></a>
<span class="sourceLineNo">1204</span><a name="line.1204"></a>
<span class="sourceLineNo">1205</span>    public MovingObjectPosition rayTraceBlocks_do(Vec3 par1Vec3, Vec3 par2Vec3, boolean par3)<a name="line.1205"></a>
<span class="sourceLineNo">1206</span>    {<a name="line.1206"></a>
<span class="sourceLineNo">1207</span>        return this.rayTraceBlocks_do_do(par1Vec3, par2Vec3, par3, false);<a name="line.1207"></a>
<span class="sourceLineNo">1208</span>    }<a name="line.1208"></a>
<span class="sourceLineNo">1209</span><a name="line.1209"></a>
<span class="sourceLineNo">1210</span>    public MovingObjectPosition rayTraceBlocks_do_do(Vec3 par1Vec3, Vec3 par2Vec3, boolean par3, boolean par4)<a name="line.1210"></a>
<span class="sourceLineNo">1211</span>    {<a name="line.1211"></a>
<span class="sourceLineNo">1212</span>        if (!Double.isNaN(par1Vec3.xCoord) &amp;&amp; !Double.isNaN(par1Vec3.yCoord) &amp;&amp; !Double.isNaN(par1Vec3.zCoord))<a name="line.1212"></a>
<span class="sourceLineNo">1213</span>        {<a name="line.1213"></a>
<span class="sourceLineNo">1214</span>            if (!Double.isNaN(par2Vec3.xCoord) &amp;&amp; !Double.isNaN(par2Vec3.yCoord) &amp;&amp; !Double.isNaN(par2Vec3.zCoord))<a name="line.1214"></a>
<span class="sourceLineNo">1215</span>            {<a name="line.1215"></a>
<span class="sourceLineNo">1216</span>                int i = MathHelper.floor_double(par2Vec3.xCoord);<a name="line.1216"></a>
<span class="sourceLineNo">1217</span>                int j = MathHelper.floor_double(par2Vec3.yCoord);<a name="line.1217"></a>
<span class="sourceLineNo">1218</span>                int k = MathHelper.floor_double(par2Vec3.zCoord);<a name="line.1218"></a>
<span class="sourceLineNo">1219</span>                int l = MathHelper.floor_double(par1Vec3.xCoord);<a name="line.1219"></a>
<span class="sourceLineNo">1220</span>                int i1 = MathHelper.floor_double(par1Vec3.yCoord);<a name="line.1220"></a>
<span class="sourceLineNo">1221</span>                int j1 = MathHelper.floor_double(par1Vec3.zCoord);<a name="line.1221"></a>
<span class="sourceLineNo">1222</span>                int k1 = this.getBlockId(l, i1, j1);<a name="line.1222"></a>
<span class="sourceLineNo">1223</span>                int l1 = this.getBlockMetadata(l, i1, j1);<a name="line.1223"></a>
<span class="sourceLineNo">1224</span>                Block block = Block.blocksList[k1];<a name="line.1224"></a>
<span class="sourceLineNo">1225</span><a name="line.1225"></a>
<span class="sourceLineNo">1226</span>                if (block != null &amp;&amp; (!par4 || block == null || block.getCollisionBoundingBoxFromPool(this, l, i1, j1) != null) &amp;&amp; k1 &gt; 0 &amp;&amp; block.canCollideCheck(l1, par3))<a name="line.1226"></a>
<span class="sourceLineNo">1227</span>                {<a name="line.1227"></a>
<span class="sourceLineNo">1228</span>                    MovingObjectPosition movingobjectposition = block.collisionRayTrace(this, l, i1, j1, par1Vec3, par2Vec3);<a name="line.1228"></a>
<span class="sourceLineNo">1229</span><a name="line.1229"></a>
<span class="sourceLineNo">1230</span>                    if (movingobjectposition != null)<a name="line.1230"></a>
<span class="sourceLineNo">1231</span>                    {<a name="line.1231"></a>
<span class="sourceLineNo">1232</span>                        return movingobjectposition;<a name="line.1232"></a>
<span class="sourceLineNo">1233</span>                    }<a name="line.1233"></a>
<span class="sourceLineNo">1234</span>                }<a name="line.1234"></a>
<span class="sourceLineNo">1235</span><a name="line.1235"></a>
<span class="sourceLineNo">1236</span>                k1 = 200;<a name="line.1236"></a>
<span class="sourceLineNo">1237</span><a name="line.1237"></a>
<span class="sourceLineNo">1238</span>                while (k1-- &gt;= 0)<a name="line.1238"></a>
<span class="sourceLineNo">1239</span>                {<a name="line.1239"></a>
<span class="sourceLineNo">1240</span>                    if (Double.isNaN(par1Vec3.xCoord) || Double.isNaN(par1Vec3.yCoord) || Double.isNaN(par1Vec3.zCoord))<a name="line.1240"></a>
<span class="sourceLineNo">1241</span>                    {<a name="line.1241"></a>
<span class="sourceLineNo">1242</span>                        return null;<a name="line.1242"></a>
<span class="sourceLineNo">1243</span>                    }<a name="line.1243"></a>
<span class="sourceLineNo">1244</span><a name="line.1244"></a>
<span class="sourceLineNo">1245</span>                    if (l == i &amp;&amp; i1 == j &amp;&amp; j1 == k)<a name="line.1245"></a>
<span class="sourceLineNo">1246</span>                    {<a name="line.1246"></a>
<span class="sourceLineNo">1247</span>                        return null;<a name="line.1247"></a>
<span class="sourceLineNo">1248</span>                    }<a name="line.1248"></a>
<span class="sourceLineNo">1249</span><a name="line.1249"></a>
<span class="sourceLineNo">1250</span>                    boolean flag2 = true;<a name="line.1250"></a>
<span class="sourceLineNo">1251</span>                    boolean flag3 = true;<a name="line.1251"></a>
<span class="sourceLineNo">1252</span>                    boolean flag4 = true;<a name="line.1252"></a>
<span class="sourceLineNo">1253</span>                    double d0 = 999.0D;<a name="line.1253"></a>
<span class="sourceLineNo">1254</span>                    double d1 = 999.0D;<a name="line.1254"></a>
<span class="sourceLineNo">1255</span>                    double d2 = 999.0D;<a name="line.1255"></a>
<span class="sourceLineNo">1256</span><a name="line.1256"></a>
<span class="sourceLineNo">1257</span>                    if (i &gt; l)<a name="line.1257"></a>
<span class="sourceLineNo">1258</span>                    {<a name="line.1258"></a>
<span class="sourceLineNo">1259</span>                        d0 = (double)l + 1.0D;<a name="line.1259"></a>
<span class="sourceLineNo">1260</span>                    }<a name="line.1260"></a>
<span class="sourceLineNo">1261</span>                    else if (i &lt; l)<a name="line.1261"></a>
<span class="sourceLineNo">1262</span>                    {<a name="line.1262"></a>
<span class="sourceLineNo">1263</span>                        d0 = (double)l + 0.0D;<a name="line.1263"></a>
<span class="sourceLineNo">1264</span>                    }<a name="line.1264"></a>
<span class="sourceLineNo">1265</span>                    else<a name="line.1265"></a>
<span class="sourceLineNo">1266</span>                    {<a name="line.1266"></a>
<span class="sourceLineNo">1267</span>                        flag2 = false;<a name="line.1267"></a>
<span class="sourceLineNo">1268</span>                    }<a name="line.1268"></a>
<span class="sourceLineNo">1269</span><a name="line.1269"></a>
<span class="sourceLineNo">1270</span>                    if (j &gt; i1)<a name="line.1270"></a>
<span class="sourceLineNo">1271</span>                    {<a name="line.1271"></a>
<span class="sourceLineNo">1272</span>                        d1 = (double)i1 + 1.0D;<a name="line.1272"></a>
<span class="sourceLineNo">1273</span>                    }<a name="line.1273"></a>
<span class="sourceLineNo">1274</span>                    else if (j &lt; i1)<a name="line.1274"></a>
<span class="sourceLineNo">1275</span>                    {<a name="line.1275"></a>
<span class="sourceLineNo">1276</span>                        d1 = (double)i1 + 0.0D;<a name="line.1276"></a>
<span class="sourceLineNo">1277</span>                    }<a name="line.1277"></a>
<span class="sourceLineNo">1278</span>                    else<a name="line.1278"></a>
<span class="sourceLineNo">1279</span>                    {<a name="line.1279"></a>
<span class="sourceLineNo">1280</span>                        flag3 = false;<a name="line.1280"></a>
<span class="sourceLineNo">1281</span>                    }<a name="line.1281"></a>
<span class="sourceLineNo">1282</span><a name="line.1282"></a>
<span class="sourceLineNo">1283</span>                    if (k &gt; j1)<a name="line.1283"></a>
<span class="sourceLineNo">1284</span>                    {<a name="line.1284"></a>
<span class="sourceLineNo">1285</span>                        d2 = (double)j1 + 1.0D;<a name="line.1285"></a>
<span class="sourceLineNo">1286</span>                    }<a name="line.1286"></a>
<span class="sourceLineNo">1287</span>                    else if (k &lt; j1)<a name="line.1287"></a>
<span class="sourceLineNo">1288</span>                    {<a name="line.1288"></a>
<span class="sourceLineNo">1289</span>                        d2 = (double)j1 + 0.0D;<a name="line.1289"></a>
<span class="sourceLineNo">1290</span>                    }<a name="line.1290"></a>
<span class="sourceLineNo">1291</span>                    else<a name="line.1291"></a>
<span class="sourceLineNo">1292</span>                    {<a name="line.1292"></a>
<span class="sourceLineNo">1293</span>                        flag4 = false;<a name="line.1293"></a>
<span class="sourceLineNo">1294</span>                    }<a name="line.1294"></a>
<span class="sourceLineNo">1295</span><a name="line.1295"></a>
<span class="sourceLineNo">1296</span>                    double d3 = 999.0D;<a name="line.1296"></a>
<span class="sourceLineNo">1297</span>                    double d4 = 999.0D;<a name="line.1297"></a>
<span class="sourceLineNo">1298</span>                    double d5 = 999.0D;<a name="line.1298"></a>
<span class="sourceLineNo">1299</span>                    double d6 = par2Vec3.xCoord - par1Vec3.xCoord;<a name="line.1299"></a>
<span class="sourceLineNo">1300</span>                    double d7 = par2Vec3.yCoord - par1Vec3.yCoord;<a name="line.1300"></a>
<span class="sourceLineNo">1301</span>                    double d8 = par2Vec3.zCoord - par1Vec3.zCoord;<a name="line.1301"></a>
<span class="sourceLineNo">1302</span><a name="line.1302"></a>
<span class="sourceLineNo">1303</span>                    if (flag2)<a name="line.1303"></a>
<span class="sourceLineNo">1304</span>                    {<a name="line.1304"></a>
<span class="sourceLineNo">1305</span>                        d3 = (d0 - par1Vec3.xCoord) / d6;<a name="line.1305"></a>
<span class="sourceLineNo">1306</span>                    }<a name="line.1306"></a>
<span class="sourceLineNo">1307</span><a name="line.1307"></a>
<span class="sourceLineNo">1308</span>                    if (flag3)<a name="line.1308"></a>
<span class="sourceLineNo">1309</span>                    {<a name="line.1309"></a>
<span class="sourceLineNo">1310</span>                        d4 = (d1 - par1Vec3.yCoord) / d7;<a name="line.1310"></a>
<span class="sourceLineNo">1311</span>                    }<a name="line.1311"></a>
<span class="sourceLineNo">1312</span><a name="line.1312"></a>
<span class="sourceLineNo">1313</span>                    if (flag4)<a name="line.1313"></a>
<span class="sourceLineNo">1314</span>                    {<a name="line.1314"></a>
<span class="sourceLineNo">1315</span>                        d5 = (d2 - par1Vec3.zCoord) / d8;<a name="line.1315"></a>
<span class="sourceLineNo">1316</span>                    }<a name="line.1316"></a>
<span class="sourceLineNo">1317</span><a name="line.1317"></a>
<span class="sourceLineNo">1318</span>                    boolean flag5 = false;<a name="line.1318"></a>
<span class="sourceLineNo">1319</span>                    byte b0;<a name="line.1319"></a>
<span class="sourceLineNo">1320</span><a name="line.1320"></a>
<span class="sourceLineNo">1321</span>                    if (d3 &lt; d4 &amp;&amp; d3 &lt; d5)<a name="line.1321"></a>
<span class="sourceLineNo">1322</span>                    {<a name="line.1322"></a>
<span class="sourceLineNo">1323</span>                        if (i &gt; l)<a name="line.1323"></a>
<span class="sourceLineNo">1324</span>                        {<a name="line.1324"></a>
<span class="sourceLineNo">1325</span>                            b0 = 4;<a name="line.1325"></a>
<span class="sourceLineNo">1326</span>                        }<a name="line.1326"></a>
<span class="sourceLineNo">1327</span>                        else<a name="line.1327"></a>
<span class="sourceLineNo">1328</span>                        {<a name="line.1328"></a>
<span class="sourceLineNo">1329</span>                            b0 = 5;<a name="line.1329"></a>
<span class="sourceLineNo">1330</span>                        }<a name="line.1330"></a>
<span class="sourceLineNo">1331</span><a name="line.1331"></a>
<span class="sourceLineNo">1332</span>                        par1Vec3.xCoord = d0;<a name="line.1332"></a>
<span class="sourceLineNo">1333</span>                        par1Vec3.yCoord += d7 * d3;<a name="line.1333"></a>
<span class="sourceLineNo">1334</span>                        par1Vec3.zCoord += d8 * d3;<a name="line.1334"></a>
<span class="sourceLineNo">1335</span>                    }<a name="line.1335"></a>
<span class="sourceLineNo">1336</span>                    else if (d4 &lt; d5)<a name="line.1336"></a>
<span class="sourceLineNo">1337</span>                    {<a name="line.1337"></a>
<span class="sourceLineNo">1338</span>                        if (j &gt; i1)<a name="line.1338"></a>
<span class="sourceLineNo">1339</span>                        {<a name="line.1339"></a>
<span class="sourceLineNo">1340</span>                            b0 = 0;<a name="line.1340"></a>
<span class="sourceLineNo">1341</span>                        }<a name="line.1341"></a>
<span class="sourceLineNo">1342</span>                        else<a name="line.1342"></a>
<span class="sourceLineNo">1343</span>                        {<a name="line.1343"></a>
<span class="sourceLineNo">1344</span>                            b0 = 1;<a name="line.1344"></a>
<span class="sourceLineNo">1345</span>                        }<a name="line.1345"></a>
<span class="sourceLineNo">1346</span><a name="line.1346"></a>
<span class="sourceLineNo">1347</span>                        par1Vec3.xCoord += d6 * d4;<a name="line.1347"></a>
<span class="sourceLineNo">1348</span>                        par1Vec3.yCoord = d1;<a name="line.1348"></a>
<span class="sourceLineNo">1349</span>                        par1Vec3.zCoord += d8 * d4;<a name="line.1349"></a>
<span class="sourceLineNo">1350</span>                    }<a name="line.1350"></a>
<span class="sourceLineNo">1351</span>                    else<a name="line.1351"></a>
<span class="sourceLineNo">1352</span>                    {<a name="line.1352"></a>
<span class="sourceLineNo">1353</span>                        if (k &gt; j1)<a name="line.1353"></a>
<span class="sourceLineNo">1354</span>                        {<a name="line.1354"></a>
<span class="sourceLineNo">1355</span>                            b0 = 2;<a name="line.1355"></a>
<span class="sourceLineNo">1356</span>                        }<a name="line.1356"></a>
<span class="sourceLineNo">1357</span>                        else<a name="line.1357"></a>
<span class="sourceLineNo">1358</span>                        {<a name="line.1358"></a>
<span class="sourceLineNo">1359</span>                            b0 = 3;<a name="line.1359"></a>
<span class="sourceLineNo">1360</span>                        }<a name="line.1360"></a>
<span class="sourceLineNo">1361</span><a name="line.1361"></a>
<span class="sourceLineNo">1362</span>                        par1Vec3.xCoord += d6 * d5;<a name="line.1362"></a>
<span class="sourceLineNo">1363</span>                        par1Vec3.yCoord += d7 * d5;<a name="line.1363"></a>
<span class="sourceLineNo">1364</span>                        par1Vec3.zCoord = d2;<a name="line.1364"></a>
<span class="sourceLineNo">1365</span>                    }<a name="line.1365"></a>
<span class="sourceLineNo">1366</span><a name="line.1366"></a>
<span class="sourceLineNo">1367</span>                    Vec3 vec32 = this.getWorldVec3Pool().getVecFromPool(par1Vec3.xCoord, par1Vec3.yCoord, par1Vec3.zCoord);<a name="line.1367"></a>
<span class="sourceLineNo">1368</span>                    l = (int)(vec32.xCoord = (double)MathHelper.floor_double(par1Vec3.xCoord));<a name="line.1368"></a>
<span class="sourceLineNo">1369</span><a name="line.1369"></a>
<span class="sourceLineNo">1370</span>                    if (b0 == 5)<a name="line.1370"></a>
<span class="sourceLineNo">1371</span>                    {<a name="line.1371"></a>
<span class="sourceLineNo">1372</span>                        --l;<a name="line.1372"></a>
<span class="sourceLineNo">1373</span>                        ++vec32.xCoord;<a name="line.1373"></a>
<span class="sourceLineNo">1374</span>                    }<a name="line.1374"></a>
<span class="sourceLineNo">1375</span><a name="line.1375"></a>
<span class="sourceLineNo">1376</span>                    i1 = (int)(vec32.yCoord = (double)MathHelper.floor_double(par1Vec3.yCoord));<a name="line.1376"></a>
<span class="sourceLineNo">1377</span><a name="line.1377"></a>
<span class="sourceLineNo">1378</span>                    if (b0 == 1)<a name="line.1378"></a>
<span class="sourceLineNo">1379</span>                    {<a name="line.1379"></a>
<span class="sourceLineNo">1380</span>                        --i1;<a name="line.1380"></a>
<span class="sourceLineNo">1381</span>                        ++vec32.yCoord;<a name="line.1381"></a>
<span class="sourceLineNo">1382</span>                    }<a name="line.1382"></a>
<span class="sourceLineNo">1383</span><a name="line.1383"></a>
<span class="sourceLineNo">1384</span>                    j1 = (int)(vec32.zCoord = (double)MathHelper.floor_double(par1Vec3.zCoord));<a name="line.1384"></a>
<span class="sourceLineNo">1385</span><a name="line.1385"></a>
<span class="sourceLineNo">1386</span>                    if (b0 == 3)<a name="line.1386"></a>
<span class="sourceLineNo">1387</span>                    {<a name="line.1387"></a>
<span class="sourceLineNo">1388</span>                        --j1;<a name="line.1388"></a>
<span class="sourceLineNo">1389</span>                        ++vec32.zCoord;<a name="line.1389"></a>
<span class="sourceLineNo">1390</span>                    }<a name="line.1390"></a>
<span class="sourceLineNo">1391</span><a name="line.1391"></a>
<span class="sourceLineNo">1392</span>                    int i2 = this.getBlockId(l, i1, j1);<a name="line.1392"></a>
<span class="sourceLineNo">1393</span>                    int j2 = this.getBlockMetadata(l, i1, j1);<a name="line.1393"></a>
<span class="sourceLineNo">1394</span>                    Block block1 = Block.blocksList[i2];<a name="line.1394"></a>
<span class="sourceLineNo">1395</span><a name="line.1395"></a>
<span class="sourceLineNo">1396</span>                    if ((!par4 || block1 == null || block1.getCollisionBoundingBoxFromPool(this, l, i1, j1) != null) &amp;&amp; i2 &gt; 0 &amp;&amp; block1.canCollideCheck(j2, par3))<a name="line.1396"></a>
<span class="sourceLineNo">1397</span>                    {<a name="line.1397"></a>
<span class="sourceLineNo">1398</span>                        MovingObjectPosition movingobjectposition1 = block1.collisionRayTrace(this, l, i1, j1, par1Vec3, par2Vec3);<a name="line.1398"></a>
<span class="sourceLineNo">1399</span><a name="line.1399"></a>
<span class="sourceLineNo">1400</span>                        if (movingobjectposition1 != null)<a name="line.1400"></a>
<span class="sourceLineNo">1401</span>                        {<a name="line.1401"></a>
<span class="sourceLineNo">1402</span>                            return movingobjectposition1;<a name="line.1402"></a>
<span class="sourceLineNo">1403</span>                        }<a name="line.1403"></a>
<span class="sourceLineNo">1404</span>                    }<a name="line.1404"></a>
<span class="sourceLineNo">1405</span>                }<a name="line.1405"></a>
<span class="sourceLineNo">1406</span><a name="line.1406"></a>
<span class="sourceLineNo">1407</span>                return null;<a name="line.1407"></a>
<span class="sourceLineNo">1408</span>            }<a name="line.1408"></a>
<span class="sourceLineNo">1409</span>            else<a name="line.1409"></a>
<span class="sourceLineNo">1410</span>            {<a name="line.1410"></a>
<span class="sourceLineNo">1411</span>                return null;<a name="line.1411"></a>
<span class="sourceLineNo">1412</span>            }<a name="line.1412"></a>
<span class="sourceLineNo">1413</span>        }<a name="line.1413"></a>
<span class="sourceLineNo">1414</span>        else<a name="line.1414"></a>
<span class="sourceLineNo">1415</span>        {<a name="line.1415"></a>
<span class="sourceLineNo">1416</span>            return null;<a name="line.1416"></a>
<span class="sourceLineNo">1417</span>        }<a name="line.1417"></a>
<span class="sourceLineNo">1418</span>    }<a name="line.1418"></a>
<span class="sourceLineNo">1419</span><a name="line.1419"></a>
<span class="sourceLineNo">1420</span>    /**<a name="line.1420"></a>
<span class="sourceLineNo">1421</span>     * Plays a sound at the entity's position. Args: entity, sound, volume (relative to 1.0), and frequency (or pitch,<a name="line.1421"></a>
<span class="sourceLineNo">1422</span>     * also relative to 1.0).<a name="line.1422"></a>
<span class="sourceLineNo">1423</span>     */<a name="line.1423"></a>
<span class="sourceLineNo">1424</span>    public void playSoundAtEntity(Entity par1Entity, String par2Str, float par3, float par4)<a name="line.1424"></a>
<span class="sourceLineNo">1425</span>    {<a name="line.1425"></a>
<span class="sourceLineNo">1426</span>        PlaySoundAtEntityEvent event = new PlaySoundAtEntityEvent(par1Entity, par2Str, par3, par4);<a name="line.1426"></a>
<span class="sourceLineNo">1427</span>        if (MinecraftForge.EVENT_BUS.post(event))<a name="line.1427"></a>
<span class="sourceLineNo">1428</span>        {<a name="line.1428"></a>
<span class="sourceLineNo">1429</span>            return;<a name="line.1429"></a>
<span class="sourceLineNo">1430</span>        }<a name="line.1430"></a>
<span class="sourceLineNo">1431</span>        par2Str = event.name;<a name="line.1431"></a>
<span class="sourceLineNo">1432</span>        if (par1Entity != null &amp;&amp; par2Str != null)<a name="line.1432"></a>
<span class="sourceLineNo">1433</span>        {<a name="line.1433"></a>
<span class="sourceLineNo">1434</span>            for (int i = 0; i &lt; this.worldAccesses.size(); ++i)<a name="line.1434"></a>
<span class="sourceLineNo">1435</span>            {<a name="line.1435"></a>
<span class="sourceLineNo">1436</span>                ((IWorldAccess)this.worldAccesses.get(i)).playSound(par2Str, par1Entity.posX, par1Entity.posY - (double)par1Entity.yOffset, par1Entity.posZ, par3, par4);<a name="line.1436"></a>
<span class="sourceLineNo">1437</span>            }<a name="line.1437"></a>
<span class="sourceLineNo">1438</span>        }<a name="line.1438"></a>
<span class="sourceLineNo">1439</span>    }<a name="line.1439"></a>
<span class="sourceLineNo">1440</span><a name="line.1440"></a>
<span class="sourceLineNo">1441</span>    /**<a name="line.1441"></a>
<span class="sourceLineNo">1442</span>     * Plays sound to all near players except the player reference given<a name="line.1442"></a>
<span class="sourceLineNo">1443</span>     */<a name="line.1443"></a>
<span class="sourceLineNo">1444</span>    public void playSoundToNearExcept(EntityPlayer par1EntityPlayer, String par2Str, float par3, float par4)<a name="line.1444"></a>
<span class="sourceLineNo">1445</span>    {<a name="line.1445"></a>
<span class="sourceLineNo">1446</span>        PlaySoundAtEntityEvent event = new PlaySoundAtEntityEvent(par1EntityPlayer, par2Str, par3, par4);<a name="line.1446"></a>
<span class="sourceLineNo">1447</span>        if (MinecraftForge.EVENT_BUS.post(event))<a name="line.1447"></a>
<span class="sourceLineNo">1448</span>        {<a name="line.1448"></a>
<span class="sourceLineNo">1449</span>            return;<a name="line.1449"></a>
<span class="sourceLineNo">1450</span>        }<a name="line.1450"></a>
<span class="sourceLineNo">1451</span>        par2Str = event.name;<a name="line.1451"></a>
<span class="sourceLineNo">1452</span>        if (par1EntityPlayer != null &amp;&amp; par2Str != null)<a name="line.1452"></a>
<span class="sourceLineNo">1453</span>        {<a name="line.1453"></a>
<span class="sourceLineNo">1454</span>            for (int i = 0; i &lt; this.worldAccesses.size(); ++i)<a name="line.1454"></a>
<span class="sourceLineNo">1455</span>            {<a name="line.1455"></a>
<span class="sourceLineNo">1456</span>                ((IWorldAccess)this.worldAccesses.get(i)).playSoundToNearExcept(par1EntityPlayer, par2Str, par1EntityPlayer.posX, par1EntityPlayer.posY - (double)par1EntityPlayer.yOffset, par1EntityPlayer.posZ, par3, par4);<a name="line.1456"></a>
<span class="sourceLineNo">1457</span>            }<a name="line.1457"></a>
<span class="sourceLineNo">1458</span>        }<a name="line.1458"></a>
<span class="sourceLineNo">1459</span>    }<a name="line.1459"></a>
<span class="sourceLineNo">1460</span><a name="line.1460"></a>
<span class="sourceLineNo">1461</span>    /**<a name="line.1461"></a>
<span class="sourceLineNo">1462</span>     * Play a sound effect. Many many parameters for this function. Not sure what they do, but a classic call is :<a name="line.1462"></a>
<span class="sourceLineNo">1463</span>     * (double)i + 0.5D, (double)j + 0.5D, (double)k + 0.5D, 'random.door_open', 1.0F, world.rand.nextFloat() * 0.1F +<a name="line.1463"></a>
<span class="sourceLineNo">1464</span>     * 0.9F with i,j,k position of the block.<a name="line.1464"></a>
<span class="sourceLineNo">1465</span>     */<a name="line.1465"></a>
<span class="sourceLineNo">1466</span>    public void playSoundEffect(double par1, double par3, double par5, String par7Str, float par8, float par9)<a name="line.1466"></a>
<span class="sourceLineNo">1467</span>    {<a name="line.1467"></a>
<span class="sourceLineNo">1468</span>        if (par7Str != null)<a name="line.1468"></a>
<span class="sourceLineNo">1469</span>        {<a name="line.1469"></a>
<span class="sourceLineNo">1470</span>            for (int i = 0; i &lt; this.worldAccesses.size(); ++i)<a name="line.1470"></a>
<span class="sourceLineNo">1471</span>            {<a name="line.1471"></a>
<span class="sourceLineNo">1472</span>                ((IWorldAccess)this.worldAccesses.get(i)).playSound(par7Str, par1, par3, par5, par8, par9);<a name="line.1472"></a>
<span class="sourceLineNo">1473</span>            }<a name="line.1473"></a>
<span class="sourceLineNo">1474</span>        }<a name="line.1474"></a>
<span class="sourceLineNo">1475</span>    }<a name="line.1475"></a>
<span class="sourceLineNo">1476</span><a name="line.1476"></a>
<span class="sourceLineNo">1477</span>    /**<a name="line.1477"></a>
<span class="sourceLineNo">1478</span>     * par8 is loudness, all pars passed to minecraftInstance.sndManager.playSound<a name="line.1478"></a>
<span class="sourceLineNo">1479</span>     */<a name="line.1479"></a>
<span class="sourceLineNo">1480</span>    public void playSound(double par1, double par3, double par5, String par7Str, float par8, float par9, boolean par10) {}<a name="line.1480"></a>
<span class="sourceLineNo">1481</span><a name="line.1481"></a>
<span class="sourceLineNo">1482</span>    /**<a name="line.1482"></a>
<span class="sourceLineNo">1483</span>     * Plays a record at the specified coordinates of the specified name. Args: recordName, x, y, z<a name="line.1483"></a>
<span class="sourceLineNo">1484</span>     */<a name="line.1484"></a>
<span class="sourceLineNo">1485</span>    public void playRecord(String par1Str, int par2, int par3, int par4)<a name="line.1485"></a>
<span class="sourceLineNo">1486</span>    {<a name="line.1486"></a>
<span class="sourceLineNo">1487</span>        for (int l = 0; l &lt; this.worldAccesses.size(); ++l)<a name="line.1487"></a>
<span class="sourceLineNo">1488</span>        {<a name="line.1488"></a>
<span class="sourceLineNo">1489</span>            ((IWorldAccess)this.worldAccesses.get(l)).playRecord(par1Str, par2, par3, par4);<a name="line.1489"></a>
<span class="sourceLineNo">1490</span>        }<a name="line.1490"></a>
<span class="sourceLineNo">1491</span>    }<a name="line.1491"></a>
<span class="sourceLineNo">1492</span><a name="line.1492"></a>
<span class="sourceLineNo">1493</span>    /**<a name="line.1493"></a>
<span class="sourceLineNo">1494</span>     * Spawns a particle.  Args particleName, x, y, z, velX, velY, velZ<a name="line.1494"></a>
<span class="sourceLineNo">1495</span>     */<a name="line.1495"></a>
<span class="sourceLineNo">1496</span>    public void spawnParticle(String par1Str, double par2, double par4, double par6, double par8, double par10, double par12)<a name="line.1496"></a>
<span class="sourceLineNo">1497</span>    {<a name="line.1497"></a>
<span class="sourceLineNo">1498</span>        for (int i = 0; i &lt; this.worldAccesses.size(); ++i)<a name="line.1498"></a>
<span class="sourceLineNo">1499</span>        {<a name="line.1499"></a>
<span class="sourceLineNo">1500</span>            ((IWorldAccess)this.worldAccesses.get(i)).spawnParticle(par1Str, par2, par4, par6, par8, par10, par12);<a name="line.1500"></a>
<span class="sourceLineNo">1501</span>        }<a name="line.1501"></a>
<span class="sourceLineNo">1502</span>    }<a name="line.1502"></a>
<span class="sourceLineNo">1503</span><a name="line.1503"></a>
<span class="sourceLineNo">1504</span>    /**<a name="line.1504"></a>
<span class="sourceLineNo">1505</span>     * adds a lightning bolt to the list of lightning bolts in this world.<a name="line.1505"></a>
<span class="sourceLineNo">1506</span>     */<a name="line.1506"></a>
<span class="sourceLineNo">1507</span>    public boolean addWeatherEffect(Entity par1Entity)<a name="line.1507"></a>
<span class="sourceLineNo">1508</span>    {<a name="line.1508"></a>
<span class="sourceLineNo">1509</span>        this.weatherEffects.add(par1Entity);<a name="line.1509"></a>
<span class="sourceLineNo">1510</span>        return true;<a name="line.1510"></a>
<span class="sourceLineNo">1511</span>    }<a name="line.1511"></a>
<span class="sourceLineNo">1512</span><a name="line.1512"></a>
<span class="sourceLineNo">1513</span>    /**<a name="line.1513"></a>
<span class="sourceLineNo">1514</span>     * Called to place all entities as part of a world<a name="line.1514"></a>
<span class="sourceLineNo">1515</span>     */<a name="line.1515"></a>
<span class="sourceLineNo">1516</span>    public boolean spawnEntityInWorld(Entity par1Entity)<a name="line.1516"></a>
<span class="sourceLineNo">1517</span>    {<a name="line.1517"></a>
<span class="sourceLineNo">1518</span>        int i = MathHelper.floor_double(par1Entity.posX / 16.0D);<a name="line.1518"></a>
<span class="sourceLineNo">1519</span>        int j = MathHelper.floor_double(par1Entity.posZ / 16.0D);<a name="line.1519"></a>
<span class="sourceLineNo">1520</span>        boolean flag = par1Entity.field_98038_p;<a name="line.1520"></a>
<span class="sourceLineNo">1521</span><a name="line.1521"></a>
<span class="sourceLineNo">1522</span>        if (par1Entity instanceof EntityPlayer)<a name="line.1522"></a>
<span class="sourceLineNo">1523</span>        {<a name="line.1523"></a>
<span class="sourceLineNo">1524</span>            flag = true;<a name="line.1524"></a>
<span class="sourceLineNo">1525</span>        }<a name="line.1525"></a>
<span class="sourceLineNo">1526</span><a name="line.1526"></a>
<span class="sourceLineNo">1527</span>        if (!flag &amp;&amp; !this.chunkExists(i, j))<a name="line.1527"></a>
<span class="sourceLineNo">1528</span>        {<a name="line.1528"></a>
<span class="sourceLineNo">1529</span>            return false;<a name="line.1529"></a>
<span class="sourceLineNo">1530</span>        }<a name="line.1530"></a>
<span class="sourceLineNo">1531</span>        else<a name="line.1531"></a>
<span class="sourceLineNo">1532</span>        {<a name="line.1532"></a>
<span class="sourceLineNo">1533</span>            if (par1Entity instanceof EntityPlayer)<a name="line.1533"></a>
<span class="sourceLineNo">1534</span>            {<a name="line.1534"></a>
<span class="sourceLineNo">1535</span>                EntityPlayer entityplayer = (EntityPlayer)par1Entity;<a name="line.1535"></a>
<span class="sourceLineNo">1536</span>                this.playerEntities.add(entityplayer);<a name="line.1536"></a>
<span class="sourceLineNo">1537</span>                this.updateAllPlayersSleepingFlag();<a name="line.1537"></a>
<span class="sourceLineNo">1538</span>            }<a name="line.1538"></a>
<span class="sourceLineNo">1539</span><a name="line.1539"></a>
<span class="sourceLineNo">1540</span>            if (!flag &amp;&amp; MinecraftForge.EVENT_BUS.post(new EntityJoinWorldEvent(par1Entity, this)))<a name="line.1540"></a>
<span class="sourceLineNo">1541</span>            {<a name="line.1541"></a>
<span class="sourceLineNo">1542</span>                return false;<a name="line.1542"></a>
<span class="sourceLineNo">1543</span>            }<a name="line.1543"></a>
<span class="sourceLineNo">1544</span><a name="line.1544"></a>
<span class="sourceLineNo">1545</span>            this.getChunkFromChunkCoords(i, j).addEntity(par1Entity);<a name="line.1545"></a>
<span class="sourceLineNo">1546</span>            this.loadedEntityList.add(par1Entity);<a name="line.1546"></a>
<span class="sourceLineNo">1547</span>            this.obtainEntitySkin(par1Entity);<a name="line.1547"></a>
<span class="sourceLineNo">1548</span>            return true;<a name="line.1548"></a>
<span class="sourceLineNo">1549</span>        }<a name="line.1549"></a>
<span class="sourceLineNo">1550</span>    }<a name="line.1550"></a>
<span class="sourceLineNo">1551</span><a name="line.1551"></a>
<span class="sourceLineNo">1552</span>    /**<a name="line.1552"></a>
<span class="sourceLineNo">1553</span>     * Start the skin for this entity downloading, if necessary, and increment its reference counter<a name="line.1553"></a>
<span class="sourceLineNo">1554</span>     */<a name="line.1554"></a>
<span class="sourceLineNo">1555</span>    protected void obtainEntitySkin(Entity par1Entity)<a name="line.1555"></a>
<span class="sourceLineNo">1556</span>    {<a name="line.1556"></a>
<span class="sourceLineNo">1557</span>        for (int i = 0; i &lt; this.worldAccesses.size(); ++i)<a name="line.1557"></a>
<span class="sourceLineNo">1558</span>        {<a name="line.1558"></a>
<span class="sourceLineNo">1559</span>            ((IWorldAccess)this.worldAccesses.get(i)).onEntityCreate(par1Entity);<a name="line.1559"></a>
<span class="sourceLineNo">1560</span>        }<a name="line.1560"></a>
<span class="sourceLineNo">1561</span>    }<a name="line.1561"></a>
<span class="sourceLineNo">1562</span><a name="line.1562"></a>
<span class="sourceLineNo">1563</span>    /**<a name="line.1563"></a>
<span class="sourceLineNo">1564</span>     * Decrement the reference counter for this entity's skin image data<a name="line.1564"></a>
<span class="sourceLineNo">1565</span>     */<a name="line.1565"></a>
<span class="sourceLineNo">1566</span>    public void releaseEntitySkin(Entity par1Entity)<a name="line.1566"></a>
<span class="sourceLineNo">1567</span>    {<a name="line.1567"></a>
<span class="sourceLineNo">1568</span>        for (int i = 0; i &lt; this.worldAccesses.size(); ++i)<a name="line.1568"></a>
<span class="sourceLineNo">1569</span>        {<a name="line.1569"></a>
<span class="sourceLineNo">1570</span>            ((IWorldAccess)this.worldAccesses.get(i)).onEntityDestroy(par1Entity);<a name="line.1570"></a>
<span class="sourceLineNo">1571</span>        }<a name="line.1571"></a>
<span class="sourceLineNo">1572</span>    }<a name="line.1572"></a>
<span class="sourceLineNo">1573</span><a name="line.1573"></a>
<span class="sourceLineNo">1574</span>    /**<a name="line.1574"></a>
<span class="sourceLineNo">1575</span>     * Schedule the entity for removal during the next tick. Marks the entity dead in anticipation.<a name="line.1575"></a>
<span class="sourceLineNo">1576</span>     */<a name="line.1576"></a>
<span class="sourceLineNo">1577</span>    public void removeEntity(Entity par1Entity)<a name="line.1577"></a>
<span class="sourceLineNo">1578</span>    {<a name="line.1578"></a>
<span class="sourceLineNo">1579</span>        if (par1Entity.riddenByEntity != null)<a name="line.1579"></a>
<span class="sourceLineNo">1580</span>        {<a name="line.1580"></a>
<span class="sourceLineNo">1581</span>            par1Entity.riddenByEntity.mountEntity((Entity)null);<a name="line.1581"></a>
<span class="sourceLineNo">1582</span>        }<a name="line.1582"></a>
<span class="sourceLineNo">1583</span><a name="line.1583"></a>
<span class="sourceLineNo">1584</span>        if (par1Entity.ridingEntity != null)<a name="line.1584"></a>
<span class="sourceLineNo">1585</span>        {<a name="line.1585"></a>
<span class="sourceLineNo">1586</span>            par1Entity.mountEntity((Entity)null);<a name="line.1586"></a>
<span class="sourceLineNo">1587</span>        }<a name="line.1587"></a>
<span class="sourceLineNo">1588</span><a name="line.1588"></a>
<span class="sourceLineNo">1589</span>        par1Entity.setDead();<a name="line.1589"></a>
<span class="sourceLineNo">1590</span><a name="line.1590"></a>
<span class="sourceLineNo">1591</span>        if (par1Entity instanceof EntityPlayer)<a name="line.1591"></a>
<span class="sourceLineNo">1592</span>        {<a name="line.1592"></a>
<span class="sourceLineNo">1593</span>            this.playerEntities.remove(par1Entity);<a name="line.1593"></a>
<span class="sourceLineNo">1594</span>            this.updateAllPlayersSleepingFlag();<a name="line.1594"></a>
<span class="sourceLineNo">1595</span>        }<a name="line.1595"></a>
<span class="sourceLineNo">1596</span>    }<a name="line.1596"></a>
<span class="sourceLineNo">1597</span><a name="line.1597"></a>
<span class="sourceLineNo">1598</span>    /**<a name="line.1598"></a>
<span class="sourceLineNo">1599</span>     * Do NOT use this method to remove normal entities- use normal removeEntity<a name="line.1599"></a>
<span class="sourceLineNo">1600</span>     */<a name="line.1600"></a>
<span class="sourceLineNo">1601</span>    public void removePlayerEntityDangerously(Entity par1Entity)<a name="line.1601"></a>
<span class="sourceLineNo">1602</span>    {<a name="line.1602"></a>
<span class="sourceLineNo">1603</span>        par1Entity.setDead();<a name="line.1603"></a>
<span class="sourceLineNo">1604</span><a name="line.1604"></a>
<span class="sourceLineNo">1605</span>        if (par1Entity instanceof EntityPlayer)<a name="line.1605"></a>
<span class="sourceLineNo">1606</span>        {<a name="line.1606"></a>
<span class="sourceLineNo">1607</span>            this.playerEntities.remove(par1Entity);<a name="line.1607"></a>
<span class="sourceLineNo">1608</span>            this.updateAllPlayersSleepingFlag();<a name="line.1608"></a>
<span class="sourceLineNo">1609</span>        }<a name="line.1609"></a>
<span class="sourceLineNo">1610</span><a name="line.1610"></a>
<span class="sourceLineNo">1611</span>        int i = par1Entity.chunkCoordX;<a name="line.1611"></a>
<span class="sourceLineNo">1612</span>        int j = par1Entity.chunkCoordZ;<a name="line.1612"></a>
<span class="sourceLineNo">1613</span><a name="line.1613"></a>
<span class="sourceLineNo">1614</span>        if (par1Entity.addedToChunk &amp;&amp; this.chunkExists(i, j))<a name="line.1614"></a>
<span class="sourceLineNo">1615</span>        {<a name="line.1615"></a>
<span class="sourceLineNo">1616</span>            this.getChunkFromChunkCoords(i, j).removeEntity(par1Entity);<a name="line.1616"></a>
<span class="sourceLineNo">1617</span>        }<a name="line.1617"></a>
<span class="sourceLineNo">1618</span><a name="line.1618"></a>
<span class="sourceLineNo">1619</span>        this.loadedEntityList.remove(par1Entity);<a name="line.1619"></a>
<span class="sourceLineNo">1620</span>        this.releaseEntitySkin(par1Entity);<a name="line.1620"></a>
<span class="sourceLineNo">1621</span>    }<a name="line.1621"></a>
<span class="sourceLineNo">1622</span><a name="line.1622"></a>
<span class="sourceLineNo">1623</span>    /**<a name="line.1623"></a>
<span class="sourceLineNo">1624</span>     * Adds a IWorldAccess to the list of worldAccesses<a name="line.1624"></a>
<span class="sourceLineNo">1625</span>     */<a name="line.1625"></a>
<span class="sourceLineNo">1626</span>    public void addWorldAccess(IWorldAccess par1IWorldAccess)<a name="line.1626"></a>
<span class="sourceLineNo">1627</span>    {<a name="line.1627"></a>
<span class="sourceLineNo">1628</span>        this.worldAccesses.add(par1IWorldAccess);<a name="line.1628"></a>
<span class="sourceLineNo">1629</span>    }<a name="line.1629"></a>
<span class="sourceLineNo">1630</span><a name="line.1630"></a>
<span class="sourceLineNo">1631</span>    /**<a name="line.1631"></a>
<span class="sourceLineNo">1632</span>     * Returns a list of bounding boxes that collide with aabb excluding the passed in entity's collision. Args: entity,<a name="line.1632"></a>
<span class="sourceLineNo">1633</span>     * aabb<a name="line.1633"></a>
<span class="sourceLineNo">1634</span>     */<a name="line.1634"></a>
<span class="sourceLineNo">1635</span>    public List getCollidingBoundingBoxes(Entity par1Entity, AxisAlignedBB par2AxisAlignedBB)<a name="line.1635"></a>
<span class="sourceLineNo">1636</span>    {<a name="line.1636"></a>
<span class="sourceLineNo">1637</span>        this.collidingBoundingBoxes.clear();<a name="line.1637"></a>
<span class="sourceLineNo">1638</span>        int i = MathHelper.floor_double(par2AxisAlignedBB.minX);<a name="line.1638"></a>
<span class="sourceLineNo">1639</span>        int j = MathHelper.floor_double(par2AxisAlignedBB.maxX + 1.0D);<a name="line.1639"></a>
<span class="sourceLineNo">1640</span>        int k = MathHelper.floor_double(par2AxisAlignedBB.minY);<a name="line.1640"></a>
<span class="sourceLineNo">1641</span>        int l = MathHelper.floor_double(par2AxisAlignedBB.maxY + 1.0D);<a name="line.1641"></a>
<span class="sourceLineNo">1642</span>        int i1 = MathHelper.floor_double(par2AxisAlignedBB.minZ);<a name="line.1642"></a>
<span class="sourceLineNo">1643</span>        int j1 = MathHelper.floor_double(par2AxisAlignedBB.maxZ + 1.0D);<a name="line.1643"></a>
<span class="sourceLineNo">1644</span><a name="line.1644"></a>
<span class="sourceLineNo">1645</span>        for (int k1 = i; k1 &lt; j; ++k1)<a name="line.1645"></a>
<span class="sourceLineNo">1646</span>        {<a name="line.1646"></a>
<span class="sourceLineNo">1647</span>            for (int l1 = i1; l1 &lt; j1; ++l1)<a name="line.1647"></a>
<span class="sourceLineNo">1648</span>            {<a name="line.1648"></a>
<span class="sourceLineNo">1649</span>                if (this.blockExists(k1, 64, l1))<a name="line.1649"></a>
<span class="sourceLineNo">1650</span>                {<a name="line.1650"></a>
<span class="sourceLineNo">1651</span>                    for (int i2 = k - 1; i2 &lt; l; ++i2)<a name="line.1651"></a>
<span class="sourceLineNo">1652</span>                    {<a name="line.1652"></a>
<span class="sourceLineNo">1653</span>                        Block block = Block.blocksList[this.getBlockId(k1, i2, l1)];<a name="line.1653"></a>
<span class="sourceLineNo">1654</span><a name="line.1654"></a>
<span class="sourceLineNo">1655</span>                        if (block != null)<a name="line.1655"></a>
<span class="sourceLineNo">1656</span>                        {<a name="line.1656"></a>
<span class="sourceLineNo">1657</span>                            block.addCollisionBoxesToList(this, k1, i2, l1, par2AxisAlignedBB, this.collidingBoundingBoxes, par1Entity);<a name="line.1657"></a>
<span class="sourceLineNo">1658</span>                        }<a name="line.1658"></a>
<span class="sourceLineNo">1659</span>                    }<a name="line.1659"></a>
<span class="sourceLineNo">1660</span>                }<a name="line.1660"></a>
<span class="sourceLineNo">1661</span>            }<a name="line.1661"></a>
<span class="sourceLineNo">1662</span>        }<a name="line.1662"></a>
<span class="sourceLineNo">1663</span><a name="line.1663"></a>
<span class="sourceLineNo">1664</span>        double d0 = 0.25D;<a name="line.1664"></a>
<span class="sourceLineNo">1665</span>        List list = this.getEntitiesWithinAABBExcludingEntity(par1Entity, par2AxisAlignedBB.expand(d0, d0, d0));<a name="line.1665"></a>
<span class="sourceLineNo">1666</span><a name="line.1666"></a>
<span class="sourceLineNo">1667</span>        for (int j2 = 0; j2 &lt; list.size(); ++j2)<a name="line.1667"></a>
<span class="sourceLineNo">1668</span>        {<a name="line.1668"></a>
<span class="sourceLineNo">1669</span>            AxisAlignedBB axisalignedbb1 = ((Entity)list.get(j2)).getBoundingBox();<a name="line.1669"></a>
<span class="sourceLineNo">1670</span><a name="line.1670"></a>
<span class="sourceLineNo">1671</span>            if (axisalignedbb1 != null &amp;&amp; axisalignedbb1.intersectsWith(par2AxisAlignedBB))<a name="line.1671"></a>
<span class="sourceLineNo">1672</span>            {<a name="line.1672"></a>
<span class="sourceLineNo">1673</span>                this.collidingBoundingBoxes.add(axisalignedbb1);<a name="line.1673"></a>
<span class="sourceLineNo">1674</span>            }<a name="line.1674"></a>
<span class="sourceLineNo">1675</span><a name="line.1675"></a>
<span class="sourceLineNo">1676</span>            axisalignedbb1 = par1Entity.getCollisionBox((Entity)list.get(j2));<a name="line.1676"></a>
<span class="sourceLineNo">1677</span><a name="line.1677"></a>
<span class="sourceLineNo">1678</span>            if (axisalignedbb1 != null &amp;&amp; axisalignedbb1.intersectsWith(par2AxisAlignedBB))<a name="line.1678"></a>
<span class="sourceLineNo">1679</span>            {<a name="line.1679"></a>
<span class="sourceLineNo">1680</span>                this.collidingBoundingBoxes.add(axisalignedbb1);<a name="line.1680"></a>
<span class="sourceLineNo">1681</span>            }<a name="line.1681"></a>
<span class="sourceLineNo">1682</span>        }<a name="line.1682"></a>
<span class="sourceLineNo">1683</span><a name="line.1683"></a>
<span class="sourceLineNo">1684</span>        return this.collidingBoundingBoxes;<a name="line.1684"></a>
<span class="sourceLineNo">1685</span>    }<a name="line.1685"></a>
<span class="sourceLineNo">1686</span><a name="line.1686"></a>
<span class="sourceLineNo">1687</span>    /**<a name="line.1687"></a>
<span class="sourceLineNo">1688</span>     * calculates and returns a list of colliding bounding boxes within a given AABB<a name="line.1688"></a>
<span class="sourceLineNo">1689</span>     */<a name="line.1689"></a>
<span class="sourceLineNo">1690</span>    public List getAllCollidingBoundingBoxes(AxisAlignedBB par1AxisAlignedBB)<a name="line.1690"></a>
<span class="sourceLineNo">1691</span>    {<a name="line.1691"></a>
<span class="sourceLineNo">1692</span>        this.collidingBoundingBoxes.clear();<a name="line.1692"></a>
<span class="sourceLineNo">1693</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.1693"></a>
<span class="sourceLineNo">1694</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.1694"></a>
<span class="sourceLineNo">1695</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.1695"></a>
<span class="sourceLineNo">1696</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.1696"></a>
<span class="sourceLineNo">1697</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.1697"></a>
<span class="sourceLineNo">1698</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.1698"></a>
<span class="sourceLineNo">1699</span><a name="line.1699"></a>
<span class="sourceLineNo">1700</span>        for (int k1 = i; k1 &lt; j; ++k1)<a name="line.1700"></a>
<span class="sourceLineNo">1701</span>        {<a name="line.1701"></a>
<span class="sourceLineNo">1702</span>            for (int l1 = i1; l1 &lt; j1; ++l1)<a name="line.1702"></a>
<span class="sourceLineNo">1703</span>            {<a name="line.1703"></a>
<span class="sourceLineNo">1704</span>                if (this.blockExists(k1, 64, l1))<a name="line.1704"></a>
<span class="sourceLineNo">1705</span>                {<a name="line.1705"></a>
<span class="sourceLineNo">1706</span>                    for (int i2 = k - 1; i2 &lt; l; ++i2)<a name="line.1706"></a>
<span class="sourceLineNo">1707</span>                    {<a name="line.1707"></a>
<span class="sourceLineNo">1708</span>                        Block block = Block.blocksList[this.getBlockId(k1, i2, l1)];<a name="line.1708"></a>
<span class="sourceLineNo">1709</span><a name="line.1709"></a>
<span class="sourceLineNo">1710</span>                        if (block != null)<a name="line.1710"></a>
<span class="sourceLineNo">1711</span>                        {<a name="line.1711"></a>
<span class="sourceLineNo">1712</span>                            block.addCollisionBoxesToList(this, k1, i2, l1, par1AxisAlignedBB, this.collidingBoundingBoxes, (Entity)null);<a name="line.1712"></a>
<span class="sourceLineNo">1713</span>                        }<a name="line.1713"></a>
<span class="sourceLineNo">1714</span>                    }<a name="line.1714"></a>
<span class="sourceLineNo">1715</span>                }<a name="line.1715"></a>
<span class="sourceLineNo">1716</span>            }<a name="line.1716"></a>
<span class="sourceLineNo">1717</span>        }<a name="line.1717"></a>
<span class="sourceLineNo">1718</span><a name="line.1718"></a>
<span class="sourceLineNo">1719</span>        return this.collidingBoundingBoxes;<a name="line.1719"></a>
<span class="sourceLineNo">1720</span>    }<a name="line.1720"></a>
<span class="sourceLineNo">1721</span><a name="line.1721"></a>
<span class="sourceLineNo">1722</span>    /**<a name="line.1722"></a>
<span class="sourceLineNo">1723</span>     * Returns the amount of skylight subtracted for the current time<a name="line.1723"></a>
<span class="sourceLineNo">1724</span>     */<a name="line.1724"></a>
<span class="sourceLineNo">1725</span>    public int calculateSkylightSubtracted(float par1)<a name="line.1725"></a>
<span class="sourceLineNo">1726</span>    {<a name="line.1726"></a>
<span class="sourceLineNo">1727</span>        float f1 = this.getCelestialAngle(par1);<a name="line.1727"></a>
<span class="sourceLineNo">1728</span>        float f2 = 1.0F - (MathHelper.cos(f1 * (float)Math.PI * 2.0F) * 2.0F + 0.5F);<a name="line.1728"></a>
<span class="sourceLineNo">1729</span><a name="line.1729"></a>
<span class="sourceLineNo">1730</span>        if (f2 &lt; 0.0F)<a name="line.1730"></a>
<span class="sourceLineNo">1731</span>        {<a name="line.1731"></a>
<span class="sourceLineNo">1732</span>            f2 = 0.0F;<a name="line.1732"></a>
<span class="sourceLineNo">1733</span>        }<a name="line.1733"></a>
<span class="sourceLineNo">1734</span><a name="line.1734"></a>
<span class="sourceLineNo">1735</span>        if (f2 &gt; 1.0F)<a name="line.1735"></a>
<span class="sourceLineNo">1736</span>        {<a name="line.1736"></a>
<span class="sourceLineNo">1737</span>            f2 = 1.0F;<a name="line.1737"></a>
<span class="sourceLineNo">1738</span>        }<a name="line.1738"></a>
<span class="sourceLineNo">1739</span><a name="line.1739"></a>
<span class="sourceLineNo">1740</span>        f2 = 1.0F - f2;<a name="line.1740"></a>
<span class="sourceLineNo">1741</span>        f2 = (float)((double)f2 * (1.0D - (double)(this.getRainStrength(par1) * 5.0F) / 16.0D));<a name="line.1741"></a>
<span class="sourceLineNo">1742</span>        f2 = (float)((double)f2 * (1.0D - (double)(this.getWeightedThunderStrength(par1) * 5.0F) / 16.0D));<a name="line.1742"></a>
<span class="sourceLineNo">1743</span>        f2 = 1.0F - f2;<a name="line.1743"></a>
<span class="sourceLineNo">1744</span>        return (int)(f2 * 11.0F);<a name="line.1744"></a>
<span class="sourceLineNo">1745</span>    }<a name="line.1745"></a>
<span class="sourceLineNo">1746</span><a name="line.1746"></a>
<span class="sourceLineNo">1747</span>    @SideOnly(Side.CLIENT)<a name="line.1747"></a>
<span class="sourceLineNo">1748</span><a name="line.1748"></a>
<span class="sourceLineNo">1749</span>    /**<a name="line.1749"></a>
<span class="sourceLineNo">1750</span>     * Removes a worldAccess from the worldAccesses object<a name="line.1750"></a>
<span class="sourceLineNo">1751</span>     */<a name="line.1751"></a>
<span class="sourceLineNo">1752</span>    public void removeWorldAccess(IWorldAccess par1IWorldAccess)<a name="line.1752"></a>
<span class="sourceLineNo">1753</span>    {<a name="line.1753"></a>
<span class="sourceLineNo">1754</span>        this.worldAccesses.remove(par1IWorldAccess);<a name="line.1754"></a>
<span class="sourceLineNo">1755</span>    }<a name="line.1755"></a>
<span class="sourceLineNo">1756</span><a name="line.1756"></a>
<span class="sourceLineNo">1757</span>    @SideOnly(Side.CLIENT)<a name="line.1757"></a>
<span class="sourceLineNo">1758</span><a name="line.1758"></a>
<span class="sourceLineNo">1759</span>    /**<a name="line.1759"></a>
<span class="sourceLineNo">1760</span>     * Returns the sun brightness - checks time of day, rain and thunder<a name="line.1760"></a>
<span class="sourceLineNo">1761</span>     */<a name="line.1761"></a>
<span class="sourceLineNo">1762</span>    public float getSunBrightness(float par1)<a name="line.1762"></a>
<span class="sourceLineNo">1763</span>    {<a name="line.1763"></a>
<span class="sourceLineNo">1764</span>        float f1 = this.getCelestialAngle(par1);<a name="line.1764"></a>
<span class="sourceLineNo">1765</span>        float f2 = 1.0F - (MathHelper.cos(f1 * (float)Math.PI * 2.0F) * 2.0F + 0.2F);<a name="line.1765"></a>
<span class="sourceLineNo">1766</span><a name="line.1766"></a>
<span class="sourceLineNo">1767</span>        if (f2 &lt; 0.0F)<a name="line.1767"></a>
<span class="sourceLineNo">1768</span>        {<a name="line.1768"></a>
<span class="sourceLineNo">1769</span>            f2 = 0.0F;<a name="line.1769"></a>
<span class="sourceLineNo">1770</span>        }<a name="line.1770"></a>
<span class="sourceLineNo">1771</span><a name="line.1771"></a>
<span class="sourceLineNo">1772</span>        if (f2 &gt; 1.0F)<a name="line.1772"></a>
<span class="sourceLineNo">1773</span>        {<a name="line.1773"></a>
<span class="sourceLineNo">1774</span>            f2 = 1.0F;<a name="line.1774"></a>
<span class="sourceLineNo">1775</span>        }<a name="line.1775"></a>
<span class="sourceLineNo">1776</span><a name="line.1776"></a>
<span class="sourceLineNo">1777</span>        f2 = 1.0F - f2;<a name="line.1777"></a>
<span class="sourceLineNo">1778</span>        f2 = (float)((double)f2 * (1.0D - (double)(this.getRainStrength(par1) * 5.0F) / 16.0D));<a name="line.1778"></a>
<span class="sourceLineNo">1779</span>        f2 = (float)((double)f2 * (1.0D - (double)(this.getWeightedThunderStrength(par1) * 5.0F) / 16.0D));<a name="line.1779"></a>
<span class="sourceLineNo">1780</span>        return f2 * 0.8F + 0.2F;<a name="line.1780"></a>
<span class="sourceLineNo">1781</span>    }<a name="line.1781"></a>
<span class="sourceLineNo">1782</span><a name="line.1782"></a>
<span class="sourceLineNo">1783</span>    @SideOnly(Side.CLIENT)<a name="line.1783"></a>
<span class="sourceLineNo">1784</span><a name="line.1784"></a>
<span class="sourceLineNo">1785</span>    /**<a name="line.1785"></a>
<span class="sourceLineNo">1786</span>     * Calculates the color for the skybox<a name="line.1786"></a>
<span class="sourceLineNo">1787</span>     */<a name="line.1787"></a>
<span class="sourceLineNo">1788</span>    public Vec3 getSkyColor(Entity par1Entity, float par2)<a name="line.1788"></a>
<span class="sourceLineNo">1789</span>    {<a name="line.1789"></a>
<span class="sourceLineNo">1790</span>        return provider.getSkyColor(par1Entity, par2);<a name="line.1790"></a>
<span class="sourceLineNo">1791</span>    }<a name="line.1791"></a>
<span class="sourceLineNo">1792</span><a name="line.1792"></a>
<span class="sourceLineNo">1793</span>    @SideOnly(Side.CLIENT)<a name="line.1793"></a>
<span class="sourceLineNo">1794</span>    public Vec3 getSkyColorBody(Entity par1Entity, float par2)<a name="line.1794"></a>
<span class="sourceLineNo">1795</span>    {<a name="line.1795"></a>
<span class="sourceLineNo">1796</span>        float f1 = this.getCelestialAngle(par2);<a name="line.1796"></a>
<span class="sourceLineNo">1797</span>        float f2 = MathHelper.cos(f1 * (float)Math.PI * 2.0F) * 2.0F + 0.5F;<a name="line.1797"></a>
<span class="sourceLineNo">1798</span><a name="line.1798"></a>
<span class="sourceLineNo">1799</span>        if (f2 &lt; 0.0F)<a name="line.1799"></a>
<span class="sourceLineNo">1800</span>        {<a name="line.1800"></a>
<span class="sourceLineNo">1801</span>            f2 = 0.0F;<a name="line.1801"></a>
<span class="sourceLineNo">1802</span>        }<a name="line.1802"></a>
<span class="sourceLineNo">1803</span><a name="line.1803"></a>
<span class="sourceLineNo">1804</span>        if (f2 &gt; 1.0F)<a name="line.1804"></a>
<span class="sourceLineNo">1805</span>        {<a name="line.1805"></a>
<span class="sourceLineNo">1806</span>            f2 = 1.0F;<a name="line.1806"></a>
<span class="sourceLineNo">1807</span>        }<a name="line.1807"></a>
<span class="sourceLineNo">1808</span><a name="line.1808"></a>
<span class="sourceLineNo">1809</span>        int i = MathHelper.floor_double(par1Entity.posX);<a name="line.1809"></a>
<span class="sourceLineNo">1810</span>        int j = MathHelper.floor_double(par1Entity.posZ);<a name="line.1810"></a>
<span class="sourceLineNo">1811</span>        BiomeGenBase biomegenbase = this.getBiomeGenForCoords(i, j);<a name="line.1811"></a>
<span class="sourceLineNo">1812</span>        float f3 = biomegenbase.getFloatTemperature();<a name="line.1812"></a>
<span class="sourceLineNo">1813</span>        int k = biomegenbase.getSkyColorByTemp(f3);<a name="line.1813"></a>
<span class="sourceLineNo">1814</span>        float f4 = (float)(k &gt;&gt; 16 &amp; 255) / 255.0F;<a name="line.1814"></a>
<span class="sourceLineNo">1815</span>        float f5 = (float)(k &gt;&gt; 8 &amp; 255) / 255.0F;<a name="line.1815"></a>
<span class="sourceLineNo">1816</span>        float f6 = (float)(k &amp; 255) / 255.0F;<a name="line.1816"></a>
<span class="sourceLineNo">1817</span>        f4 *= f2;<a name="line.1817"></a>
<span class="sourceLineNo">1818</span>        f5 *= f2;<a name="line.1818"></a>
<span class="sourceLineNo">1819</span>        f6 *= f2;<a name="line.1819"></a>
<span class="sourceLineNo">1820</span>        float f7 = this.getRainStrength(par2);<a name="line.1820"></a>
<span class="sourceLineNo">1821</span>        float f8;<a name="line.1821"></a>
<span class="sourceLineNo">1822</span>        float f9;<a name="line.1822"></a>
<span class="sourceLineNo">1823</span><a name="line.1823"></a>
<span class="sourceLineNo">1824</span>        if (f7 &gt; 0.0F)<a name="line.1824"></a>
<span class="sourceLineNo">1825</span>        {<a name="line.1825"></a>
<span class="sourceLineNo">1826</span>            f8 = (f4 * 0.3F + f5 * 0.59F + f6 * 0.11F) * 0.6F;<a name="line.1826"></a>
<span class="sourceLineNo">1827</span>            f9 = 1.0F - f7 * 0.75F;<a name="line.1827"></a>
<span class="sourceLineNo">1828</span>            f4 = f4 * f9 + f8 * (1.0F - f9);<a name="line.1828"></a>
<span class="sourceLineNo">1829</span>            f5 = f5 * f9 + f8 * (1.0F - f9);<a name="line.1829"></a>
<span class="sourceLineNo">1830</span>            f6 = f6 * f9 + f8 * (1.0F - f9);<a name="line.1830"></a>
<span class="sourceLineNo">1831</span>        }<a name="line.1831"></a>
<span class="sourceLineNo">1832</span><a name="line.1832"></a>
<span class="sourceLineNo">1833</span>        f8 = this.getWeightedThunderStrength(par2);<a name="line.1833"></a>
<span class="sourceLineNo">1834</span><a name="line.1834"></a>
<span class="sourceLineNo">1835</span>        if (f8 &gt; 0.0F)<a name="line.1835"></a>
<span class="sourceLineNo">1836</span>        {<a name="line.1836"></a>
<span class="sourceLineNo">1837</span>            f9 = (f4 * 0.3F + f5 * 0.59F + f6 * 0.11F) * 0.2F;<a name="line.1837"></a>
<span class="sourceLineNo">1838</span>            float f10 = 1.0F - f8 * 0.75F;<a name="line.1838"></a>
<span class="sourceLineNo">1839</span>            f4 = f4 * f10 + f9 * (1.0F - f10);<a name="line.1839"></a>
<span class="sourceLineNo">1840</span>            f5 = f5 * f10 + f9 * (1.0F - f10);<a name="line.1840"></a>
<span class="sourceLineNo">1841</span>            f6 = f6 * f10 + f9 * (1.0F - f10);<a name="line.1841"></a>
<span class="sourceLineNo">1842</span>        }<a name="line.1842"></a>
<span class="sourceLineNo">1843</span><a name="line.1843"></a>
<span class="sourceLineNo">1844</span>        if (this.lastLightningBolt &gt; 0)<a name="line.1844"></a>
<span class="sourceLineNo">1845</span>        {<a name="line.1845"></a>
<span class="sourceLineNo">1846</span>            f9 = (float)this.lastLightningBolt - par2;<a name="line.1846"></a>
<span class="sourceLineNo">1847</span><a name="line.1847"></a>
<span class="sourceLineNo">1848</span>            if (f9 &gt; 1.0F)<a name="line.1848"></a>
<span class="sourceLineNo">1849</span>            {<a name="line.1849"></a>
<span class="sourceLineNo">1850</span>                f9 = 1.0F;<a name="line.1850"></a>
<span class="sourceLineNo">1851</span>            }<a name="line.1851"></a>
<span class="sourceLineNo">1852</span><a name="line.1852"></a>
<span class="sourceLineNo">1853</span>            f9 *= 0.45F;<a name="line.1853"></a>
<span class="sourceLineNo">1854</span>            f4 = f4 * (1.0F - f9) + 0.8F * f9;<a name="line.1854"></a>
<span class="sourceLineNo">1855</span>            f5 = f5 * (1.0F - f9) + 0.8F * f9;<a name="line.1855"></a>
<span class="sourceLineNo">1856</span>            f6 = f6 * (1.0F - f9) + 1.0F * f9;<a name="line.1856"></a>
<span class="sourceLineNo">1857</span>        }<a name="line.1857"></a>
<span class="sourceLineNo">1858</span><a name="line.1858"></a>
<span class="sourceLineNo">1859</span>        return this.getWorldVec3Pool().getVecFromPool((double)f4, (double)f5, (double)f6);<a name="line.1859"></a>
<span class="sourceLineNo">1860</span>    }<a name="line.1860"></a>
<span class="sourceLineNo">1861</span><a name="line.1861"></a>
<span class="sourceLineNo">1862</span>    /**<a name="line.1862"></a>
<span class="sourceLineNo">1863</span>     * calls calculateCelestialAngle<a name="line.1863"></a>
<span class="sourceLineNo">1864</span>     */<a name="line.1864"></a>
<span class="sourceLineNo">1865</span>    public float getCelestialAngle(float par1)<a name="line.1865"></a>
<span class="sourceLineNo">1866</span>    {<a name="line.1866"></a>
<span class="sourceLineNo">1867</span>        return this.provider.calculateCelestialAngle(this.worldInfo.getWorldTime(), par1);<a name="line.1867"></a>
<span class="sourceLineNo">1868</span>    }<a name="line.1868"></a>
<span class="sourceLineNo">1869</span><a name="line.1869"></a>
<span class="sourceLineNo">1870</span>    public int getMoonPhase()<a name="line.1870"></a>
<span class="sourceLineNo">1871</span>    {<a name="line.1871"></a>
<span class="sourceLineNo">1872</span>        return this.provider.getMoonPhase(this.worldInfo.getWorldTime());<a name="line.1872"></a>
<span class="sourceLineNo">1873</span>    }<a name="line.1873"></a>
<span class="sourceLineNo">1874</span><a name="line.1874"></a>
<span class="sourceLineNo">1875</span>    /**<a name="line.1875"></a>
<span class="sourceLineNo">1876</span>     * Return getCelestialAngle()*2*PI<a name="line.1876"></a>
<span class="sourceLineNo">1877</span>     */<a name="line.1877"></a>
<span class="sourceLineNo">1878</span>    public float getCelestialAngleRadians(float par1)<a name="line.1878"></a>
<span class="sourceLineNo">1879</span>    {<a name="line.1879"></a>
<span class="sourceLineNo">1880</span>        float f1 = this.getCelestialAngle(par1);<a name="line.1880"></a>
<span class="sourceLineNo">1881</span>        return f1 * (float)Math.PI * 2.0F;<a name="line.1881"></a>
<span class="sourceLineNo">1882</span>    }<a name="line.1882"></a>
<span class="sourceLineNo">1883</span><a name="line.1883"></a>
<span class="sourceLineNo">1884</span>    @SideOnly(Side.CLIENT)<a name="line.1884"></a>
<span class="sourceLineNo">1885</span>    public Vec3 getCloudColour(float par1)<a name="line.1885"></a>
<span class="sourceLineNo">1886</span>    {<a name="line.1886"></a>
<span class="sourceLineNo">1887</span>        return provider.drawClouds(par1);<a name="line.1887"></a>
<span class="sourceLineNo">1888</span>    }<a name="line.1888"></a>
<span class="sourceLineNo">1889</span><a name="line.1889"></a>
<span class="sourceLineNo">1890</span>    @SideOnly(Side.CLIENT)<a name="line.1890"></a>
<span class="sourceLineNo">1891</span>    public Vec3 drawCloudsBody(float par1)<a name="line.1891"></a>
<span class="sourceLineNo">1892</span>    {<a name="line.1892"></a>
<span class="sourceLineNo">1893</span>        float f1 = this.getCelestialAngle(par1);<a name="line.1893"></a>
<span class="sourceLineNo">1894</span>        float f2 = MathHelper.cos(f1 * (float)Math.PI * 2.0F) * 2.0F + 0.5F;<a name="line.1894"></a>
<span class="sourceLineNo">1895</span><a name="line.1895"></a>
<span class="sourceLineNo">1896</span>        if (f2 &lt; 0.0F)<a name="line.1896"></a>
<span class="sourceLineNo">1897</span>        {<a name="line.1897"></a>
<span class="sourceLineNo">1898</span>            f2 = 0.0F;<a name="line.1898"></a>
<span class="sourceLineNo">1899</span>        }<a name="line.1899"></a>
<span class="sourceLineNo">1900</span><a name="line.1900"></a>
<span class="sourceLineNo">1901</span>        if (f2 &gt; 1.0F)<a name="line.1901"></a>
<span class="sourceLineNo">1902</span>        {<a name="line.1902"></a>
<span class="sourceLineNo">1903</span>            f2 = 1.0F;<a name="line.1903"></a>
<span class="sourceLineNo">1904</span>        }<a name="line.1904"></a>
<span class="sourceLineNo">1905</span><a name="line.1905"></a>
<span class="sourceLineNo">1906</span>        float f3 = (float)(this.cloudColour &gt;&gt; 16 &amp; 255L) / 255.0F;<a name="line.1906"></a>
<span class="sourceLineNo">1907</span>        float f4 = (float)(this.cloudColour &gt;&gt; 8 &amp; 255L) / 255.0F;<a name="line.1907"></a>
<span class="sourceLineNo">1908</span>        float f5 = (float)(this.cloudColour &amp; 255L) / 255.0F;<a name="line.1908"></a>
<span class="sourceLineNo">1909</span>        float f6 = this.getRainStrength(par1);<a name="line.1909"></a>
<span class="sourceLineNo">1910</span>        float f7;<a name="line.1910"></a>
<span class="sourceLineNo">1911</span>        float f8;<a name="line.1911"></a>
<span class="sourceLineNo">1912</span><a name="line.1912"></a>
<span class="sourceLineNo">1913</span>        if (f6 &gt; 0.0F)<a name="line.1913"></a>
<span class="sourceLineNo">1914</span>        {<a name="line.1914"></a>
<span class="sourceLineNo">1915</span>            f7 = (f3 * 0.3F + f4 * 0.59F + f5 * 0.11F) * 0.6F;<a name="line.1915"></a>
<span class="sourceLineNo">1916</span>            f8 = 1.0F - f6 * 0.95F;<a name="line.1916"></a>
<span class="sourceLineNo">1917</span>            f3 = f3 * f8 + f7 * (1.0F - f8);<a name="line.1917"></a>
<span class="sourceLineNo">1918</span>            f4 = f4 * f8 + f7 * (1.0F - f8);<a name="line.1918"></a>
<span class="sourceLineNo">1919</span>            f5 = f5 * f8 + f7 * (1.0F - f8);<a name="line.1919"></a>
<span class="sourceLineNo">1920</span>        }<a name="line.1920"></a>
<span class="sourceLineNo">1921</span><a name="line.1921"></a>
<span class="sourceLineNo">1922</span>        f3 *= f2 * 0.9F + 0.1F;<a name="line.1922"></a>
<span class="sourceLineNo">1923</span>        f4 *= f2 * 0.9F + 0.1F;<a name="line.1923"></a>
<span class="sourceLineNo">1924</span>        f5 *= f2 * 0.85F + 0.15F;<a name="line.1924"></a>
<span class="sourceLineNo">1925</span>        f7 = this.getWeightedThunderStrength(par1);<a name="line.1925"></a>
<span class="sourceLineNo">1926</span><a name="line.1926"></a>
<span class="sourceLineNo">1927</span>        if (f7 &gt; 0.0F)<a name="line.1927"></a>
<span class="sourceLineNo">1928</span>        {<a name="line.1928"></a>
<span class="sourceLineNo">1929</span>            f8 = (f3 * 0.3F + f4 * 0.59F + f5 * 0.11F) * 0.2F;<a name="line.1929"></a>
<span class="sourceLineNo">1930</span>            float f9 = 1.0F - f7 * 0.95F;<a name="line.1930"></a>
<span class="sourceLineNo">1931</span>            f3 = f3 * f9 + f8 * (1.0F - f9);<a name="line.1931"></a>
<span class="sourceLineNo">1932</span>            f4 = f4 * f9 + f8 * (1.0F - f9);<a name="line.1932"></a>
<span class="sourceLineNo">1933</span>            f5 = f5 * f9 + f8 * (1.0F - f9);<a name="line.1933"></a>
<span class="sourceLineNo">1934</span>        }<a name="line.1934"></a>
<span class="sourceLineNo">1935</span><a name="line.1935"></a>
<span class="sourceLineNo">1936</span>        return this.getWorldVec3Pool().getVecFromPool((double)f3, (double)f4, (double)f5);<a name="line.1936"></a>
<span class="sourceLineNo">1937</span>    }<a name="line.1937"></a>
<span class="sourceLineNo">1938</span><a name="line.1938"></a>
<span class="sourceLineNo">1939</span>    @SideOnly(Side.CLIENT)<a name="line.1939"></a>
<span class="sourceLineNo">1940</span><a name="line.1940"></a>
<span class="sourceLineNo">1941</span>    /**<a name="line.1941"></a>
<span class="sourceLineNo">1942</span>     * Returns vector(ish) with R/G/B for fog<a name="line.1942"></a>
<span class="sourceLineNo">1943</span>     */<a name="line.1943"></a>
<span class="sourceLineNo">1944</span>    public Vec3 getFogColor(float par1)<a name="line.1944"></a>
<span class="sourceLineNo">1945</span>    {<a name="line.1945"></a>
<span class="sourceLineNo">1946</span>        float f1 = this.getCelestialAngle(par1);<a name="line.1946"></a>
<span class="sourceLineNo">1947</span>        return this.provider.getFogColor(f1, par1);<a name="line.1947"></a>
<span class="sourceLineNo">1948</span>    }<a name="line.1948"></a>
<span class="sourceLineNo">1949</span><a name="line.1949"></a>
<span class="sourceLineNo">1950</span>    /**<a name="line.1950"></a>
<span class="sourceLineNo">1951</span>     * Gets the height to which rain/snow will fall. Calculates it if not already stored.<a name="line.1951"></a>
<span class="sourceLineNo">1952</span>     */<a name="line.1952"></a>
<span class="sourceLineNo">1953</span>    public int getPrecipitationHeight(int par1, int par2)<a name="line.1953"></a>
<span class="sourceLineNo">1954</span>    {<a name="line.1954"></a>
<span class="sourceLineNo">1955</span>        return this.getChunkFromBlockCoords(par1, par2).getPrecipitationHeight(par1 &amp; 15, par2 &amp; 15);<a name="line.1955"></a>
<span class="sourceLineNo">1956</span>    }<a name="line.1956"></a>
<span class="sourceLineNo">1957</span><a name="line.1957"></a>
<span class="sourceLineNo">1958</span>    /**<a name="line.1958"></a>
<span class="sourceLineNo">1959</span>     * Finds the highest block on the x, z coordinate that is solid and returns its y coord. Args x, z<a name="line.1959"></a>
<span class="sourceLineNo">1960</span>     */<a name="line.1960"></a>
<span class="sourceLineNo">1961</span>    public int getTopSolidOrLiquidBlock(int par1, int par2)<a name="line.1961"></a>
<span class="sourceLineNo">1962</span>    {<a name="line.1962"></a>
<span class="sourceLineNo">1963</span>        Chunk chunk = this.getChunkFromBlockCoords(par1, par2);<a name="line.1963"></a>
<span class="sourceLineNo">1964</span>        int k = chunk.getTopFilledSegment() + 15;<a name="line.1964"></a>
<span class="sourceLineNo">1965</span>        par1 &amp;= 15;<a name="line.1965"></a>
<span class="sourceLineNo">1966</span><a name="line.1966"></a>
<span class="sourceLineNo">1967</span>        for (par2 &amp;= 15; k &gt; 0; --k)<a name="line.1967"></a>
<span class="sourceLineNo">1968</span>        {<a name="line.1968"></a>
<span class="sourceLineNo">1969</span>            int l = chunk.getBlockID(par1, k, par2);<a name="line.1969"></a>
<span class="sourceLineNo">1970</span><a name="line.1970"></a>
<span class="sourceLineNo">1971</span>            if (l != 0 &amp;&amp; Block.blocksList[l].blockMaterial.blocksMovement() &amp;&amp; Block.blocksList[l].blockMaterial != Material.leaves &amp;&amp; !Block.blocksList[l].isBlockFoliage(this, par1, k, par2))<a name="line.1971"></a>
<span class="sourceLineNo">1972</span>            {<a name="line.1972"></a>
<span class="sourceLineNo">1973</span>                return k + 1;<a name="line.1973"></a>
<span class="sourceLineNo">1974</span>            }<a name="line.1974"></a>
<span class="sourceLineNo">1975</span>        }<a name="line.1975"></a>
<span class="sourceLineNo">1976</span><a name="line.1976"></a>
<span class="sourceLineNo">1977</span>        return -1;<a name="line.1977"></a>
<span class="sourceLineNo">1978</span>    }<a name="line.1978"></a>
<span class="sourceLineNo">1979</span><a name="line.1979"></a>
<span class="sourceLineNo">1980</span>    @SideOnly(Side.CLIENT)<a name="line.1980"></a>
<span class="sourceLineNo">1981</span><a name="line.1981"></a>
<span class="sourceLineNo">1982</span>    /**<a name="line.1982"></a>
<span class="sourceLineNo">1983</span>     * How bright are stars in the sky<a name="line.1983"></a>
<span class="sourceLineNo">1984</span>     */<a name="line.1984"></a>
<span class="sourceLineNo">1985</span>    public float getStarBrightness(float par1)<a name="line.1985"></a>
<span class="sourceLineNo">1986</span>    {<a name="line.1986"></a>
<span class="sourceLineNo">1987</span>        return provider.getStarBrightness(par1);<a name="line.1987"></a>
<span class="sourceLineNo">1988</span>    }<a name="line.1988"></a>
<span class="sourceLineNo">1989</span><a name="line.1989"></a>
<span class="sourceLineNo">1990</span>    @SideOnly(Side.CLIENT)<a name="line.1990"></a>
<span class="sourceLineNo">1991</span>    public float getStarBrightnessBody(float par1)<a name="line.1991"></a>
<span class="sourceLineNo">1992</span>    {<a name="line.1992"></a>
<span class="sourceLineNo">1993</span>        float f1 = this.getCelestialAngle(par1);<a name="line.1993"></a>
<span class="sourceLineNo">1994</span>        float f2 = 1.0F - (MathHelper.cos(f1 * (float)Math.PI * 2.0F) * 2.0F + 0.25F);<a name="line.1994"></a>
<span class="sourceLineNo">1995</span><a name="line.1995"></a>
<span class="sourceLineNo">1996</span>        if (f2 &lt; 0.0F)<a name="line.1996"></a>
<span class="sourceLineNo">1997</span>        {<a name="line.1997"></a>
<span class="sourceLineNo">1998</span>            f2 = 0.0F;<a name="line.1998"></a>
<span class="sourceLineNo">1999</span>        }<a name="line.1999"></a>
<span class="sourceLineNo">2000</span><a name="line.2000"></a>
<span class="sourceLineNo">2001</span>        if (f2 &gt; 1.0F)<a name="line.2001"></a>
<span class="sourceLineNo">2002</span>        {<a name="line.2002"></a>
<span class="sourceLineNo">2003</span>            f2 = 1.0F;<a name="line.2003"></a>
<span class="sourceLineNo">2004</span>        }<a name="line.2004"></a>
<span class="sourceLineNo">2005</span><a name="line.2005"></a>
<span class="sourceLineNo">2006</span>        return f2 * f2 * 0.5F;<a name="line.2006"></a>
<span class="sourceLineNo">2007</span>    }<a name="line.2007"></a>
<span class="sourceLineNo">2008</span><a name="line.2008"></a>
<span class="sourceLineNo">2009</span>    /**<a name="line.2009"></a>
<span class="sourceLineNo">2010</span>     * Schedules a tick to a block with a delay (Most commonly the tick rate)<a name="line.2010"></a>
<span class="sourceLineNo">2011</span>     */<a name="line.2011"></a>
<span class="sourceLineNo">2012</span>    public void scheduleBlockUpdate(int par1, int par2, int par3, int par4, int par5) {}<a name="line.2012"></a>
<span class="sourceLineNo">2013</span><a name="line.2013"></a>
<span class="sourceLineNo">2014</span>    public void func_82740_a(int par1, int par2, int par3, int par4, int par5, int par6) {}<a name="line.2014"></a>
<span class="sourceLineNo">2015</span><a name="line.2015"></a>
<span class="sourceLineNo">2016</span>    /**<a name="line.2016"></a>
<span class="sourceLineNo">2017</span>     * Schedules a block update from the saved information in a chunk. Called when the chunk is loaded.<a name="line.2017"></a>
<span class="sourceLineNo">2018</span>     */<a name="line.2018"></a>
<span class="sourceLineNo">2019</span>    public void scheduleBlockUpdateFromLoad(int par1, int par2, int par3, int par4, int par5, int par6) {}<a name="line.2019"></a>
<span class="sourceLineNo">2020</span><a name="line.2020"></a>
<span class="sourceLineNo">2021</span>    /**<a name="line.2021"></a>
<span class="sourceLineNo">2022</span>     * Updates (and cleans up) entities and tile entities<a name="line.2022"></a>
<span class="sourceLineNo">2023</span>     */<a name="line.2023"></a>
<span class="sourceLineNo">2024</span>    public void updateEntities()<a name="line.2024"></a>
<span class="sourceLineNo">2025</span>    {<a name="line.2025"></a>
<span class="sourceLineNo">2026</span>        this.theProfiler.startSection("entities");<a name="line.2026"></a>
<span class="sourceLineNo">2027</span>        this.theProfiler.startSection("global");<a name="line.2027"></a>
<span class="sourceLineNo">2028</span>        int i;<a name="line.2028"></a>
<span class="sourceLineNo">2029</span>        Entity entity;<a name="line.2029"></a>
<span class="sourceLineNo">2030</span>        CrashReport crashreport;<a name="line.2030"></a>
<span class="sourceLineNo">2031</span>        CrashReportCategory crashreportcategory;<a name="line.2031"></a>
<span class="sourceLineNo">2032</span><a name="line.2032"></a>
<span class="sourceLineNo">2033</span>        for (i = 0; i &lt; this.weatherEffects.size(); ++i)<a name="line.2033"></a>
<span class="sourceLineNo">2034</span>        {<a name="line.2034"></a>
<span class="sourceLineNo">2035</span>            entity = (Entity)this.weatherEffects.get(i);<a name="line.2035"></a>
<span class="sourceLineNo">2036</span><a name="line.2036"></a>
<span class="sourceLineNo">2037</span>            try<a name="line.2037"></a>
<span class="sourceLineNo">2038</span>            {<a name="line.2038"></a>
<span class="sourceLineNo">2039</span>                ++entity.ticksExisted;<a name="line.2039"></a>
<span class="sourceLineNo">2040</span>                entity.onUpdate();<a name="line.2040"></a>
<span class="sourceLineNo">2041</span>            }<a name="line.2041"></a>
<span class="sourceLineNo">2042</span>            catch (Throwable throwable)<a name="line.2042"></a>
<span class="sourceLineNo">2043</span>            {<a name="line.2043"></a>
<span class="sourceLineNo">2044</span>                crashreport = CrashReport.makeCrashReport(throwable, "Ticking entity");<a name="line.2044"></a>
<span class="sourceLineNo">2045</span>                crashreportcategory = crashreport.makeCategory("Entity being ticked");<a name="line.2045"></a>
<span class="sourceLineNo">2046</span><a name="line.2046"></a>
<span class="sourceLineNo">2047</span>                if (entity == null)<a name="line.2047"></a>
<span class="sourceLineNo">2048</span>                {<a name="line.2048"></a>
<span class="sourceLineNo">2049</span>                    crashreportcategory.addCrashSection("Entity", "~~NULL~~");<a name="line.2049"></a>
<span class="sourceLineNo">2050</span>                }<a name="line.2050"></a>
<span class="sourceLineNo">2051</span>                else<a name="line.2051"></a>
<span class="sourceLineNo">2052</span>                {<a name="line.2052"></a>
<span class="sourceLineNo">2053</span>                    entity.func_85029_a(crashreportcategory);<a name="line.2053"></a>
<span class="sourceLineNo">2054</span>                }<a name="line.2054"></a>
<span class="sourceLineNo">2055</span><a name="line.2055"></a>
<span class="sourceLineNo">2056</span>                if (ForgeDummyContainer.removeErroringEntities)<a name="line.2056"></a>
<span class="sourceLineNo">2057</span>                {<a name="line.2057"></a>
<span class="sourceLineNo">2058</span>                    FMLLog.severe(crashreport.getCompleteReport());<a name="line.2058"></a>
<span class="sourceLineNo">2059</span>                    removeEntity(entity);<a name="line.2059"></a>
<span class="sourceLineNo">2060</span>                }<a name="line.2060"></a>
<span class="sourceLineNo">2061</span>                else<a name="line.2061"></a>
<span class="sourceLineNo">2062</span>                {<a name="line.2062"></a>
<span class="sourceLineNo">2063</span>                    throw new ReportedException(crashreport);<a name="line.2063"></a>
<span class="sourceLineNo">2064</span>                }<a name="line.2064"></a>
<span class="sourceLineNo">2065</span>            }<a name="line.2065"></a>
<span class="sourceLineNo">2066</span><a name="line.2066"></a>
<span class="sourceLineNo">2067</span>            if (entity.isDead)<a name="line.2067"></a>
<span class="sourceLineNo">2068</span>            {<a name="line.2068"></a>
<span class="sourceLineNo">2069</span>                this.weatherEffects.remove(i--);<a name="line.2069"></a>
<span class="sourceLineNo">2070</span>            }<a name="line.2070"></a>
<span class="sourceLineNo">2071</span>        }<a name="line.2071"></a>
<span class="sourceLineNo">2072</span><a name="line.2072"></a>
<span class="sourceLineNo">2073</span>        this.theProfiler.endStartSection("remove");<a name="line.2073"></a>
<span class="sourceLineNo">2074</span>        this.loadedEntityList.removeAll(this.unloadedEntityList);<a name="line.2074"></a>
<span class="sourceLineNo">2075</span>        int j;<a name="line.2075"></a>
<span class="sourceLineNo">2076</span>        int k;<a name="line.2076"></a>
<span class="sourceLineNo">2077</span><a name="line.2077"></a>
<span class="sourceLineNo">2078</span>        for (i = 0; i &lt; this.unloadedEntityList.size(); ++i)<a name="line.2078"></a>
<span class="sourceLineNo">2079</span>        {<a name="line.2079"></a>
<span class="sourceLineNo">2080</span>            entity = (Entity)this.unloadedEntityList.get(i);<a name="line.2080"></a>
<span class="sourceLineNo">2081</span>            j = entity.chunkCoordX;<a name="line.2081"></a>
<span class="sourceLineNo">2082</span>            k = entity.chunkCoordZ;<a name="line.2082"></a>
<span class="sourceLineNo">2083</span><a name="line.2083"></a>
<span class="sourceLineNo">2084</span>            if (entity.addedToChunk &amp;&amp; this.chunkExists(j, k))<a name="line.2084"></a>
<span class="sourceLineNo">2085</span>            {<a name="line.2085"></a>
<span class="sourceLineNo">2086</span>                this.getChunkFromChunkCoords(j, k).removeEntity(entity);<a name="line.2086"></a>
<span class="sourceLineNo">2087</span>            }<a name="line.2087"></a>
<span class="sourceLineNo">2088</span>        }<a name="line.2088"></a>
<span class="sourceLineNo">2089</span><a name="line.2089"></a>
<span class="sourceLineNo">2090</span>        for (i = 0; i &lt; this.unloadedEntityList.size(); ++i)<a name="line.2090"></a>
<span class="sourceLineNo">2091</span>        {<a name="line.2091"></a>
<span class="sourceLineNo">2092</span>            this.releaseEntitySkin((Entity)this.unloadedEntityList.get(i));<a name="line.2092"></a>
<span class="sourceLineNo">2093</span>        }<a name="line.2093"></a>
<span class="sourceLineNo">2094</span><a name="line.2094"></a>
<span class="sourceLineNo">2095</span>        this.unloadedEntityList.clear();<a name="line.2095"></a>
<span class="sourceLineNo">2096</span>        this.theProfiler.endStartSection("regular");<a name="line.2096"></a>
<span class="sourceLineNo">2097</span><a name="line.2097"></a>
<span class="sourceLineNo">2098</span>        for (i = 0; i &lt; this.loadedEntityList.size(); ++i)<a name="line.2098"></a>
<span class="sourceLineNo">2099</span>        {<a name="line.2099"></a>
<span class="sourceLineNo">2100</span>            entity = (Entity)this.loadedEntityList.get(i);<a name="line.2100"></a>
<span class="sourceLineNo">2101</span><a name="line.2101"></a>
<span class="sourceLineNo">2102</span>            if (entity.ridingEntity != null)<a name="line.2102"></a>
<span class="sourceLineNo">2103</span>            {<a name="line.2103"></a>
<span class="sourceLineNo">2104</span>                if (!entity.ridingEntity.isDead &amp;&amp; entity.ridingEntity.riddenByEntity == entity)<a name="line.2104"></a>
<span class="sourceLineNo">2105</span>                {<a name="line.2105"></a>
<span class="sourceLineNo">2106</span>                    continue;<a name="line.2106"></a>
<span class="sourceLineNo">2107</span>                }<a name="line.2107"></a>
<span class="sourceLineNo">2108</span><a name="line.2108"></a>
<span class="sourceLineNo">2109</span>                entity.ridingEntity.riddenByEntity = null;<a name="line.2109"></a>
<span class="sourceLineNo">2110</span>                entity.ridingEntity = null;<a name="line.2110"></a>
<span class="sourceLineNo">2111</span>            }<a name="line.2111"></a>
<span class="sourceLineNo">2112</span><a name="line.2112"></a>
<span class="sourceLineNo">2113</span>            this.theProfiler.startSection("tick");<a name="line.2113"></a>
<span class="sourceLineNo">2114</span><a name="line.2114"></a>
<span class="sourceLineNo">2115</span>            if (!entity.isDead)<a name="line.2115"></a>
<span class="sourceLineNo">2116</span>            {<a name="line.2116"></a>
<span class="sourceLineNo">2117</span>                try<a name="line.2117"></a>
<span class="sourceLineNo">2118</span>                {<a name="line.2118"></a>
<span class="sourceLineNo">2119</span>                    this.updateEntity(entity);<a name="line.2119"></a>
<span class="sourceLineNo">2120</span>                }<a name="line.2120"></a>
<span class="sourceLineNo">2121</span>                catch (Throwable throwable1)<a name="line.2121"></a>
<span class="sourceLineNo">2122</span>                {<a name="line.2122"></a>
<span class="sourceLineNo">2123</span>                    crashreport = CrashReport.makeCrashReport(throwable1, "Ticking entity");<a name="line.2123"></a>
<span class="sourceLineNo">2124</span>                    crashreportcategory = crashreport.makeCategory("Entity being ticked");<a name="line.2124"></a>
<span class="sourceLineNo">2125</span>                    entity.func_85029_a(crashreportcategory);<a name="line.2125"></a>
<span class="sourceLineNo">2126</span><a name="line.2126"></a>
<span class="sourceLineNo">2127</span>                    if (ForgeDummyContainer.removeErroringEntities)<a name="line.2127"></a>
<span class="sourceLineNo">2128</span>                    {<a name="line.2128"></a>
<span class="sourceLineNo">2129</span>                        FMLLog.severe(crashreport.getCompleteReport());<a name="line.2129"></a>
<span class="sourceLineNo">2130</span>                        removeEntity(entity);<a name="line.2130"></a>
<span class="sourceLineNo">2131</span>                    }<a name="line.2131"></a>
<span class="sourceLineNo">2132</span>                    else<a name="line.2132"></a>
<span class="sourceLineNo">2133</span>                    {<a name="line.2133"></a>
<span class="sourceLineNo">2134</span>                        throw new ReportedException(crashreport);<a name="line.2134"></a>
<span class="sourceLineNo">2135</span>                    }<a name="line.2135"></a>
<span class="sourceLineNo">2136</span>                }<a name="line.2136"></a>
<span class="sourceLineNo">2137</span>            }<a name="line.2137"></a>
<span class="sourceLineNo">2138</span><a name="line.2138"></a>
<span class="sourceLineNo">2139</span>            this.theProfiler.endSection();<a name="line.2139"></a>
<span class="sourceLineNo">2140</span>            this.theProfiler.startSection("remove");<a name="line.2140"></a>
<span class="sourceLineNo">2141</span><a name="line.2141"></a>
<span class="sourceLineNo">2142</span>            if (entity.isDead)<a name="line.2142"></a>
<span class="sourceLineNo">2143</span>            {<a name="line.2143"></a>
<span class="sourceLineNo">2144</span>                // If it's dead, move it to the unloaded list for removal on the next tick<a name="line.2144"></a>
<span class="sourceLineNo">2145</span>                unloadedEntityList.add(entity);<a name="line.2145"></a>
<span class="sourceLineNo">2146</span>            }<a name="line.2146"></a>
<span class="sourceLineNo">2147</span><a name="line.2147"></a>
<span class="sourceLineNo">2148</span>            this.theProfiler.endSection();<a name="line.2148"></a>
<span class="sourceLineNo">2149</span>        }<a name="line.2149"></a>
<span class="sourceLineNo">2150</span><a name="line.2150"></a>
<span class="sourceLineNo">2151</span>        this.theProfiler.endStartSection("tileEntities");<a name="line.2151"></a>
<span class="sourceLineNo">2152</span>        this.scanningTileEntities = true;<a name="line.2152"></a>
<span class="sourceLineNo">2153</span>        Iterator iterator = this.loadedTileEntityList.iterator();<a name="line.2153"></a>
<span class="sourceLineNo">2154</span><a name="line.2154"></a>
<span class="sourceLineNo">2155</span>        while (iterator.hasNext())<a name="line.2155"></a>
<span class="sourceLineNo">2156</span>        {<a name="line.2156"></a>
<span class="sourceLineNo">2157</span>            TileEntity tileentity = (TileEntity)iterator.next();<a name="line.2157"></a>
<span class="sourceLineNo">2158</span><a name="line.2158"></a>
<span class="sourceLineNo">2159</span>            if (!tileentity.isInvalid() &amp;&amp; tileentity.func_70309_m() &amp;&amp; this.blockExists(tileentity.xCoord, tileentity.yCoord, tileentity.zCoord))<a name="line.2159"></a>
<span class="sourceLineNo">2160</span>            {<a name="line.2160"></a>
<span class="sourceLineNo">2161</span>                try<a name="line.2161"></a>
<span class="sourceLineNo">2162</span>                {<a name="line.2162"></a>
<span class="sourceLineNo">2163</span>                    tileentity.updateEntity();<a name="line.2163"></a>
<span class="sourceLineNo">2164</span>                }<a name="line.2164"></a>
<span class="sourceLineNo">2165</span>                catch (Throwable throwable2)<a name="line.2165"></a>
<span class="sourceLineNo">2166</span>                {<a name="line.2166"></a>
<span class="sourceLineNo">2167</span>                    crashreport = CrashReport.makeCrashReport(throwable2, "Ticking tile entity");<a name="line.2167"></a>
<span class="sourceLineNo">2168</span>                    crashreportcategory = crashreport.makeCategory("Tile entity being ticked");<a name="line.2168"></a>
<span class="sourceLineNo">2169</span>                    tileentity.func_85027_a(crashreportcategory);<a name="line.2169"></a>
<span class="sourceLineNo">2170</span>                    if (ForgeDummyContainer.removeErroringTileEntities)<a name="line.2170"></a>
<span class="sourceLineNo">2171</span>                    {<a name="line.2171"></a>
<span class="sourceLineNo">2172</span>                        FMLLog.severe(crashreport.getCompleteReport());<a name="line.2172"></a>
<span class="sourceLineNo">2173</span>                        tileentity.invalidate();<a name="line.2173"></a>
<span class="sourceLineNo">2174</span>                        func_94571_i(tileentity.xCoord, tileentity.yCoord, tileentity.zCoord);<a name="line.2174"></a>
<span class="sourceLineNo">2175</span>                    }<a name="line.2175"></a>
<span class="sourceLineNo">2176</span>                    else<a name="line.2176"></a>
<span class="sourceLineNo">2177</span>                    {<a name="line.2177"></a>
<span class="sourceLineNo">2178</span>                        throw new ReportedException(crashreport);<a name="line.2178"></a>
<span class="sourceLineNo">2179</span>                    }<a name="line.2179"></a>
<span class="sourceLineNo">2180</span>                }<a name="line.2180"></a>
<span class="sourceLineNo">2181</span>            }<a name="line.2181"></a>
<span class="sourceLineNo">2182</span><a name="line.2182"></a>
<span class="sourceLineNo">2183</span>            if (tileentity.isInvalid())<a name="line.2183"></a>
<span class="sourceLineNo">2184</span>            {<a name="line.2184"></a>
<span class="sourceLineNo">2185</span>                iterator.remove();<a name="line.2185"></a>
<span class="sourceLineNo">2186</span><a name="line.2186"></a>
<span class="sourceLineNo">2187</span>                if (this.chunkExists(tileentity.xCoord &gt;&gt; 4, tileentity.zCoord &gt;&gt; 4))<a name="line.2187"></a>
<span class="sourceLineNo">2188</span>                {<a name="line.2188"></a>
<span class="sourceLineNo">2189</span>                    Chunk chunk = this.getChunkFromChunkCoords(tileentity.xCoord &gt;&gt; 4, tileentity.zCoord &gt;&gt; 4);<a name="line.2189"></a>
<span class="sourceLineNo">2190</span><a name="line.2190"></a>
<span class="sourceLineNo">2191</span>                    if (chunk != null)<a name="line.2191"></a>
<span class="sourceLineNo">2192</span>                    {<a name="line.2192"></a>
<span class="sourceLineNo">2193</span>                        chunk.cleanChunkBlockTileEntity(tileentity.xCoord &amp; 15, tileentity.yCoord, tileentity.zCoord &amp; 15);<a name="line.2193"></a>
<span class="sourceLineNo">2194</span>                    }<a name="line.2194"></a>
<span class="sourceLineNo">2195</span>                }<a name="line.2195"></a>
<span class="sourceLineNo">2196</span>            }<a name="line.2196"></a>
<span class="sourceLineNo">2197</span>        }<a name="line.2197"></a>
<span class="sourceLineNo">2198</span><a name="line.2198"></a>
<span class="sourceLineNo">2199</span><a name="line.2199"></a>
<span class="sourceLineNo">2200</span>        if (!this.entityRemoval.isEmpty())<a name="line.2200"></a>
<span class="sourceLineNo">2201</span>        {<a name="line.2201"></a>
<span class="sourceLineNo">2202</span>            for (Object tile : entityRemoval)<a name="line.2202"></a>
<span class="sourceLineNo">2203</span>            {<a name="line.2203"></a>
<span class="sourceLineNo">2204</span>               ((TileEntity)tile).onChunkUnload();<a name="line.2204"></a>
<span class="sourceLineNo">2205</span>            }<a name="line.2205"></a>
<span class="sourceLineNo">2206</span>            this.loadedTileEntityList.removeAll(this.entityRemoval);<a name="line.2206"></a>
<span class="sourceLineNo">2207</span>            this.entityRemoval.clear();<a name="line.2207"></a>
<span class="sourceLineNo">2208</span>        }<a name="line.2208"></a>
<span class="sourceLineNo">2209</span><a name="line.2209"></a>
<span class="sourceLineNo">2210</span>        this.scanningTileEntities = false;<a name="line.2210"></a>
<span class="sourceLineNo">2211</span><a name="line.2211"></a>
<span class="sourceLineNo">2212</span>        this.theProfiler.endStartSection("pendingTileEntities");<a name="line.2212"></a>
<span class="sourceLineNo">2213</span><a name="line.2213"></a>
<span class="sourceLineNo">2214</span>        if (!this.addedTileEntityList.isEmpty())<a name="line.2214"></a>
<span class="sourceLineNo">2215</span>        {<a name="line.2215"></a>
<span class="sourceLineNo">2216</span>            for (int l = 0; l &lt; this.addedTileEntityList.size(); ++l)<a name="line.2216"></a>
<span class="sourceLineNo">2217</span>            {<a name="line.2217"></a>
<span class="sourceLineNo">2218</span>                TileEntity tileentity1 = (TileEntity)this.addedTileEntityList.get(l);<a name="line.2218"></a>
<span class="sourceLineNo">2219</span><a name="line.2219"></a>
<span class="sourceLineNo">2220</span>                if (!tileentity1.isInvalid())<a name="line.2220"></a>
<span class="sourceLineNo">2221</span>                {<a name="line.2221"></a>
<span class="sourceLineNo">2222</span>                    if (!this.loadedTileEntityList.contains(tileentity1))<a name="line.2222"></a>
<span class="sourceLineNo">2223</span>                    {<a name="line.2223"></a>
<span class="sourceLineNo">2224</span>                        this.loadedTileEntityList.add(tileentity1);<a name="line.2224"></a>
<span class="sourceLineNo">2225</span>                    }<a name="line.2225"></a>
<span class="sourceLineNo">2226</span>                }<a name="line.2226"></a>
<span class="sourceLineNo">2227</span>                else<a name="line.2227"></a>
<span class="sourceLineNo">2228</span>                {<a name="line.2228"></a>
<span class="sourceLineNo">2229</span>                    if (this.chunkExists(tileentity1.xCoord &gt;&gt; 4, tileentity1.zCoord &gt;&gt; 4))<a name="line.2229"></a>
<span class="sourceLineNo">2230</span>                    {<a name="line.2230"></a>
<span class="sourceLineNo">2231</span>                        Chunk chunk1 = this.getChunkFromChunkCoords(tileentity1.xCoord &gt;&gt; 4, tileentity1.zCoord &gt;&gt; 4);<a name="line.2231"></a>
<span class="sourceLineNo">2232</span><a name="line.2232"></a>
<span class="sourceLineNo">2233</span>                        if (chunk1 != null)<a name="line.2233"></a>
<span class="sourceLineNo">2234</span>                        {<a name="line.2234"></a>
<span class="sourceLineNo">2235</span>                            chunk1.cleanChunkBlockTileEntity(tileentity1.xCoord &amp; 15, tileentity1.yCoord, tileentity1.zCoord &amp; 15);<a name="line.2235"></a>
<span class="sourceLineNo">2236</span>                        }<a name="line.2236"></a>
<span class="sourceLineNo">2237</span>                    }<a name="line.2237"></a>
<span class="sourceLineNo">2238</span>                }<a name="line.2238"></a>
<span class="sourceLineNo">2239</span>            }<a name="line.2239"></a>
<span class="sourceLineNo">2240</span><a name="line.2240"></a>
<span class="sourceLineNo">2241</span>            this.addedTileEntityList.clear();<a name="line.2241"></a>
<span class="sourceLineNo">2242</span>        }<a name="line.2242"></a>
<span class="sourceLineNo">2243</span><a name="line.2243"></a>
<span class="sourceLineNo">2244</span>        this.theProfiler.endSection();<a name="line.2244"></a>
<span class="sourceLineNo">2245</span>        this.theProfiler.endSection();<a name="line.2245"></a>
<span class="sourceLineNo">2246</span>    }<a name="line.2246"></a>
<span class="sourceLineNo">2247</span><a name="line.2247"></a>
<span class="sourceLineNo">2248</span>    public void addTileEntity(Collection par1Collection)<a name="line.2248"></a>
<span class="sourceLineNo">2249</span>    {<a name="line.2249"></a>
<span class="sourceLineNo">2250</span>        List dest = scanningTileEntities ? addedTileEntityList : loadedTileEntityList;<a name="line.2250"></a>
<span class="sourceLineNo">2251</span>        for(Object entity : par1Collection)<a name="line.2251"></a>
<span class="sourceLineNo">2252</span>        {<a name="line.2252"></a>
<span class="sourceLineNo">2253</span>            if(((TileEntity)entity).canUpdate())<a name="line.2253"></a>
<span class="sourceLineNo">2254</span>            {<a name="line.2254"></a>
<span class="sourceLineNo">2255</span>                dest.add(entity);<a name="line.2255"></a>
<span class="sourceLineNo">2256</span>            }<a name="line.2256"></a>
<span class="sourceLineNo">2257</span>        }<a name="line.2257"></a>
<span class="sourceLineNo">2258</span>    }<a name="line.2258"></a>
<span class="sourceLineNo">2259</span><a name="line.2259"></a>
<span class="sourceLineNo">2260</span>    /**<a name="line.2260"></a>
<span class="sourceLineNo">2261</span>     * Will update the entity in the world if the chunk the entity is in is currently loaded. Args: entity<a name="line.2261"></a>
<span class="sourceLineNo">2262</span>     */<a name="line.2262"></a>
<span class="sourceLineNo">2263</span>    public void updateEntity(Entity par1Entity)<a name="line.2263"></a>
<span class="sourceLineNo">2264</span>    {<a name="line.2264"></a>
<span class="sourceLineNo">2265</span>        this.updateEntityWithOptionalForce(par1Entity, true);<a name="line.2265"></a>
<span class="sourceLineNo">2266</span>    }<a name="line.2266"></a>
<span class="sourceLineNo">2267</span><a name="line.2267"></a>
<span class="sourceLineNo">2268</span>    /**<a name="line.2268"></a>
<span class="sourceLineNo">2269</span>     * Will update the entity in the world if the chunk the entity is in is currently loaded or its forced to update.<a name="line.2269"></a>
<span class="sourceLineNo">2270</span>     * Args: entity, forceUpdate<a name="line.2270"></a>
<span class="sourceLineNo">2271</span>     */<a name="line.2271"></a>
<span class="sourceLineNo">2272</span>    public void updateEntityWithOptionalForce(Entity par1Entity, boolean par2)<a name="line.2272"></a>
<span class="sourceLineNo">2273</span>    {<a name="line.2273"></a>
<span class="sourceLineNo">2274</span>        int i = MathHelper.floor_double(par1Entity.posX);<a name="line.2274"></a>
<span class="sourceLineNo">2275</span>        int j = MathHelper.floor_double(par1Entity.posZ);<a name="line.2275"></a>
<span class="sourceLineNo">2276</span><a name="line.2276"></a>
<span class="sourceLineNo">2277</span>        boolean isForced = getPersistentChunks().containsKey(new ChunkCoordIntPair(i &gt;&gt; 4, j &gt;&gt; 4));<a name="line.2277"></a>
<span class="sourceLineNo">2278</span>        byte b0 = isForced ? (byte)0 : 32;<a name="line.2278"></a>
<span class="sourceLineNo">2279</span>        boolean canUpdate = !par2 || this.checkChunksExist(i - b0, 0, j - b0, i + b0, 0, j + b0);<a name="line.2279"></a>
<span class="sourceLineNo">2280</span>        if (!canUpdate)<a name="line.2280"></a>
<span class="sourceLineNo">2281</span>        {<a name="line.2281"></a>
<span class="sourceLineNo">2282</span>            EntityEvent.CanUpdate event = new EntityEvent.CanUpdate(par1Entity);<a name="line.2282"></a>
<span class="sourceLineNo">2283</span>            MinecraftForge.EVENT_BUS.post(event);<a name="line.2283"></a>
<span class="sourceLineNo">2284</span>            canUpdate = event.canUpdate;<a name="line.2284"></a>
<span class="sourceLineNo">2285</span>        }<a name="line.2285"></a>
<span class="sourceLineNo">2286</span>        if (canUpdate)<a name="line.2286"></a>
<span class="sourceLineNo">2287</span>        {<a name="line.2287"></a>
<span class="sourceLineNo">2288</span>            par1Entity.lastTickPosX = par1Entity.posX;<a name="line.2288"></a>
<span class="sourceLineNo">2289</span>            par1Entity.lastTickPosY = par1Entity.posY;<a name="line.2289"></a>
<span class="sourceLineNo">2290</span>            par1Entity.lastTickPosZ = par1Entity.posZ;<a name="line.2290"></a>
<span class="sourceLineNo">2291</span>            par1Entity.prevRotationYaw = par1Entity.rotationYaw;<a name="line.2291"></a>
<span class="sourceLineNo">2292</span>            par1Entity.prevRotationPitch = par1Entity.rotationPitch;<a name="line.2292"></a>
<span class="sourceLineNo">2293</span><a name="line.2293"></a>
<span class="sourceLineNo">2294</span>            if (par2 &amp;&amp; par1Entity.addedToChunk)<a name="line.2294"></a>
<span class="sourceLineNo">2295</span>            {<a name="line.2295"></a>
<span class="sourceLineNo">2296</span>                if (par1Entity.ridingEntity != null)<a name="line.2296"></a>
<span class="sourceLineNo">2297</span>                {<a name="line.2297"></a>
<span class="sourceLineNo">2298</span>                    par1Entity.updateRidden();<a name="line.2298"></a>
<span class="sourceLineNo">2299</span>                }<a name="line.2299"></a>
<span class="sourceLineNo">2300</span>                else<a name="line.2300"></a>
<span class="sourceLineNo">2301</span>                {<a name="line.2301"></a>
<span class="sourceLineNo">2302</span>                    ++par1Entity.ticksExisted;<a name="line.2302"></a>
<span class="sourceLineNo">2303</span>                    par1Entity.onUpdate();<a name="line.2303"></a>
<span class="sourceLineNo">2304</span>                }<a name="line.2304"></a>
<span class="sourceLineNo">2305</span>            }<a name="line.2305"></a>
<span class="sourceLineNo">2306</span><a name="line.2306"></a>
<span class="sourceLineNo">2307</span>            this.theProfiler.startSection("chunkCheck");<a name="line.2307"></a>
<span class="sourceLineNo">2308</span><a name="line.2308"></a>
<span class="sourceLineNo">2309</span>            if (Double.isNaN(par1Entity.posX) || Double.isInfinite(par1Entity.posX))<a name="line.2309"></a>
<span class="sourceLineNo">2310</span>            {<a name="line.2310"></a>
<span class="sourceLineNo">2311</span>                par1Entity.posX = par1Entity.lastTickPosX;<a name="line.2311"></a>
<span class="sourceLineNo">2312</span>            }<a name="line.2312"></a>
<span class="sourceLineNo">2313</span><a name="line.2313"></a>
<span class="sourceLineNo">2314</span>            if (Double.isNaN(par1Entity.posY) || Double.isInfinite(par1Entity.posY))<a name="line.2314"></a>
<span class="sourceLineNo">2315</span>            {<a name="line.2315"></a>
<span class="sourceLineNo">2316</span>                par1Entity.posY = par1Entity.lastTickPosY;<a name="line.2316"></a>
<span class="sourceLineNo">2317</span>            }<a name="line.2317"></a>
<span class="sourceLineNo">2318</span><a name="line.2318"></a>
<span class="sourceLineNo">2319</span>            if (Double.isNaN(par1Entity.posZ) || Double.isInfinite(par1Entity.posZ))<a name="line.2319"></a>
<span class="sourceLineNo">2320</span>            {<a name="line.2320"></a>
<span class="sourceLineNo">2321</span>                par1Entity.posZ = par1Entity.lastTickPosZ;<a name="line.2321"></a>
<span class="sourceLineNo">2322</span>            }<a name="line.2322"></a>
<span class="sourceLineNo">2323</span><a name="line.2323"></a>
<span class="sourceLineNo">2324</span>            if (Double.isNaN((double)par1Entity.rotationPitch) || Double.isInfinite((double)par1Entity.rotationPitch))<a name="line.2324"></a>
<span class="sourceLineNo">2325</span>            {<a name="line.2325"></a>
<span class="sourceLineNo">2326</span>                par1Entity.rotationPitch = par1Entity.prevRotationPitch;<a name="line.2326"></a>
<span class="sourceLineNo">2327</span>            }<a name="line.2327"></a>
<span class="sourceLineNo">2328</span><a name="line.2328"></a>
<span class="sourceLineNo">2329</span>            if (Double.isNaN((double)par1Entity.rotationYaw) || Double.isInfinite((double)par1Entity.rotationYaw))<a name="line.2329"></a>
<span class="sourceLineNo">2330</span>            {<a name="line.2330"></a>
<span class="sourceLineNo">2331</span>                par1Entity.rotationYaw = par1Entity.prevRotationYaw;<a name="line.2331"></a>
<span class="sourceLineNo">2332</span>            }<a name="line.2332"></a>
<span class="sourceLineNo">2333</span><a name="line.2333"></a>
<span class="sourceLineNo">2334</span>            int k = MathHelper.floor_double(par1Entity.posX / 16.0D);<a name="line.2334"></a>
<span class="sourceLineNo">2335</span>            int l = MathHelper.floor_double(par1Entity.posY / 16.0D);<a name="line.2335"></a>
<span class="sourceLineNo">2336</span>            int i1 = MathHelper.floor_double(par1Entity.posZ / 16.0D);<a name="line.2336"></a>
<span class="sourceLineNo">2337</span><a name="line.2337"></a>
<span class="sourceLineNo">2338</span>            if (!par1Entity.addedToChunk || par1Entity.chunkCoordX != k || par1Entity.chunkCoordY != l || par1Entity.chunkCoordZ != i1)<a name="line.2338"></a>
<span class="sourceLineNo">2339</span>            {<a name="line.2339"></a>
<span class="sourceLineNo">2340</span>                if (par1Entity.addedToChunk &amp;&amp; this.chunkExists(par1Entity.chunkCoordX, par1Entity.chunkCoordZ))<a name="line.2340"></a>
<span class="sourceLineNo">2341</span>                {<a name="line.2341"></a>
<span class="sourceLineNo">2342</span>                    this.getChunkFromChunkCoords(par1Entity.chunkCoordX, par1Entity.chunkCoordZ).removeEntityAtIndex(par1Entity, par1Entity.chunkCoordY);<a name="line.2342"></a>
<span class="sourceLineNo">2343</span>                }<a name="line.2343"></a>
<span class="sourceLineNo">2344</span><a name="line.2344"></a>
<span class="sourceLineNo">2345</span>                if (this.chunkExists(k, i1))<a name="line.2345"></a>
<span class="sourceLineNo">2346</span>                {<a name="line.2346"></a>
<span class="sourceLineNo">2347</span>                    par1Entity.addedToChunk = true;<a name="line.2347"></a>
<span class="sourceLineNo">2348</span>                    this.getChunkFromChunkCoords(k, i1).addEntity(par1Entity);<a name="line.2348"></a>
<span class="sourceLineNo">2349</span>                }<a name="line.2349"></a>
<span class="sourceLineNo">2350</span>                else<a name="line.2350"></a>
<span class="sourceLineNo">2351</span>                {<a name="line.2351"></a>
<span class="sourceLineNo">2352</span>                    par1Entity.addedToChunk = false;<a name="line.2352"></a>
<span class="sourceLineNo">2353</span>                }<a name="line.2353"></a>
<span class="sourceLineNo">2354</span>            }<a name="line.2354"></a>
<span class="sourceLineNo">2355</span><a name="line.2355"></a>
<span class="sourceLineNo">2356</span>            this.theProfiler.endSection();<a name="line.2356"></a>
<span class="sourceLineNo">2357</span><a name="line.2357"></a>
<span class="sourceLineNo">2358</span>            if (par2 &amp;&amp; par1Entity.addedToChunk &amp;&amp; par1Entity.riddenByEntity != null)<a name="line.2358"></a>
<span class="sourceLineNo">2359</span>            {<a name="line.2359"></a>
<span class="sourceLineNo">2360</span>                if (!par1Entity.riddenByEntity.isDead &amp;&amp; par1Entity.riddenByEntity.ridingEntity == par1Entity)<a name="line.2360"></a>
<span class="sourceLineNo">2361</span>                {<a name="line.2361"></a>
<span class="sourceLineNo">2362</span>                    this.updateEntity(par1Entity.riddenByEntity);<a name="line.2362"></a>
<span class="sourceLineNo">2363</span>                }<a name="line.2363"></a>
<span class="sourceLineNo">2364</span>                else<a name="line.2364"></a>
<span class="sourceLineNo">2365</span>                {<a name="line.2365"></a>
<span class="sourceLineNo">2366</span>                    par1Entity.riddenByEntity.ridingEntity = null;<a name="line.2366"></a>
<span class="sourceLineNo">2367</span>                    par1Entity.riddenByEntity = null;<a name="line.2367"></a>
<span class="sourceLineNo">2368</span>                }<a name="line.2368"></a>
<span class="sourceLineNo">2369</span>            }<a name="line.2369"></a>
<span class="sourceLineNo">2370</span>        }<a name="line.2370"></a>
<span class="sourceLineNo">2371</span>    }<a name="line.2371"></a>
<span class="sourceLineNo">2372</span><a name="line.2372"></a>
<span class="sourceLineNo">2373</span>    /**<a name="line.2373"></a>
<span class="sourceLineNo">2374</span>     * Returns true if there are no solid, live entities in the specified AxisAlignedBB<a name="line.2374"></a>
<span class="sourceLineNo">2375</span>     */<a name="line.2375"></a>
<span class="sourceLineNo">2376</span>    public boolean checkIfAABBIsClear(AxisAlignedBB par1AxisAlignedBB)<a name="line.2376"></a>
<span class="sourceLineNo">2377</span>    {<a name="line.2377"></a>
<span class="sourceLineNo">2378</span>        return this.checkIfAABBIsClearExcludingEntity(par1AxisAlignedBB, (Entity)null);<a name="line.2378"></a>
<span class="sourceLineNo">2379</span>    }<a name="line.2379"></a>
<span class="sourceLineNo">2380</span><a name="line.2380"></a>
<span class="sourceLineNo">2381</span>    /**<a name="line.2381"></a>
<span class="sourceLineNo">2382</span>     * Returns true if there are no solid, live entities in the specified AxisAlignedBB, excluding the given entity<a name="line.2382"></a>
<span class="sourceLineNo">2383</span>     */<a name="line.2383"></a>
<span class="sourceLineNo">2384</span>    public boolean checkIfAABBIsClearExcludingEntity(AxisAlignedBB par1AxisAlignedBB, Entity par2Entity)<a name="line.2384"></a>
<span class="sourceLineNo">2385</span>    {<a name="line.2385"></a>
<span class="sourceLineNo">2386</span>        List list = this.getEntitiesWithinAABBExcludingEntity((Entity)null, par1AxisAlignedBB);<a name="line.2386"></a>
<span class="sourceLineNo">2387</span><a name="line.2387"></a>
<span class="sourceLineNo">2388</span>        for (int i = 0; i &lt; list.size(); ++i)<a name="line.2388"></a>
<span class="sourceLineNo">2389</span>        {<a name="line.2389"></a>
<span class="sourceLineNo">2390</span>            Entity entity1 = (Entity)list.get(i);<a name="line.2390"></a>
<span class="sourceLineNo">2391</span><a name="line.2391"></a>
<span class="sourceLineNo">2392</span>            if (!entity1.isDead &amp;&amp; entity1.preventEntitySpawning &amp;&amp; entity1 != par2Entity)<a name="line.2392"></a>
<span class="sourceLineNo">2393</span>            {<a name="line.2393"></a>
<span class="sourceLineNo">2394</span>                return false;<a name="line.2394"></a>
<span class="sourceLineNo">2395</span>            }<a name="line.2395"></a>
<span class="sourceLineNo">2396</span>        }<a name="line.2396"></a>
<span class="sourceLineNo">2397</span><a name="line.2397"></a>
<span class="sourceLineNo">2398</span>        return true;<a name="line.2398"></a>
<span class="sourceLineNo">2399</span>    }<a name="line.2399"></a>
<span class="sourceLineNo">2400</span><a name="line.2400"></a>
<span class="sourceLineNo">2401</span>    /**<a name="line.2401"></a>
<span class="sourceLineNo">2402</span>     * Returns true if there are any blocks in the region constrained by an AxisAlignedBB<a name="line.2402"></a>
<span class="sourceLineNo">2403</span>     */<a name="line.2403"></a>
<span class="sourceLineNo">2404</span>    public boolean isAABBNonEmpty(AxisAlignedBB par1AxisAlignedBB)<a name="line.2404"></a>
<span class="sourceLineNo">2405</span>    {<a name="line.2405"></a>
<span class="sourceLineNo">2406</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.2406"></a>
<span class="sourceLineNo">2407</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.2407"></a>
<span class="sourceLineNo">2408</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.2408"></a>
<span class="sourceLineNo">2409</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.2409"></a>
<span class="sourceLineNo">2410</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.2410"></a>
<span class="sourceLineNo">2411</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.2411"></a>
<span class="sourceLineNo">2412</span><a name="line.2412"></a>
<span class="sourceLineNo">2413</span>        if (par1AxisAlignedBB.minX &lt; 0.0D)<a name="line.2413"></a>
<span class="sourceLineNo">2414</span>        {<a name="line.2414"></a>
<span class="sourceLineNo">2415</span>            --i;<a name="line.2415"></a>
<span class="sourceLineNo">2416</span>        }<a name="line.2416"></a>
<span class="sourceLineNo">2417</span><a name="line.2417"></a>
<span class="sourceLineNo">2418</span>        if (par1AxisAlignedBB.minY &lt; 0.0D)<a name="line.2418"></a>
<span class="sourceLineNo">2419</span>        {<a name="line.2419"></a>
<span class="sourceLineNo">2420</span>            --k;<a name="line.2420"></a>
<span class="sourceLineNo">2421</span>        }<a name="line.2421"></a>
<span class="sourceLineNo">2422</span><a name="line.2422"></a>
<span class="sourceLineNo">2423</span>        if (par1AxisAlignedBB.minZ &lt; 0.0D)<a name="line.2423"></a>
<span class="sourceLineNo">2424</span>        {<a name="line.2424"></a>
<span class="sourceLineNo">2425</span>            --i1;<a name="line.2425"></a>
<span class="sourceLineNo">2426</span>        }<a name="line.2426"></a>
<span class="sourceLineNo">2427</span><a name="line.2427"></a>
<span class="sourceLineNo">2428</span>        for (int k1 = i; k1 &lt; j; ++k1)<a name="line.2428"></a>
<span class="sourceLineNo">2429</span>        {<a name="line.2429"></a>
<span class="sourceLineNo">2430</span>            for (int l1 = k; l1 &lt; l; ++l1)<a name="line.2430"></a>
<span class="sourceLineNo">2431</span>            {<a name="line.2431"></a>
<span class="sourceLineNo">2432</span>                for (int i2 = i1; i2 &lt; j1; ++i2)<a name="line.2432"></a>
<span class="sourceLineNo">2433</span>                {<a name="line.2433"></a>
<span class="sourceLineNo">2434</span>                    Block block = Block.blocksList[this.getBlockId(k1, l1, i2)];<a name="line.2434"></a>
<span class="sourceLineNo">2435</span><a name="line.2435"></a>
<span class="sourceLineNo">2436</span>                    if (block != null)<a name="line.2436"></a>
<span class="sourceLineNo">2437</span>                    {<a name="line.2437"></a>
<span class="sourceLineNo">2438</span>                        return true;<a name="line.2438"></a>
<span class="sourceLineNo">2439</span>                    }<a name="line.2439"></a>
<span class="sourceLineNo">2440</span>                }<a name="line.2440"></a>
<span class="sourceLineNo">2441</span>            }<a name="line.2441"></a>
<span class="sourceLineNo">2442</span>        }<a name="line.2442"></a>
<span class="sourceLineNo">2443</span><a name="line.2443"></a>
<span class="sourceLineNo">2444</span>        return false;<a name="line.2444"></a>
<span class="sourceLineNo">2445</span>    }<a name="line.2445"></a>
<span class="sourceLineNo">2446</span><a name="line.2446"></a>
<span class="sourceLineNo">2447</span>    /**<a name="line.2447"></a>
<span class="sourceLineNo">2448</span>     * Returns if any of the blocks within the aabb are liquids. Args: aabb<a name="line.2448"></a>
<span class="sourceLineNo">2449</span>     */<a name="line.2449"></a>
<span class="sourceLineNo">2450</span>    public boolean isAnyLiquid(AxisAlignedBB par1AxisAlignedBB)<a name="line.2450"></a>
<span class="sourceLineNo">2451</span>    {<a name="line.2451"></a>
<span class="sourceLineNo">2452</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.2452"></a>
<span class="sourceLineNo">2453</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.2453"></a>
<span class="sourceLineNo">2454</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.2454"></a>
<span class="sourceLineNo">2455</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.2455"></a>
<span class="sourceLineNo">2456</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.2456"></a>
<span class="sourceLineNo">2457</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.2457"></a>
<span class="sourceLineNo">2458</span><a name="line.2458"></a>
<span class="sourceLineNo">2459</span>        if (par1AxisAlignedBB.minX &lt; 0.0D)<a name="line.2459"></a>
<span class="sourceLineNo">2460</span>        {<a name="line.2460"></a>
<span class="sourceLineNo">2461</span>            --i;<a name="line.2461"></a>
<span class="sourceLineNo">2462</span>        }<a name="line.2462"></a>
<span class="sourceLineNo">2463</span><a name="line.2463"></a>
<span class="sourceLineNo">2464</span>        if (par1AxisAlignedBB.minY &lt; 0.0D)<a name="line.2464"></a>
<span class="sourceLineNo">2465</span>        {<a name="line.2465"></a>
<span class="sourceLineNo">2466</span>            --k;<a name="line.2466"></a>
<span class="sourceLineNo">2467</span>        }<a name="line.2467"></a>
<span class="sourceLineNo">2468</span><a name="line.2468"></a>
<span class="sourceLineNo">2469</span>        if (par1AxisAlignedBB.minZ &lt; 0.0D)<a name="line.2469"></a>
<span class="sourceLineNo">2470</span>        {<a name="line.2470"></a>
<span class="sourceLineNo">2471</span>            --i1;<a name="line.2471"></a>
<span class="sourceLineNo">2472</span>        }<a name="line.2472"></a>
<span class="sourceLineNo">2473</span><a name="line.2473"></a>
<span class="sourceLineNo">2474</span>        for (int k1 = i; k1 &lt; j; ++k1)<a name="line.2474"></a>
<span class="sourceLineNo">2475</span>        {<a name="line.2475"></a>
<span class="sourceLineNo">2476</span>            for (int l1 = k; l1 &lt; l; ++l1)<a name="line.2476"></a>
<span class="sourceLineNo">2477</span>            {<a name="line.2477"></a>
<span class="sourceLineNo">2478</span>                for (int i2 = i1; i2 &lt; j1; ++i2)<a name="line.2478"></a>
<span class="sourceLineNo">2479</span>                {<a name="line.2479"></a>
<span class="sourceLineNo">2480</span>                    Block block = Block.blocksList[this.getBlockId(k1, l1, i2)];<a name="line.2480"></a>
<span class="sourceLineNo">2481</span><a name="line.2481"></a>
<span class="sourceLineNo">2482</span>                    if (block != null &amp;&amp; block.blockMaterial.isLiquid())<a name="line.2482"></a>
<span class="sourceLineNo">2483</span>                    {<a name="line.2483"></a>
<span class="sourceLineNo">2484</span>                        return true;<a name="line.2484"></a>
<span class="sourceLineNo">2485</span>                    }<a name="line.2485"></a>
<span class="sourceLineNo">2486</span>                }<a name="line.2486"></a>
<span class="sourceLineNo">2487</span>            }<a name="line.2487"></a>
<span class="sourceLineNo">2488</span>        }<a name="line.2488"></a>
<span class="sourceLineNo">2489</span><a name="line.2489"></a>
<span class="sourceLineNo">2490</span>        return false;<a name="line.2490"></a>
<span class="sourceLineNo">2491</span>    }<a name="line.2491"></a>
<span class="sourceLineNo">2492</span><a name="line.2492"></a>
<span class="sourceLineNo">2493</span>    /**<a name="line.2493"></a>
<span class="sourceLineNo">2494</span>     * Returns whether or not the given bounding box is on fire or not<a name="line.2494"></a>
<span class="sourceLineNo">2495</span>     */<a name="line.2495"></a>
<span class="sourceLineNo">2496</span>    public boolean isBoundingBoxBurning(AxisAlignedBB par1AxisAlignedBB)<a name="line.2496"></a>
<span class="sourceLineNo">2497</span>    {<a name="line.2497"></a>
<span class="sourceLineNo">2498</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.2498"></a>
<span class="sourceLineNo">2499</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.2499"></a>
<span class="sourceLineNo">2500</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.2500"></a>
<span class="sourceLineNo">2501</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.2501"></a>
<span class="sourceLineNo">2502</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.2502"></a>
<span class="sourceLineNo">2503</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.2503"></a>
<span class="sourceLineNo">2504</span><a name="line.2504"></a>
<span class="sourceLineNo">2505</span>        if (this.checkChunksExist(i, k, i1, j, l, j1))<a name="line.2505"></a>
<span class="sourceLineNo">2506</span>        {<a name="line.2506"></a>
<span class="sourceLineNo">2507</span>            for (int k1 = i; k1 &lt; j; ++k1)<a name="line.2507"></a>
<span class="sourceLineNo">2508</span>            {<a name="line.2508"></a>
<span class="sourceLineNo">2509</span>                for (int l1 = k; l1 &lt; l; ++l1)<a name="line.2509"></a>
<span class="sourceLineNo">2510</span>                {<a name="line.2510"></a>
<span class="sourceLineNo">2511</span>                    for (int i2 = i1; i2 &lt; j1; ++i2)<a name="line.2511"></a>
<span class="sourceLineNo">2512</span>                    {<a name="line.2512"></a>
<span class="sourceLineNo">2513</span>                        int j2 = this.getBlockId(k1, l1, i2);<a name="line.2513"></a>
<span class="sourceLineNo">2514</span><a name="line.2514"></a>
<span class="sourceLineNo">2515</span>                        if (j2 == Block.fire.blockID || j2 == Block.lavaMoving.blockID || j2 == Block.lavaStill.blockID)<a name="line.2515"></a>
<span class="sourceLineNo">2516</span>                        {<a name="line.2516"></a>
<span class="sourceLineNo">2517</span>                            return true;<a name="line.2517"></a>
<span class="sourceLineNo">2518</span>                        }<a name="line.2518"></a>
<span class="sourceLineNo">2519</span>                        else<a name="line.2519"></a>
<span class="sourceLineNo">2520</span>                        {<a name="line.2520"></a>
<span class="sourceLineNo">2521</span>                            Block block = Block.blocksList[j2];<a name="line.2521"></a>
<span class="sourceLineNo">2522</span>                            if (block != null &amp;&amp; block.isBlockBurning(this, k1, l1, i2))<a name="line.2522"></a>
<span class="sourceLineNo">2523</span>                            {<a name="line.2523"></a>
<span class="sourceLineNo">2524</span>                                return true;<a name="line.2524"></a>
<span class="sourceLineNo">2525</span>                            }<a name="line.2525"></a>
<span class="sourceLineNo">2526</span>                        }<a name="line.2526"></a>
<span class="sourceLineNo">2527</span>                    }<a name="line.2527"></a>
<span class="sourceLineNo">2528</span>                }<a name="line.2528"></a>
<span class="sourceLineNo">2529</span>            }<a name="line.2529"></a>
<span class="sourceLineNo">2530</span>        }<a name="line.2530"></a>
<span class="sourceLineNo">2531</span><a name="line.2531"></a>
<span class="sourceLineNo">2532</span>        return false;<a name="line.2532"></a>
<span class="sourceLineNo">2533</span>    }<a name="line.2533"></a>
<span class="sourceLineNo">2534</span><a name="line.2534"></a>
<span class="sourceLineNo">2535</span>    /**<a name="line.2535"></a>
<span class="sourceLineNo">2536</span>     * handles the acceleration of an object whilst in water. Not sure if it is used elsewhere.<a name="line.2536"></a>
<span class="sourceLineNo">2537</span>     */<a name="line.2537"></a>
<span class="sourceLineNo">2538</span>    public boolean handleMaterialAcceleration(AxisAlignedBB par1AxisAlignedBB, Material par2Material, Entity par3Entity)<a name="line.2538"></a>
<span class="sourceLineNo">2539</span>    {<a name="line.2539"></a>
<span class="sourceLineNo">2540</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.2540"></a>
<span class="sourceLineNo">2541</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.2541"></a>
<span class="sourceLineNo">2542</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.2542"></a>
<span class="sourceLineNo">2543</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.2543"></a>
<span class="sourceLineNo">2544</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.2544"></a>
<span class="sourceLineNo">2545</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.2545"></a>
<span class="sourceLineNo">2546</span><a name="line.2546"></a>
<span class="sourceLineNo">2547</span>        if (!this.checkChunksExist(i, k, i1, j, l, j1))<a name="line.2547"></a>
<span class="sourceLineNo">2548</span>        {<a name="line.2548"></a>
<span class="sourceLineNo">2549</span>            return false;<a name="line.2549"></a>
<span class="sourceLineNo">2550</span>        }<a name="line.2550"></a>
<span class="sourceLineNo">2551</span>        else<a name="line.2551"></a>
<span class="sourceLineNo">2552</span>        {<a name="line.2552"></a>
<span class="sourceLineNo">2553</span>            boolean flag = false;<a name="line.2553"></a>
<span class="sourceLineNo">2554</span>            Vec3 vec3 = this.getWorldVec3Pool().getVecFromPool(0.0D, 0.0D, 0.0D);<a name="line.2554"></a>
<span class="sourceLineNo">2555</span><a name="line.2555"></a>
<span class="sourceLineNo">2556</span>            for (int k1 = i; k1 &lt; j; ++k1)<a name="line.2556"></a>
<span class="sourceLineNo">2557</span>            {<a name="line.2557"></a>
<span class="sourceLineNo">2558</span>                for (int l1 = k; l1 &lt; l; ++l1)<a name="line.2558"></a>
<span class="sourceLineNo">2559</span>                {<a name="line.2559"></a>
<span class="sourceLineNo">2560</span>                    for (int i2 = i1; i2 &lt; j1; ++i2)<a name="line.2560"></a>
<span class="sourceLineNo">2561</span>                    {<a name="line.2561"></a>
<span class="sourceLineNo">2562</span>                        Block block = Block.blocksList[this.getBlockId(k1, l1, i2)];<a name="line.2562"></a>
<span class="sourceLineNo">2563</span><a name="line.2563"></a>
<span class="sourceLineNo">2564</span>                        if (block != null &amp;&amp; block.blockMaterial == par2Material)<a name="line.2564"></a>
<span class="sourceLineNo">2565</span>                        {<a name="line.2565"></a>
<span class="sourceLineNo">2566</span>                            double d0 = (double)((float)(l1 + 1) - BlockFluid.getFluidHeightPercent(this.getBlockMetadata(k1, l1, i2)));<a name="line.2566"></a>
<span class="sourceLineNo">2567</span><a name="line.2567"></a>
<span class="sourceLineNo">2568</span>                            if ((double)l &gt;= d0)<a name="line.2568"></a>
<span class="sourceLineNo">2569</span>                            {<a name="line.2569"></a>
<span class="sourceLineNo">2570</span>                                flag = true;<a name="line.2570"></a>
<span class="sourceLineNo">2571</span>                                block.velocityToAddToEntity(this, k1, l1, i2, par3Entity, vec3);<a name="line.2571"></a>
<span class="sourceLineNo">2572</span>                            }<a name="line.2572"></a>
<span class="sourceLineNo">2573</span>                        }<a name="line.2573"></a>
<span class="sourceLineNo">2574</span>                    }<a name="line.2574"></a>
<span class="sourceLineNo">2575</span>                }<a name="line.2575"></a>
<span class="sourceLineNo">2576</span>            }<a name="line.2576"></a>
<span class="sourceLineNo">2577</span><a name="line.2577"></a>
<span class="sourceLineNo">2578</span>            if (vec3.lengthVector() &gt; 0.0D &amp;&amp; par3Entity.func_96092_aw())<a name="line.2578"></a>
<span class="sourceLineNo">2579</span>            {<a name="line.2579"></a>
<span class="sourceLineNo">2580</span>                vec3 = vec3.normalize();<a name="line.2580"></a>
<span class="sourceLineNo">2581</span>                double d1 = 0.014D;<a name="line.2581"></a>
<span class="sourceLineNo">2582</span>                par3Entity.motionX += vec3.xCoord * d1;<a name="line.2582"></a>
<span class="sourceLineNo">2583</span>                par3Entity.motionY += vec3.yCoord * d1;<a name="line.2583"></a>
<span class="sourceLineNo">2584</span>                par3Entity.motionZ += vec3.zCoord * d1;<a name="line.2584"></a>
<span class="sourceLineNo">2585</span>            }<a name="line.2585"></a>
<span class="sourceLineNo">2586</span><a name="line.2586"></a>
<span class="sourceLineNo">2587</span>            return flag;<a name="line.2587"></a>
<span class="sourceLineNo">2588</span>        }<a name="line.2588"></a>
<span class="sourceLineNo">2589</span>    }<a name="line.2589"></a>
<span class="sourceLineNo">2590</span><a name="line.2590"></a>
<span class="sourceLineNo">2591</span>    /**<a name="line.2591"></a>
<span class="sourceLineNo">2592</span>     * Returns true if the given bounding box contains the given material<a name="line.2592"></a>
<span class="sourceLineNo">2593</span>     */<a name="line.2593"></a>
<span class="sourceLineNo">2594</span>    public boolean isMaterialInBB(AxisAlignedBB par1AxisAlignedBB, Material par2Material)<a name="line.2594"></a>
<span class="sourceLineNo">2595</span>    {<a name="line.2595"></a>
<span class="sourceLineNo">2596</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.2596"></a>
<span class="sourceLineNo">2597</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.2597"></a>
<span class="sourceLineNo">2598</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.2598"></a>
<span class="sourceLineNo">2599</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.2599"></a>
<span class="sourceLineNo">2600</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.2600"></a>
<span class="sourceLineNo">2601</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.2601"></a>
<span class="sourceLineNo">2602</span><a name="line.2602"></a>
<span class="sourceLineNo">2603</span>        for (int k1 = i; k1 &lt; j; ++k1)<a name="line.2603"></a>
<span class="sourceLineNo">2604</span>        {<a name="line.2604"></a>
<span class="sourceLineNo">2605</span>            for (int l1 = k; l1 &lt; l; ++l1)<a name="line.2605"></a>
<span class="sourceLineNo">2606</span>            {<a name="line.2606"></a>
<span class="sourceLineNo">2607</span>                for (int i2 = i1; i2 &lt; j1; ++i2)<a name="line.2607"></a>
<span class="sourceLineNo">2608</span>                {<a name="line.2608"></a>
<span class="sourceLineNo">2609</span>                    Block block = Block.blocksList[this.getBlockId(k1, l1, i2)];<a name="line.2609"></a>
<span class="sourceLineNo">2610</span><a name="line.2610"></a>
<span class="sourceLineNo">2611</span>                    if (block != null &amp;&amp; block.blockMaterial == par2Material)<a name="line.2611"></a>
<span class="sourceLineNo">2612</span>                    {<a name="line.2612"></a>
<span class="sourceLineNo">2613</span>                        return true;<a name="line.2613"></a>
<span class="sourceLineNo">2614</span>                    }<a name="line.2614"></a>
<span class="sourceLineNo">2615</span>                }<a name="line.2615"></a>
<span class="sourceLineNo">2616</span>            }<a name="line.2616"></a>
<span class="sourceLineNo">2617</span>        }<a name="line.2617"></a>
<span class="sourceLineNo">2618</span><a name="line.2618"></a>
<span class="sourceLineNo">2619</span>        return false;<a name="line.2619"></a>
<span class="sourceLineNo">2620</span>    }<a name="line.2620"></a>
<span class="sourceLineNo">2621</span><a name="line.2621"></a>
<span class="sourceLineNo">2622</span>    /**<a name="line.2622"></a>
<span class="sourceLineNo">2623</span>     * checks if the given AABB is in the material given. Used while swimming.<a name="line.2623"></a>
<span class="sourceLineNo">2624</span>     */<a name="line.2624"></a>
<span class="sourceLineNo">2625</span>    public boolean isAABBInMaterial(AxisAlignedBB par1AxisAlignedBB, Material par2Material)<a name="line.2625"></a>
<span class="sourceLineNo">2626</span>    {<a name="line.2626"></a>
<span class="sourceLineNo">2627</span>        int i = MathHelper.floor_double(par1AxisAlignedBB.minX);<a name="line.2627"></a>
<span class="sourceLineNo">2628</span>        int j = MathHelper.floor_double(par1AxisAlignedBB.maxX + 1.0D);<a name="line.2628"></a>
<span class="sourceLineNo">2629</span>        int k = MathHelper.floor_double(par1AxisAlignedBB.minY);<a name="line.2629"></a>
<span class="sourceLineNo">2630</span>        int l = MathHelper.floor_double(par1AxisAlignedBB.maxY + 1.0D);<a name="line.2630"></a>
<span class="sourceLineNo">2631</span>        int i1 = MathHelper.floor_double(par1AxisAlignedBB.minZ);<a name="line.2631"></a>
<span class="sourceLineNo">2632</span>        int j1 = MathHelper.floor_double(par1AxisAlignedBB.maxZ + 1.0D);<a name="line.2632"></a>
<span class="sourceLineNo">2633</span><a name="line.2633"></a>
<span class="sourceLineNo">2634</span>        for (int k1 = i; k1 &lt; j; ++k1)<a name="line.2634"></a>
<span class="sourceLineNo">2635</span>        {<a name="line.2635"></a>
<span class="sourceLineNo">2636</span>            for (int l1 = k; l1 &lt; l; ++l1)<a name="line.2636"></a>
<span class="sourceLineNo">2637</span>            {<a name="line.2637"></a>
<span class="sourceLineNo">2638</span>                for (int i2 = i1; i2 &lt; j1; ++i2)<a name="line.2638"></a>
<span class="sourceLineNo">2639</span>                {<a name="line.2639"></a>
<span class="sourceLineNo">2640</span>                    Block block = Block.blocksList[this.getBlockId(k1, l1, i2)];<a name="line.2640"></a>
<span class="sourceLineNo">2641</span><a name="line.2641"></a>
<span class="sourceLineNo">2642</span>                    if (block != null &amp;&amp; block.blockMaterial == par2Material)<a name="line.2642"></a>
<span class="sourceLineNo">2643</span>                    {<a name="line.2643"></a>
<span class="sourceLineNo">2644</span>                        int j2 = this.getBlockMetadata(k1, l1, i2);<a name="line.2644"></a>
<span class="sourceLineNo">2645</span>                        double d0 = (double)(l1 + 1);<a name="line.2645"></a>
<span class="sourceLineNo">2646</span><a name="line.2646"></a>
<span class="sourceLineNo">2647</span>                        if (j2 &lt; 8)<a name="line.2647"></a>
<span class="sourceLineNo">2648</span>                        {<a name="line.2648"></a>
<span class="sourceLineNo">2649</span>                            d0 = (double)(l1 + 1) - (double)j2 / 8.0D;<a name="line.2649"></a>
<span class="sourceLineNo">2650</span>                        }<a name="line.2650"></a>
<span class="sourceLineNo">2651</span><a name="line.2651"></a>
<span class="sourceLineNo">2652</span>                        if (d0 &gt;= par1AxisAlignedBB.minY)<a name="line.2652"></a>
<span class="sourceLineNo">2653</span>                        {<a name="line.2653"></a>
<span class="sourceLineNo">2654</span>                            return true;<a name="line.2654"></a>
<span class="sourceLineNo">2655</span>                        }<a name="line.2655"></a>
<span class="sourceLineNo">2656</span>                    }<a name="line.2656"></a>
<span class="sourceLineNo">2657</span>                }<a name="line.2657"></a>
<span class="sourceLineNo">2658</span>            }<a name="line.2658"></a>
<span class="sourceLineNo">2659</span>        }<a name="line.2659"></a>
<span class="sourceLineNo">2660</span><a name="line.2660"></a>
<span class="sourceLineNo">2661</span>        return false;<a name="line.2661"></a>
<span class="sourceLineNo">2662</span>    }<a name="line.2662"></a>
<span class="sourceLineNo">2663</span><a name="line.2663"></a>
<span class="sourceLineNo">2664</span>    /**<a name="line.2664"></a>
<span class="sourceLineNo">2665</span>     * Creates an explosion. Args: entity, x, y, z, strength<a name="line.2665"></a>
<span class="sourceLineNo">2666</span>     */<a name="line.2666"></a>
<span class="sourceLineNo">2667</span>    public Explosion createExplosion(Entity par1Entity, double par2, double par4, double par6, float par8, boolean par9)<a name="line.2667"></a>
<span class="sourceLineNo">2668</span>    {<a name="line.2668"></a>
<span class="sourceLineNo">2669</span>        return this.newExplosion(par1Entity, par2, par4, par6, par8, false, par9);<a name="line.2669"></a>
<span class="sourceLineNo">2670</span>    }<a name="line.2670"></a>
<span class="sourceLineNo">2671</span><a name="line.2671"></a>
<span class="sourceLineNo">2672</span>    /**<a name="line.2672"></a>
<span class="sourceLineNo">2673</span>     * returns a new explosion. Does initiation (at time of writing Explosion is not finished)<a name="line.2673"></a>
<span class="sourceLineNo">2674</span>     */<a name="line.2674"></a>
<span class="sourceLineNo">2675</span>    public Explosion newExplosion(Entity par1Entity, double par2, double par4, double par6, float par8, boolean par9, boolean par10)<a name="line.2675"></a>
<span class="sourceLineNo">2676</span>    {<a name="line.2676"></a>
<span class="sourceLineNo">2677</span>        Explosion explosion = new Explosion(this, par1Entity, par2, par4, par6, par8);<a name="line.2677"></a>
<span class="sourceLineNo">2678</span>        explosion.isFlaming = par9;<a name="line.2678"></a>
<span class="sourceLineNo">2679</span>        explosion.isSmoking = par10;<a name="line.2679"></a>
<span class="sourceLineNo">2680</span>        explosion.doExplosionA();<a name="line.2680"></a>
<span class="sourceLineNo">2681</span>        explosion.doExplosionB(true);<a name="line.2681"></a>
<span class="sourceLineNo">2682</span>        return explosion;<a name="line.2682"></a>
<span class="sourceLineNo">2683</span>    }<a name="line.2683"></a>
<span class="sourceLineNo">2684</span><a name="line.2684"></a>
<span class="sourceLineNo">2685</span>    /**<a name="line.2685"></a>
<span class="sourceLineNo">2686</span>     * Gets the percentage of real blocks within within a bounding box, along a specified vector.<a name="line.2686"></a>
<span class="sourceLineNo">2687</span>     */<a name="line.2687"></a>
<span class="sourceLineNo">2688</span>    public float getBlockDensity(Vec3 par1Vec3, AxisAlignedBB par2AxisAlignedBB)<a name="line.2688"></a>
<span class="sourceLineNo">2689</span>    {<a name="line.2689"></a>
<span class="sourceLineNo">2690</span>        double d0 = 1.0D / ((par2AxisAlignedBB.maxX - par2AxisAlignedBB.minX) * 2.0D + 1.0D);<a name="line.2690"></a>
<span class="sourceLineNo">2691</span>        double d1 = 1.0D / ((par2AxisAlignedBB.maxY - par2AxisAlignedBB.minY) * 2.0D + 1.0D);<a name="line.2691"></a>
<span class="sourceLineNo">2692</span>        double d2 = 1.0D / ((par2AxisAlignedBB.maxZ - par2AxisAlignedBB.minZ) * 2.0D + 1.0D);<a name="line.2692"></a>
<span class="sourceLineNo">2693</span>        int i = 0;<a name="line.2693"></a>
<span class="sourceLineNo">2694</span>        int j = 0;<a name="line.2694"></a>
<span class="sourceLineNo">2695</span><a name="line.2695"></a>
<span class="sourceLineNo">2696</span>        for (float f = 0.0F; f &lt;= 1.0F; f = (float)((double)f + d0))<a name="line.2696"></a>
<span class="sourceLineNo">2697</span>        {<a name="line.2697"></a>
<span class="sourceLineNo">2698</span>            for (float f1 = 0.0F; f1 &lt;= 1.0F; f1 = (float)((double)f1 + d1))<a name="line.2698"></a>
<span class="sourceLineNo">2699</span>            {<a name="line.2699"></a>
<span class="sourceLineNo">2700</span>                for (float f2 = 0.0F; f2 &lt;= 1.0F; f2 = (float)((double)f2 + d2))<a name="line.2700"></a>
<span class="sourceLineNo">2701</span>                {<a name="line.2701"></a>
<span class="sourceLineNo">2702</span>                    double d3 = par2AxisAlignedBB.minX + (par2AxisAlignedBB.maxX - par2AxisAlignedBB.minX) * (double)f;<a name="line.2702"></a>
<span class="sourceLineNo">2703</span>                    double d4 = par2AxisAlignedBB.minY + (par2AxisAlignedBB.maxY - par2AxisAlignedBB.minY) * (double)f1;<a name="line.2703"></a>
<span class="sourceLineNo">2704</span>                    double d5 = par2AxisAlignedBB.minZ + (par2AxisAlignedBB.maxZ - par2AxisAlignedBB.minZ) * (double)f2;<a name="line.2704"></a>
<span class="sourceLineNo">2705</span><a name="line.2705"></a>
<span class="sourceLineNo">2706</span>                    if (this.rayTraceBlocks(this.getWorldVec3Pool().getVecFromPool(d3, d4, d5), par1Vec3) == null)<a name="line.2706"></a>
<span class="sourceLineNo">2707</span>                    {<a name="line.2707"></a>
<span class="sourceLineNo">2708</span>                        ++i;<a name="line.2708"></a>
<span class="sourceLineNo">2709</span>                    }<a name="line.2709"></a>
<span class="sourceLineNo">2710</span><a name="line.2710"></a>
<span class="sourceLineNo">2711</span>                    ++j;<a name="line.2711"></a>
<span class="sourceLineNo">2712</span>                }<a name="line.2712"></a>
<span class="sourceLineNo">2713</span>            }<a name="line.2713"></a>
<span class="sourceLineNo">2714</span>        }<a name="line.2714"></a>
<span class="sourceLineNo">2715</span><a name="line.2715"></a>
<span class="sourceLineNo">2716</span>        return (float)i / (float)j;<a name="line.2716"></a>
<span class="sourceLineNo">2717</span>    }<a name="line.2717"></a>
<span class="sourceLineNo">2718</span><a name="line.2718"></a>
<span class="sourceLineNo">2719</span>    /**<a name="line.2719"></a>
<span class="sourceLineNo">2720</span>     * If the block in the given direction of the given coordinate is fire, extinguish it. Args: Player, X,Y,Z,<a name="line.2720"></a>
<span class="sourceLineNo">2721</span>     * blockDirection<a name="line.2721"></a>
<span class="sourceLineNo">2722</span>     */<a name="line.2722"></a>
<span class="sourceLineNo">2723</span>    public boolean extinguishFire(EntityPlayer par1EntityPlayer, int par2, int par3, int par4, int par5)<a name="line.2723"></a>
<span class="sourceLineNo">2724</span>    {<a name="line.2724"></a>
<span class="sourceLineNo">2725</span>        if (par5 == 0)<a name="line.2725"></a>
<span class="sourceLineNo">2726</span>        {<a name="line.2726"></a>
<span class="sourceLineNo">2727</span>            --par3;<a name="line.2727"></a>
<span class="sourceLineNo">2728</span>        }<a name="line.2728"></a>
<span class="sourceLineNo">2729</span><a name="line.2729"></a>
<span class="sourceLineNo">2730</span>        if (par5 == 1)<a name="line.2730"></a>
<span class="sourceLineNo">2731</span>        {<a name="line.2731"></a>
<span class="sourceLineNo">2732</span>            ++par3;<a name="line.2732"></a>
<span class="sourceLineNo">2733</span>        }<a name="line.2733"></a>
<span class="sourceLineNo">2734</span><a name="line.2734"></a>
<span class="sourceLineNo">2735</span>        if (par5 == 2)<a name="line.2735"></a>
<span class="sourceLineNo">2736</span>        {<a name="line.2736"></a>
<span class="sourceLineNo">2737</span>            --par4;<a name="line.2737"></a>
<span class="sourceLineNo">2738</span>        }<a name="line.2738"></a>
<span class="sourceLineNo">2739</span><a name="line.2739"></a>
<span class="sourceLineNo">2740</span>        if (par5 == 3)<a name="line.2740"></a>
<span class="sourceLineNo">2741</span>        {<a name="line.2741"></a>
<span class="sourceLineNo">2742</span>            ++par4;<a name="line.2742"></a>
<span class="sourceLineNo">2743</span>        }<a name="line.2743"></a>
<span class="sourceLineNo">2744</span><a name="line.2744"></a>
<span class="sourceLineNo">2745</span>        if (par5 == 4)<a name="line.2745"></a>
<span class="sourceLineNo">2746</span>        {<a name="line.2746"></a>
<span class="sourceLineNo">2747</span>            --par2;<a name="line.2747"></a>
<span class="sourceLineNo">2748</span>        }<a name="line.2748"></a>
<span class="sourceLineNo">2749</span><a name="line.2749"></a>
<span class="sourceLineNo">2750</span>        if (par5 == 5)<a name="line.2750"></a>
<span class="sourceLineNo">2751</span>        {<a name="line.2751"></a>
<span class="sourceLineNo">2752</span>            ++par2;<a name="line.2752"></a>
<span class="sourceLineNo">2753</span>        }<a name="line.2753"></a>
<span class="sourceLineNo">2754</span><a name="line.2754"></a>
<span class="sourceLineNo">2755</span>        if (this.getBlockId(par2, par3, par4) == Block.fire.blockID)<a name="line.2755"></a>
<span class="sourceLineNo">2756</span>        {<a name="line.2756"></a>
<span class="sourceLineNo">2757</span>            this.playAuxSFXAtEntity(par1EntityPlayer, 1004, par2, par3, par4, 0);<a name="line.2757"></a>
<span class="sourceLineNo">2758</span>            this.func_94571_i(par2, par3, par4);<a name="line.2758"></a>
<span class="sourceLineNo">2759</span>            return true;<a name="line.2759"></a>
<span class="sourceLineNo">2760</span>        }<a name="line.2760"></a>
<span class="sourceLineNo">2761</span>        else<a name="line.2761"></a>
<span class="sourceLineNo">2762</span>        {<a name="line.2762"></a>
<span class="sourceLineNo">2763</span>            return false;<a name="line.2763"></a>
<span class="sourceLineNo">2764</span>        }<a name="line.2764"></a>
<span class="sourceLineNo">2765</span>    }<a name="line.2765"></a>
<span class="sourceLineNo">2766</span><a name="line.2766"></a>
<span class="sourceLineNo">2767</span>    @SideOnly(Side.CLIENT)<a name="line.2767"></a>
<span class="sourceLineNo">2768</span><a name="line.2768"></a>
<span class="sourceLineNo">2769</span>    /**<a name="line.2769"></a>
<span class="sourceLineNo">2770</span>     * This string is 'All: (number of loaded entities)' Viewable by press ing F3<a name="line.2770"></a>
<span class="sourceLineNo">2771</span>     */<a name="line.2771"></a>
<span class="sourceLineNo">2772</span>    public String getDebugLoadedEntities()<a name="line.2772"></a>
<span class="sourceLineNo">2773</span>    {<a name="line.2773"></a>
<span class="sourceLineNo">2774</span>        return "All: " + this.loadedEntityList.size();<a name="line.2774"></a>
<span class="sourceLineNo">2775</span>    }<a name="line.2775"></a>
<span class="sourceLineNo">2776</span><a name="line.2776"></a>
<span class="sourceLineNo">2777</span>    @SideOnly(Side.CLIENT)<a name="line.2777"></a>
<span class="sourceLineNo">2778</span><a name="line.2778"></a>
<span class="sourceLineNo">2779</span>    /**<a name="line.2779"></a>
<span class="sourceLineNo">2780</span>     * Returns the name of the current chunk provider, by calling chunkprovider.makeString()<a name="line.2780"></a>
<span class="sourceLineNo">2781</span>     */<a name="line.2781"></a>
<span class="sourceLineNo">2782</span>    public String getProviderName()<a name="line.2782"></a>
<span class="sourceLineNo">2783</span>    {<a name="line.2783"></a>
<span class="sourceLineNo">2784</span>        return this.chunkProvider.makeString();<a name="line.2784"></a>
<span class="sourceLineNo">2785</span>    }<a name="line.2785"></a>
<span class="sourceLineNo">2786</span><a name="line.2786"></a>
<span class="sourceLineNo">2787</span>    /**<a name="line.2787"></a>
<span class="sourceLineNo">2788</span>     * Returns the TileEntity associated with a given block in X,Y,Z coordinates, or null if no TileEntity exists<a name="line.2788"></a>
<span class="sourceLineNo">2789</span>     */<a name="line.2789"></a>
<span class="sourceLineNo">2790</span>    public TileEntity getBlockTileEntity(int par1, int par2, int par3)<a name="line.2790"></a>
<span class="sourceLineNo">2791</span>    {<a name="line.2791"></a>
<span class="sourceLineNo">2792</span>        if (par2 &gt;= 0 &amp;&amp; par2 &lt; 256)<a name="line.2792"></a>
<span class="sourceLineNo">2793</span>        {<a name="line.2793"></a>
<span class="sourceLineNo">2794</span>            TileEntity tileentity = null;<a name="line.2794"></a>
<span class="sourceLineNo">2795</span>            int l;<a name="line.2795"></a>
<span class="sourceLineNo">2796</span>            TileEntity tileentity1;<a name="line.2796"></a>
<span class="sourceLineNo">2797</span><a name="line.2797"></a>
<span class="sourceLineNo">2798</span>            if (this.scanningTileEntities)<a name="line.2798"></a>
<span class="sourceLineNo">2799</span>            {<a name="line.2799"></a>
<span class="sourceLineNo">2800</span>                for (l = 0; l &lt; this.addedTileEntityList.size(); ++l)<a name="line.2800"></a>
<span class="sourceLineNo">2801</span>                {<a name="line.2801"></a>
<span class="sourceLineNo">2802</span>                    tileentity1 = (TileEntity)this.addedTileEntityList.get(l);<a name="line.2802"></a>
<span class="sourceLineNo">2803</span><a name="line.2803"></a>
<span class="sourceLineNo">2804</span>                    if (!tileentity1.isInvalid() &amp;&amp; tileentity1.xCoord == par1 &amp;&amp; tileentity1.yCoord == par2 &amp;&amp; tileentity1.zCoord == par3)<a name="line.2804"></a>
<span class="sourceLineNo">2805</span>                    {<a name="line.2805"></a>
<span class="sourceLineNo">2806</span>                        tileentity = tileentity1;<a name="line.2806"></a>
<span class="sourceLineNo">2807</span>                        break;<a name="line.2807"></a>
<span class="sourceLineNo">2808</span>                    }<a name="line.2808"></a>
<span class="sourceLineNo">2809</span>                }<a name="line.2809"></a>
<span class="sourceLineNo">2810</span>            }<a name="line.2810"></a>
<span class="sourceLineNo">2811</span><a name="line.2811"></a>
<span class="sourceLineNo">2812</span>            if (tileentity == null)<a name="line.2812"></a>
<span class="sourceLineNo">2813</span>            {<a name="line.2813"></a>
<span class="sourceLineNo">2814</span>                Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.2814"></a>
<span class="sourceLineNo">2815</span><a name="line.2815"></a>
<span class="sourceLineNo">2816</span>                if (chunk != null)<a name="line.2816"></a>
<span class="sourceLineNo">2817</span>                {<a name="line.2817"></a>
<span class="sourceLineNo">2818</span>                    tileentity = chunk.getChunkBlockTileEntity(par1 &amp; 15, par2, par3 &amp; 15);<a name="line.2818"></a>
<span class="sourceLineNo">2819</span>                }<a name="line.2819"></a>
<span class="sourceLineNo">2820</span>            }<a name="line.2820"></a>
<span class="sourceLineNo">2821</span><a name="line.2821"></a>
<span class="sourceLineNo">2822</span>            if (tileentity == null)<a name="line.2822"></a>
<span class="sourceLineNo">2823</span>            {<a name="line.2823"></a>
<span class="sourceLineNo">2824</span>                for (l = 0; l &lt; this.addedTileEntityList.size(); ++l)<a name="line.2824"></a>
<span class="sourceLineNo">2825</span>                {<a name="line.2825"></a>
<span class="sourceLineNo">2826</span>                    tileentity1 = (TileEntity)this.addedTileEntityList.get(l);<a name="line.2826"></a>
<span class="sourceLineNo">2827</span><a name="line.2827"></a>
<span class="sourceLineNo">2828</span>                    if (!tileentity1.isInvalid() &amp;&amp; tileentity1.xCoord == par1 &amp;&amp; tileentity1.yCoord == par2 &amp;&amp; tileentity1.zCoord == par3)<a name="line.2828"></a>
<span class="sourceLineNo">2829</span>                    {<a name="line.2829"></a>
<span class="sourceLineNo">2830</span>                        tileentity = tileentity1;<a name="line.2830"></a>
<span class="sourceLineNo">2831</span>                        break;<a name="line.2831"></a>
<span class="sourceLineNo">2832</span>                    }<a name="line.2832"></a>
<span class="sourceLineNo">2833</span>                }<a name="line.2833"></a>
<span class="sourceLineNo">2834</span>            }<a name="line.2834"></a>
<span class="sourceLineNo">2835</span><a name="line.2835"></a>
<span class="sourceLineNo">2836</span>            return tileentity;<a name="line.2836"></a>
<span class="sourceLineNo">2837</span>        }<a name="line.2837"></a>
<span class="sourceLineNo">2838</span>        else<a name="line.2838"></a>
<span class="sourceLineNo">2839</span>        {<a name="line.2839"></a>
<span class="sourceLineNo">2840</span>            return null;<a name="line.2840"></a>
<span class="sourceLineNo">2841</span>        }<a name="line.2841"></a>
<span class="sourceLineNo">2842</span>    }<a name="line.2842"></a>
<span class="sourceLineNo">2843</span><a name="line.2843"></a>
<span class="sourceLineNo">2844</span>    /**<a name="line.2844"></a>
<span class="sourceLineNo">2845</span>     * Sets the TileEntity for a given block in X, Y, Z coordinates<a name="line.2845"></a>
<span class="sourceLineNo">2846</span>     */<a name="line.2846"></a>
<span class="sourceLineNo">2847</span>    public void setBlockTileEntity(int par1, int par2, int par3, TileEntity par4TileEntity)<a name="line.2847"></a>
<span class="sourceLineNo">2848</span>    {<a name="line.2848"></a>
<span class="sourceLineNo">2849</span>        if (par4TileEntity == null || par4TileEntity.isInvalid())<a name="line.2849"></a>
<span class="sourceLineNo">2850</span>        {<a name="line.2850"></a>
<span class="sourceLineNo">2851</span>            return;<a name="line.2851"></a>
<span class="sourceLineNo">2852</span>        }<a name="line.2852"></a>
<span class="sourceLineNo">2853</span><a name="line.2853"></a>
<span class="sourceLineNo">2854</span>        if (par4TileEntity.canUpdate())<a name="line.2854"></a>
<span class="sourceLineNo">2855</span>        {<a name="line.2855"></a>
<span class="sourceLineNo">2856</span>            if (scanningTileEntities)<a name="line.2856"></a>
<span class="sourceLineNo">2857</span>            {<a name="line.2857"></a>
<span class="sourceLineNo">2858</span>                Iterator iterator = addedTileEntityList.iterator();<a name="line.2858"></a>
<span class="sourceLineNo">2859</span>                while (iterator.hasNext())<a name="line.2859"></a>
<span class="sourceLineNo">2860</span>                {<a name="line.2860"></a>
<span class="sourceLineNo">2861</span>                    TileEntity tileentity1 = (TileEntity)iterator.next();<a name="line.2861"></a>
<span class="sourceLineNo">2862</span>    <a name="line.2862"></a>
<span class="sourceLineNo">2863</span>                    if (tileentity1.xCoord == par1 &amp;&amp; tileentity1.yCoord == par2 &amp;&amp; tileentity1.zCoord == par3)<a name="line.2863"></a>
<span class="sourceLineNo">2864</span>                    {<a name="line.2864"></a>
<span class="sourceLineNo">2865</span>                        tileentity1.invalidate();<a name="line.2865"></a>
<span class="sourceLineNo">2866</span>                        iterator.remove();<a name="line.2866"></a>
<span class="sourceLineNo">2867</span>                    }<a name="line.2867"></a>
<span class="sourceLineNo">2868</span>                }<a name="line.2868"></a>
<span class="sourceLineNo">2869</span>                addedTileEntityList.add(par4TileEntity);<a name="line.2869"></a>
<span class="sourceLineNo">2870</span>            }<a name="line.2870"></a>
<span class="sourceLineNo">2871</span>            else<a name="line.2871"></a>
<span class="sourceLineNo">2872</span>            {<a name="line.2872"></a>
<span class="sourceLineNo">2873</span>                loadedTileEntityList.add(par4TileEntity);<a name="line.2873"></a>
<span class="sourceLineNo">2874</span>            }<a name="line.2874"></a>
<span class="sourceLineNo">2875</span>        }<a name="line.2875"></a>
<span class="sourceLineNo">2876</span><a name="line.2876"></a>
<span class="sourceLineNo">2877</span>        Chunk chunk = this.getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.2877"></a>
<span class="sourceLineNo">2878</span>        if (chunk != null)<a name="line.2878"></a>
<span class="sourceLineNo">2879</span>        {<a name="line.2879"></a>
<span class="sourceLineNo">2880</span>            chunk.setChunkBlockTileEntity(par1 &amp; 15, par2, par3 &amp; 15, par4TileEntity);<a name="line.2880"></a>
<span class="sourceLineNo">2881</span>        }<a name="line.2881"></a>
<span class="sourceLineNo">2882</span>    }<a name="line.2882"></a>
<span class="sourceLineNo">2883</span><a name="line.2883"></a>
<span class="sourceLineNo">2884</span>    /**<a name="line.2884"></a>
<span class="sourceLineNo">2885</span>     * Removes the TileEntity for a given block in X,Y,Z coordinates<a name="line.2885"></a>
<span class="sourceLineNo">2886</span>     */<a name="line.2886"></a>
<span class="sourceLineNo">2887</span>    public void removeBlockTileEntity(int par1, int par2, int par3)<a name="line.2887"></a>
<span class="sourceLineNo">2888</span>    {<a name="line.2888"></a>
<span class="sourceLineNo">2889</span>        Chunk chunk = getChunkFromChunkCoords(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.2889"></a>
<span class="sourceLineNo">2890</span>        if (chunk != null)<a name="line.2890"></a>
<span class="sourceLineNo">2891</span>        {<a name="line.2891"></a>
<span class="sourceLineNo">2892</span>            chunk.removeChunkBlockTileEntity(par1 &amp; 15, par2, par3 &amp; 15);<a name="line.2892"></a>
<span class="sourceLineNo">2893</span>        }<a name="line.2893"></a>
<span class="sourceLineNo">2894</span>    }<a name="line.2894"></a>
<span class="sourceLineNo">2895</span><a name="line.2895"></a>
<span class="sourceLineNo">2896</span>    /**<a name="line.2896"></a>
<span class="sourceLineNo">2897</span>     * adds tile entity to despawn list (renamed from markEntityForDespawn)<a name="line.2897"></a>
<span class="sourceLineNo">2898</span>     */<a name="line.2898"></a>
<span class="sourceLineNo">2899</span>    public void markTileEntityForDespawn(TileEntity par1TileEntity)<a name="line.2899"></a>
<span class="sourceLineNo">2900</span>    {<a name="line.2900"></a>
<span class="sourceLineNo">2901</span>        this.entityRemoval.add(par1TileEntity);<a name="line.2901"></a>
<span class="sourceLineNo">2902</span>    }<a name="line.2902"></a>
<span class="sourceLineNo">2903</span><a name="line.2903"></a>
<span class="sourceLineNo">2904</span>    /**<a name="line.2904"></a>
<span class="sourceLineNo">2905</span>     * Returns true if the block at the specified coordinates is an opaque cube. Args: x, y, z<a name="line.2905"></a>
<span class="sourceLineNo">2906</span>     */<a name="line.2906"></a>
<span class="sourceLineNo">2907</span>    public boolean isBlockOpaqueCube(int par1, int par2, int par3)<a name="line.2907"></a>
<span class="sourceLineNo">2908</span>    {<a name="line.2908"></a>
<span class="sourceLineNo">2909</span>        Block block = Block.blocksList[this.getBlockId(par1, par2, par3)];<a name="line.2909"></a>
<span class="sourceLineNo">2910</span>        return block == null ? false : block.isOpaqueCube();<a name="line.2910"></a>
<span class="sourceLineNo">2911</span>    }<a name="line.2911"></a>
<span class="sourceLineNo">2912</span><a name="line.2912"></a>
<span class="sourceLineNo">2913</span>    /**<a name="line.2913"></a>
<span class="sourceLineNo">2914</span>     * Indicate if a material is a normal solid opaque cube.<a name="line.2914"></a>
<span class="sourceLineNo">2915</span>     */<a name="line.2915"></a>
<span class="sourceLineNo">2916</span>    public boolean isBlockNormalCube(int par1, int par2, int par3)<a name="line.2916"></a>
<span class="sourceLineNo">2917</span>    {<a name="line.2917"></a>
<span class="sourceLineNo">2918</span>        Block block = Block.blocksList[getBlockId(par1, par2, par3)];<a name="line.2918"></a>
<span class="sourceLineNo">2919</span>        return block != null &amp;&amp; block.isBlockNormalCube(this, par1, par2, par3);<a name="line.2919"></a>
<span class="sourceLineNo">2920</span>    }<a name="line.2920"></a>
<span class="sourceLineNo">2921</span><a name="line.2921"></a>
<span class="sourceLineNo">2922</span>    public boolean func_85174_u(int par1, int par2, int par3)<a name="line.2922"></a>
<span class="sourceLineNo">2923</span>    {<a name="line.2923"></a>
<span class="sourceLineNo">2924</span>        int l = this.getBlockId(par1, par2, par3);<a name="line.2924"></a>
<span class="sourceLineNo">2925</span><a name="line.2925"></a>
<span class="sourceLineNo">2926</span>        if (l != 0 &amp;&amp; Block.blocksList[l] != null)<a name="line.2926"></a>
<span class="sourceLineNo">2927</span>        {<a name="line.2927"></a>
<span class="sourceLineNo">2928</span>            AxisAlignedBB axisalignedbb = Block.blocksList[l].getCollisionBoundingBoxFromPool(this, par1, par2, par3);<a name="line.2928"></a>
<span class="sourceLineNo">2929</span>            return axisalignedbb != null &amp;&amp; axisalignedbb.getAverageEdgeLength() &gt;= 1.0D;<a name="line.2929"></a>
<span class="sourceLineNo">2930</span>        }<a name="line.2930"></a>
<span class="sourceLineNo">2931</span>        else<a name="line.2931"></a>
<span class="sourceLineNo">2932</span>        {<a name="line.2932"></a>
<span class="sourceLineNo">2933</span>            return false;<a name="line.2933"></a>
<span class="sourceLineNo">2934</span>        }<a name="line.2934"></a>
<span class="sourceLineNo">2935</span>    }<a name="line.2935"></a>
<span class="sourceLineNo">2936</span><a name="line.2936"></a>
<span class="sourceLineNo">2937</span>    /**<a name="line.2937"></a>
<span class="sourceLineNo">2938</span>     * Returns true if the block at the given coordinate has a solid (buildable) top surface.<a name="line.2938"></a>
<span class="sourceLineNo">2939</span>     */<a name="line.2939"></a>
<span class="sourceLineNo">2940</span>    public boolean doesBlockHaveSolidTopSurface(int par1, int par2, int par3)<a name="line.2940"></a>
<span class="sourceLineNo">2941</span>    {<a name="line.2941"></a>
<span class="sourceLineNo">2942</span>        return isBlockSolidOnSide(par1, par2, par3, ForgeDirection.UP);<a name="line.2942"></a>
<span class="sourceLineNo">2943</span>    }<a name="line.2943"></a>
<span class="sourceLineNo">2944</span><a name="line.2944"></a>
<span class="sourceLineNo">2945</span>    /**<a name="line.2945"></a>
<span class="sourceLineNo">2946</span>     * Checks if the block is a solid, normal cube. If the chunk does not exist, or is not loaded, it returns the<a name="line.2946"></a>
<span class="sourceLineNo">2947</span>     * boolean parameter.<a name="line.2947"></a>
<span class="sourceLineNo">2948</span>     */<a name="line.2948"></a>
<span class="sourceLineNo">2949</span>    public boolean isBlockNormalCubeDefault(int par1, int par2, int par3, boolean par4)<a name="line.2949"></a>
<span class="sourceLineNo">2950</span>    {<a name="line.2950"></a>
<span class="sourceLineNo">2951</span>        if (par1 &gt;= -30000000 &amp;&amp; par3 &gt;= -30000000 &amp;&amp; par1 &lt; 30000000 &amp;&amp; par3 &lt; 30000000)<a name="line.2951"></a>
<span class="sourceLineNo">2952</span>        {<a name="line.2952"></a>
<span class="sourceLineNo">2953</span>            Chunk chunk = this.chunkProvider.provideChunk(par1 &gt;&gt; 4, par3 &gt;&gt; 4);<a name="line.2953"></a>
<span class="sourceLineNo">2954</span><a name="line.2954"></a>
<span class="sourceLineNo">2955</span>            if (chunk != null &amp;&amp; !chunk.isEmpty())<a name="line.2955"></a>
<span class="sourceLineNo">2956</span>            {<a name="line.2956"></a>
<span class="sourceLineNo">2957</span>                Block block = Block.blocksList[this.getBlockId(par1, par2, par3)];<a name="line.2957"></a>
<span class="sourceLineNo">2958</span>                return block == null ? false : isBlockNormalCube(par1, par2, par3);<a name="line.2958"></a>
<span class="sourceLineNo">2959</span>            }<a name="line.2959"></a>
<span class="sourceLineNo">2960</span>            else<a name="line.2960"></a>
<span class="sourceLineNo">2961</span>            {<a name="line.2961"></a>
<span class="sourceLineNo">2962</span>                return par4;<a name="line.2962"></a>
<span class="sourceLineNo">2963</span>            }<a name="line.2963"></a>
<span class="sourceLineNo">2964</span>        }<a name="line.2964"></a>
<span class="sourceLineNo">2965</span>        else<a name="line.2965"></a>
<span class="sourceLineNo">2966</span>        {<a name="line.2966"></a>
<span class="sourceLineNo">2967</span>            return par4;<a name="line.2967"></a>
<span class="sourceLineNo">2968</span>        }<a name="line.2968"></a>
<span class="sourceLineNo">2969</span>    }<a name="line.2969"></a>
<span class="sourceLineNo">2970</span><a name="line.2970"></a>
<span class="sourceLineNo">2971</span>    /**<a name="line.2971"></a>
<span class="sourceLineNo">2972</span>     * Called on construction of the World class to setup the initial skylight values<a name="line.2972"></a>
<span class="sourceLineNo">2973</span>     */<a name="line.2973"></a>
<span class="sourceLineNo">2974</span>    public void calculateInitialSkylight()<a name="line.2974"></a>
<span class="sourceLineNo">2975</span>    {<a name="line.2975"></a>
<span class="sourceLineNo">2976</span>        int i = this.calculateSkylightSubtracted(1.0F);<a name="line.2976"></a>
<span class="sourceLineNo">2977</span><a name="line.2977"></a>
<span class="sourceLineNo">2978</span>        if (i != this.skylightSubtracted)<a name="line.2978"></a>
<span class="sourceLineNo">2979</span>        {<a name="line.2979"></a>
<span class="sourceLineNo">2980</span>            this.skylightSubtracted = i;<a name="line.2980"></a>
<span class="sourceLineNo">2981</span>        }<a name="line.2981"></a>
<span class="sourceLineNo">2982</span>    }<a name="line.2982"></a>
<span class="sourceLineNo">2983</span><a name="line.2983"></a>
<span class="sourceLineNo">2984</span>    /**<a name="line.2984"></a>
<span class="sourceLineNo">2985</span>     * Set which types of mobs are allowed to spawn (peaceful vs hostile).<a name="line.2985"></a>
<span class="sourceLineNo">2986</span>     */<a name="line.2986"></a>
<span class="sourceLineNo">2987</span>    public void setAllowedSpawnTypes(boolean par1, boolean par2)<a name="line.2987"></a>
<span class="sourceLineNo">2988</span>    {<a name="line.2988"></a>
<span class="sourceLineNo">2989</span>        provider.setAllowedSpawnTypes(par1, par2);<a name="line.2989"></a>
<span class="sourceLineNo">2990</span>    }<a name="line.2990"></a>
<span class="sourceLineNo">2991</span><a name="line.2991"></a>
<span class="sourceLineNo">2992</span>    /**<a name="line.2992"></a>
<span class="sourceLineNo">2993</span>     * Runs a single tick for the world<a name="line.2993"></a>
<span class="sourceLineNo">2994</span>     */<a name="line.2994"></a>
<span class="sourceLineNo">2995</span>    public void tick()<a name="line.2995"></a>
<span class="sourceLineNo">2996</span>    {<a name="line.2996"></a>
<span class="sourceLineNo">2997</span>        this.updateWeather();<a name="line.2997"></a>
<span class="sourceLineNo">2998</span>    }<a name="line.2998"></a>
<span class="sourceLineNo">2999</span><a name="line.2999"></a>
<span class="sourceLineNo">3000</span>    /**<a name="line.3000"></a>
<span class="sourceLineNo">3001</span>     * Called from World constructor to set rainingStrength and thunderingStrength<a name="line.3001"></a>
<span class="sourceLineNo">3002</span>     */<a name="line.3002"></a>
<span class="sourceLineNo">3003</span>    private void calculateInitialWeather()<a name="line.3003"></a>
<span class="sourceLineNo">3004</span>    {<a name="line.3004"></a>
<span class="sourceLineNo">3005</span>        provider.calculateInitialWeather();<a name="line.3005"></a>
<span class="sourceLineNo">3006</span>    }<a name="line.3006"></a>
<span class="sourceLineNo">3007</span><a name="line.3007"></a>
<span class="sourceLineNo">3008</span>    public void calculateInitialWeatherBody()<a name="line.3008"></a>
<span class="sourceLineNo">3009</span>    {<a name="line.3009"></a>
<span class="sourceLineNo">3010</span>        if (this.worldInfo.isRaining())<a name="line.3010"></a>
<span class="sourceLineNo">3011</span>        {<a name="line.3011"></a>
<span class="sourceLineNo">3012</span>            this.rainingStrength = 1.0F;<a name="line.3012"></a>
<span class="sourceLineNo">3013</span><a name="line.3013"></a>
<span class="sourceLineNo">3014</span>            if (this.worldInfo.isThundering())<a name="line.3014"></a>
<span class="sourceLineNo">3015</span>            {<a name="line.3015"></a>
<span class="sourceLineNo">3016</span>                this.thunderingStrength = 1.0F;<a name="line.3016"></a>
<span class="sourceLineNo">3017</span>            }<a name="line.3017"></a>
<span class="sourceLineNo">3018</span>        }<a name="line.3018"></a>
<span class="sourceLineNo">3019</span>    }<a name="line.3019"></a>
<span class="sourceLineNo">3020</span><a name="line.3020"></a>
<span class="sourceLineNo">3021</span>    /**<a name="line.3021"></a>
<span class="sourceLineNo">3022</span>     * Updates all weather states.<a name="line.3022"></a>
<span class="sourceLineNo">3023</span>     */<a name="line.3023"></a>
<span class="sourceLineNo">3024</span>    protected void updateWeather()<a name="line.3024"></a>
<span class="sourceLineNo">3025</span>    {<a name="line.3025"></a>
<span class="sourceLineNo">3026</span>        provider.updateWeather();<a name="line.3026"></a>
<span class="sourceLineNo">3027</span>    }<a name="line.3027"></a>
<span class="sourceLineNo">3028</span><a name="line.3028"></a>
<span class="sourceLineNo">3029</span>    public void updateWeatherBody()<a name="line.3029"></a>
<span class="sourceLineNo">3030</span>    {<a name="line.3030"></a>
<span class="sourceLineNo">3031</span>        if (!this.provider.hasNoSky)<a name="line.3031"></a>
<span class="sourceLineNo">3032</span>        {<a name="line.3032"></a>
<span class="sourceLineNo">3033</span>            int i = this.worldInfo.getThunderTime();<a name="line.3033"></a>
<span class="sourceLineNo">3034</span><a name="line.3034"></a>
<span class="sourceLineNo">3035</span>            if (i &lt;= 0)<a name="line.3035"></a>
<span class="sourceLineNo">3036</span>            {<a name="line.3036"></a>
<span class="sourceLineNo">3037</span>                if (this.worldInfo.isThundering())<a name="line.3037"></a>
<span class="sourceLineNo">3038</span>                {<a name="line.3038"></a>
<span class="sourceLineNo">3039</span>                    this.worldInfo.setThunderTime(this.rand.nextInt(12000) + 3600);<a name="line.3039"></a>
<span class="sourceLineNo">3040</span>                }<a name="line.3040"></a>
<span class="sourceLineNo">3041</span>                else<a name="line.3041"></a>
<span class="sourceLineNo">3042</span>                {<a name="line.3042"></a>
<span class="sourceLineNo">3043</span>                    this.worldInfo.setThunderTime(this.rand.nextInt(168000) + 12000);<a name="line.3043"></a>
<span class="sourceLineNo">3044</span>                }<a name="line.3044"></a>
<span class="sourceLineNo">3045</span>            }<a name="line.3045"></a>
<span class="sourceLineNo">3046</span>            else<a name="line.3046"></a>
<span class="sourceLineNo">3047</span>            {<a name="line.3047"></a>
<span class="sourceLineNo">3048</span>                --i;<a name="line.3048"></a>
<span class="sourceLineNo">3049</span>                this.worldInfo.setThunderTime(i);<a name="line.3049"></a>
<span class="sourceLineNo">3050</span><a name="line.3050"></a>
<span class="sourceLineNo">3051</span>                if (i &lt;= 0)<a name="line.3051"></a>
<span class="sourceLineNo">3052</span>                {<a name="line.3052"></a>
<span class="sourceLineNo">3053</span>                    this.worldInfo.setThundering(!this.worldInfo.isThundering());<a name="line.3053"></a>
<span class="sourceLineNo">3054</span>                }<a name="line.3054"></a>
<span class="sourceLineNo">3055</span>            }<a name="line.3055"></a>
<span class="sourceLineNo">3056</span><a name="line.3056"></a>
<span class="sourceLineNo">3057</span>            int j = this.worldInfo.getRainTime();<a name="line.3057"></a>
<span class="sourceLineNo">3058</span><a name="line.3058"></a>
<span class="sourceLineNo">3059</span>            if (j &lt;= 0)<a name="line.3059"></a>
<span class="sourceLineNo">3060</span>            {<a name="line.3060"></a>
<span class="sourceLineNo">3061</span>                if (this.worldInfo.isRaining())<a name="line.3061"></a>
<span class="sourceLineNo">3062</span>                {<a name="line.3062"></a>
<span class="sourceLineNo">3063</span>                    this.worldInfo.setRainTime(this.rand.nextInt(12000) + 12000);<a name="line.3063"></a>
<span class="sourceLineNo">3064</span>                }<a name="line.3064"></a>
<span class="sourceLineNo">3065</span>                else<a name="line.3065"></a>
<span class="sourceLineNo">3066</span>                {<a name="line.3066"></a>
<span class="sourceLineNo">3067</span>                    this.worldInfo.setRainTime(this.rand.nextInt(168000) + 12000);<a name="line.3067"></a>
<span class="sourceLineNo">3068</span>                }<a name="line.3068"></a>
<span class="sourceLineNo">3069</span>            }<a name="line.3069"></a>
<span class="sourceLineNo">3070</span>            else<a name="line.3070"></a>
<span class="sourceLineNo">3071</span>            {<a name="line.3071"></a>
<span class="sourceLineNo">3072</span>                --j;<a name="line.3072"></a>
<span class="sourceLineNo">3073</span>                this.worldInfo.setRainTime(j);<a name="line.3073"></a>
<span class="sourceLineNo">3074</span><a name="line.3074"></a>
<span class="sourceLineNo">3075</span>                if (j &lt;= 0)<a name="line.3075"></a>
<span class="sourceLineNo">3076</span>                {<a name="line.3076"></a>
<span class="sourceLineNo">3077</span>                    this.worldInfo.setRaining(!this.worldInfo.isRaining());<a name="line.3077"></a>
<span class="sourceLineNo">3078</span>                }<a name="line.3078"></a>
<span class="sourceLineNo">3079</span>            }<a name="line.3079"></a>
<span class="sourceLineNo">3080</span><a name="line.3080"></a>
<span class="sourceLineNo">3081</span>            this.prevRainingStrength = this.rainingStrength;<a name="line.3081"></a>
<span class="sourceLineNo">3082</span><a name="line.3082"></a>
<span class="sourceLineNo">3083</span>            if (this.worldInfo.isRaining())<a name="line.3083"></a>
<span class="sourceLineNo">3084</span>            {<a name="line.3084"></a>
<span class="sourceLineNo">3085</span>                this.rainingStrength = (float)((double)this.rainingStrength + 0.01D);<a name="line.3085"></a>
<span class="sourceLineNo">3086</span>            }<a name="line.3086"></a>
<span class="sourceLineNo">3087</span>            else<a name="line.3087"></a>
<span class="sourceLineNo">3088</span>            {<a name="line.3088"></a>
<span class="sourceLineNo">3089</span>                this.rainingStrength = (float)((double)this.rainingStrength - 0.01D);<a name="line.3089"></a>
<span class="sourceLineNo">3090</span>            }<a name="line.3090"></a>
<span class="sourceLineNo">3091</span><a name="line.3091"></a>
<span class="sourceLineNo">3092</span>            if (this.rainingStrength &lt; 0.0F)<a name="line.3092"></a>
<span class="sourceLineNo">3093</span>            {<a name="line.3093"></a>
<span class="sourceLineNo">3094</span>                this.rainingStrength = 0.0F;<a name="line.3094"></a>
<span class="sourceLineNo">3095</span>            }<a name="line.3095"></a>
<span class="sourceLineNo">3096</span><a name="line.3096"></a>
<span class="sourceLineNo">3097</span>            if (this.rainingStrength &gt; 1.0F)<a name="line.3097"></a>
<span class="sourceLineNo">3098</span>            {<a name="line.3098"></a>
<span class="sourceLineNo">3099</span>                this.rainingStrength = 1.0F;<a name="line.3099"></a>
<span class="sourceLineNo">3100</span>            }<a name="line.3100"></a>
<span class="sourceLineNo">3101</span><a name="line.3101"></a>
<span class="sourceLineNo">3102</span>            this.prevThunderingStrength = this.thunderingStrength;<a name="line.3102"></a>
<span class="sourceLineNo">3103</span><a name="line.3103"></a>
<span class="sourceLineNo">3104</span>            if (this.worldInfo.isThundering())<a name="line.3104"></a>
<span class="sourceLineNo">3105</span>            {<a name="line.3105"></a>
<span class="sourceLineNo">3106</span>                this.thunderingStrength = (float)((double)this.thunderingStrength + 0.01D);<a name="line.3106"></a>
<span class="sourceLineNo">3107</span>            }<a name="line.3107"></a>
<span class="sourceLineNo">3108</span>            else<a name="line.3108"></a>
<span class="sourceLineNo">3109</span>            {<a name="line.3109"></a>
<span class="sourceLineNo">3110</span>                this.thunderingStrength = (float)((double)this.thunderingStrength - 0.01D);<a name="line.3110"></a>
<span class="sourceLineNo">3111</span>            }<a name="line.3111"></a>
<span class="sourceLineNo">3112</span><a name="line.3112"></a>
<span class="sourceLineNo">3113</span>            if (this.thunderingStrength &lt; 0.0F)<a name="line.3113"></a>
<span class="sourceLineNo">3114</span>            {<a name="line.3114"></a>
<span class="sourceLineNo">3115</span>                this.thunderingStrength = 0.0F;<a name="line.3115"></a>
<span class="sourceLineNo">3116</span>            }<a name="line.3116"></a>
<span class="sourceLineNo">3117</span><a name="line.3117"></a>
<span class="sourceLineNo">3118</span>            if (this.thunderingStrength &gt; 1.0F)<a name="line.3118"></a>
<span class="sourceLineNo">3119</span>            {<a name="line.3119"></a>
<span class="sourceLineNo">3120</span>                this.thunderingStrength = 1.0F;<a name="line.3120"></a>
<span class="sourceLineNo">3121</span>            }<a name="line.3121"></a>
<span class="sourceLineNo">3122</span>        }<a name="line.3122"></a>
<span class="sourceLineNo">3123</span>    }<a name="line.3123"></a>
<span class="sourceLineNo">3124</span><a name="line.3124"></a>
<span class="sourceLineNo">3125</span>    public void toggleRain()<a name="line.3125"></a>
<span class="sourceLineNo">3126</span>    {<a name="line.3126"></a>
<span class="sourceLineNo">3127</span>        provider.toggleRain();<a name="line.3127"></a>
<span class="sourceLineNo">3128</span>    }<a name="line.3128"></a>
<span class="sourceLineNo">3129</span><a name="line.3129"></a>
<span class="sourceLineNo">3130</span>    protected void setActivePlayerChunksAndCheckLight()<a name="line.3130"></a>
<span class="sourceLineNo">3131</span>    {<a name="line.3131"></a>
<span class="sourceLineNo">3132</span>        this.activeChunkSet.clear();<a name="line.3132"></a>
<span class="sourceLineNo">3133</span>        this.activeChunkSet.addAll(getPersistentChunks().keySet());<a name="line.3133"></a>
<span class="sourceLineNo">3134</span><a name="line.3134"></a>
<span class="sourceLineNo">3135</span>        this.theProfiler.startSection("buildList");<a name="line.3135"></a>
<span class="sourceLineNo">3136</span>        int i;<a name="line.3136"></a>
<span class="sourceLineNo">3137</span>        EntityPlayer entityplayer;<a name="line.3137"></a>
<span class="sourceLineNo">3138</span>        int j;<a name="line.3138"></a>
<span class="sourceLineNo">3139</span>        int k;<a name="line.3139"></a>
<span class="sourceLineNo">3140</span><a name="line.3140"></a>
<span class="sourceLineNo">3141</span>        for (i = 0; i &lt; this.playerEntities.size(); ++i)<a name="line.3141"></a>
<span class="sourceLineNo">3142</span>        {<a name="line.3142"></a>
<span class="sourceLineNo">3143</span>            entityplayer = (EntityPlayer)this.playerEntities.get(i);<a name="line.3143"></a>
<span class="sourceLineNo">3144</span>            j = MathHelper.floor_double(entityplayer.posX / 16.0D);<a name="line.3144"></a>
<span class="sourceLineNo">3145</span>            k = MathHelper.floor_double(entityplayer.posZ / 16.0D);<a name="line.3145"></a>
<span class="sourceLineNo">3146</span>            byte b0 = 7;<a name="line.3146"></a>
<span class="sourceLineNo">3147</span><a name="line.3147"></a>
<span class="sourceLineNo">3148</span>            for (int l = -b0; l &lt;= b0; ++l)<a name="line.3148"></a>
<span class="sourceLineNo">3149</span>            {<a name="line.3149"></a>
<span class="sourceLineNo">3150</span>                for (int i1 = -b0; i1 &lt;= b0; ++i1)<a name="line.3150"></a>
<span class="sourceLineNo">3151</span>                {<a name="line.3151"></a>
<span class="sourceLineNo">3152</span>                    this.activeChunkSet.add(new ChunkCoordIntPair(l + j, i1 + k));<a name="line.3152"></a>
<span class="sourceLineNo">3153</span>                }<a name="line.3153"></a>
<span class="sourceLineNo">3154</span>            }<a name="line.3154"></a>
<span class="sourceLineNo">3155</span>        }<a name="line.3155"></a>
<span class="sourceLineNo">3156</span><a name="line.3156"></a>
<span class="sourceLineNo">3157</span>        this.theProfiler.endSection();<a name="line.3157"></a>
<span class="sourceLineNo">3158</span><a name="line.3158"></a>
<span class="sourceLineNo">3159</span>        if (this.ambientTickCountdown &gt; 0)<a name="line.3159"></a>
<span class="sourceLineNo">3160</span>        {<a name="line.3160"></a>
<span class="sourceLineNo">3161</span>            --this.ambientTickCountdown;<a name="line.3161"></a>
<span class="sourceLineNo">3162</span>        }<a name="line.3162"></a>
<span class="sourceLineNo">3163</span><a name="line.3163"></a>
<span class="sourceLineNo">3164</span>        this.theProfiler.startSection("playerCheckLight");<a name="line.3164"></a>
<span class="sourceLineNo">3165</span><a name="line.3165"></a>
<span class="sourceLineNo">3166</span>        if (!this.playerEntities.isEmpty())<a name="line.3166"></a>
<span class="sourceLineNo">3167</span>        {<a name="line.3167"></a>
<span class="sourceLineNo">3168</span>            i = this.rand.nextInt(this.playerEntities.size());<a name="line.3168"></a>
<span class="sourceLineNo">3169</span>            entityplayer = (EntityPlayer)this.playerEntities.get(i);<a name="line.3169"></a>
<span class="sourceLineNo">3170</span>            j = MathHelper.floor_double(entityplayer.posX) + this.rand.nextInt(11) - 5;<a name="line.3170"></a>
<span class="sourceLineNo">3171</span>            k = MathHelper.floor_double(entityplayer.posY) + this.rand.nextInt(11) - 5;<a name="line.3171"></a>
<span class="sourceLineNo">3172</span>            int j1 = MathHelper.floor_double(entityplayer.posZ) + this.rand.nextInt(11) - 5;<a name="line.3172"></a>
<span class="sourceLineNo">3173</span>            this.updateAllLightTypes(j, k, j1);<a name="line.3173"></a>
<span class="sourceLineNo">3174</span>        }<a name="line.3174"></a>
<span class="sourceLineNo">3175</span><a name="line.3175"></a>
<span class="sourceLineNo">3176</span>        this.theProfiler.endSection();<a name="line.3176"></a>
<span class="sourceLineNo">3177</span>    }<a name="line.3177"></a>
<span class="sourceLineNo">3178</span><a name="line.3178"></a>
<span class="sourceLineNo">3179</span>    protected void moodSoundAndLightCheck(int par1, int par2, Chunk par3Chunk)<a name="line.3179"></a>
<span class="sourceLineNo">3180</span>    {<a name="line.3180"></a>
<span class="sourceLineNo">3181</span>        this.theProfiler.endStartSection("moodSound");<a name="line.3181"></a>
<span class="sourceLineNo">3182</span><a name="line.3182"></a>
<span class="sourceLineNo">3183</span>        if (this.ambientTickCountdown == 0 &amp;&amp; !this.isRemote)<a name="line.3183"></a>
<span class="sourceLineNo">3184</span>        {<a name="line.3184"></a>
<span class="sourceLineNo">3185</span>            this.updateLCG = this.updateLCG * 3 + 1013904223;<a name="line.3185"></a>
<span class="sourceLineNo">3186</span>            int k = this.updateLCG &gt;&gt; 2;<a name="line.3186"></a>
<span class="sourceLineNo">3187</span>            int l = k &amp; 15;<a name="line.3187"></a>
<span class="sourceLineNo">3188</span>            int i1 = k &gt;&gt; 8 &amp; 15;<a name="line.3188"></a>
<span class="sourceLineNo">3189</span>            int j1 = k &gt;&gt; 16 &amp; 127;<a name="line.3189"></a>
<span class="sourceLineNo">3190</span>            int k1 = par3Chunk.getBlockID(l, j1, i1);<a name="line.3190"></a>
<span class="sourceLineNo">3191</span>            l += par1;<a name="line.3191"></a>
<span class="sourceLineNo">3192</span>            i1 += par2;<a name="line.3192"></a>
<span class="sourceLineNo">3193</span><a name="line.3193"></a>
<span class="sourceLineNo">3194</span>            if (k1 == 0 &amp;&amp; this.getFullBlockLightValue(l, j1, i1) &lt;= this.rand.nextInt(8) &amp;&amp; this.getSavedLightValue(EnumSkyBlock.Sky, l, j1, i1) &lt;= 0)<a name="line.3194"></a>
<span class="sourceLineNo">3195</span>            {<a name="line.3195"></a>
<span class="sourceLineNo">3196</span>                EntityPlayer entityplayer = this.getClosestPlayer((double)l + 0.5D, (double)j1 + 0.5D, (double)i1 + 0.5D, 8.0D);<a name="line.3196"></a>
<span class="sourceLineNo">3197</span><a name="line.3197"></a>
<span class="sourceLineNo">3198</span>                if (entityplayer != null &amp;&amp; entityplayer.getDistanceSq((double)l + 0.5D, (double)j1 + 0.5D, (double)i1 + 0.5D) &gt; 4.0D)<a name="line.3198"></a>
<span class="sourceLineNo">3199</span>                {<a name="line.3199"></a>
<span class="sourceLineNo">3200</span>                    this.playSoundEffect((double)l + 0.5D, (double)j1 + 0.5D, (double)i1 + 0.5D, "ambient.cave.cave", 0.7F, 0.8F + this.rand.nextFloat() * 0.2F);<a name="line.3200"></a>
<span class="sourceLineNo">3201</span>                    this.ambientTickCountdown = this.rand.nextInt(12000) + 6000;<a name="line.3201"></a>
<span class="sourceLineNo">3202</span>                }<a name="line.3202"></a>
<span class="sourceLineNo">3203</span>            }<a name="line.3203"></a>
<span class="sourceLineNo">3204</span>        }<a name="line.3204"></a>
<span class="sourceLineNo">3205</span><a name="line.3205"></a>
<span class="sourceLineNo">3206</span>        this.theProfiler.endStartSection("checkLight");<a name="line.3206"></a>
<span class="sourceLineNo">3207</span>        par3Chunk.enqueueRelightChecks();<a name="line.3207"></a>
<span class="sourceLineNo">3208</span>    }<a name="line.3208"></a>
<span class="sourceLineNo">3209</span><a name="line.3209"></a>
<span class="sourceLineNo">3210</span>    /**<a name="line.3210"></a>
<span class="sourceLineNo">3211</span>     * plays random cave ambient sounds and runs updateTick on random blocks within each chunk in the vacinity of a<a name="line.3211"></a>
<span class="sourceLineNo">3212</span>     * player<a name="line.3212"></a>
<span class="sourceLineNo">3213</span>     */<a name="line.3213"></a>
<span class="sourceLineNo">3214</span>    protected void tickBlocksAndAmbiance()<a name="line.3214"></a>
<span class="sourceLineNo">3215</span>    {<a name="line.3215"></a>
<span class="sourceLineNo">3216</span>        this.setActivePlayerChunksAndCheckLight();<a name="line.3216"></a>
<span class="sourceLineNo">3217</span>    }<a name="line.3217"></a>
<span class="sourceLineNo">3218</span><a name="line.3218"></a>
<span class="sourceLineNo">3219</span>    /**<a name="line.3219"></a>
<span class="sourceLineNo">3220</span>     * checks to see if a given block is both water and is cold enough to freeze<a name="line.3220"></a>
<span class="sourceLineNo">3221</span>     */<a name="line.3221"></a>
<span class="sourceLineNo">3222</span>    public boolean isBlockFreezable(int par1, int par2, int par3)<a name="line.3222"></a>
<span class="sourceLineNo">3223</span>    {<a name="line.3223"></a>
<span class="sourceLineNo">3224</span>        return this.canBlockFreeze(par1, par2, par3, false);<a name="line.3224"></a>
<span class="sourceLineNo">3225</span>    }<a name="line.3225"></a>
<span class="sourceLineNo">3226</span><a name="line.3226"></a>
<span class="sourceLineNo">3227</span>    /**<a name="line.3227"></a>
<span class="sourceLineNo">3228</span>     * checks to see if a given block is both water and has at least one immediately adjacent non-water block<a name="line.3228"></a>
<span class="sourceLineNo">3229</span>     */<a name="line.3229"></a>
<span class="sourceLineNo">3230</span>    public boolean isBlockFreezableNaturally(int par1, int par2, int par3)<a name="line.3230"></a>
<span class="sourceLineNo">3231</span>    {<a name="line.3231"></a>
<span class="sourceLineNo">3232</span>        return this.canBlockFreeze(par1, par2, par3, true);<a name="line.3232"></a>
<span class="sourceLineNo">3233</span>    }<a name="line.3233"></a>
<span class="sourceLineNo">3234</span><a name="line.3234"></a>
<span class="sourceLineNo">3235</span>    /**<a name="line.3235"></a>
<span class="sourceLineNo">3236</span>     * checks to see if a given block is both water, and cold enough to freeze - if the par4 boolean is set, this will<a name="line.3236"></a>
<span class="sourceLineNo">3237</span>     * only return true if there is a non-water block immediately adjacent to the specified block<a name="line.3237"></a>
<span class="sourceLineNo">3238</span>     */<a name="line.3238"></a>
<span class="sourceLineNo">3239</span>    public boolean canBlockFreeze(int par1, int par2, int par3, boolean par4)<a name="line.3239"></a>
<span class="sourceLineNo">3240</span>    {<a name="line.3240"></a>
<span class="sourceLineNo">3241</span>        return provider.canBlockFreeze(par1, par2, par3, par4);<a name="line.3241"></a>
<span class="sourceLineNo">3242</span>    }<a name="line.3242"></a>
<span class="sourceLineNo">3243</span><a name="line.3243"></a>
<span class="sourceLineNo">3244</span>    public boolean canBlockFreezeBody(int par1, int par2, int par3, boolean par4)<a name="line.3244"></a>
<span class="sourceLineNo">3245</span>    {<a name="line.3245"></a>
<span class="sourceLineNo">3246</span>        BiomeGenBase biomegenbase = this.getBiomeGenForCoords(par1, par3);<a name="line.3246"></a>
<span class="sourceLineNo">3247</span>        float f = biomegenbase.getFloatTemperature();<a name="line.3247"></a>
<span class="sourceLineNo">3248</span><a name="line.3248"></a>
<span class="sourceLineNo">3249</span>        if (f &gt; 0.15F)<a name="line.3249"></a>
<span class="sourceLineNo">3250</span>        {<a name="line.3250"></a>
<span class="sourceLineNo">3251</span>            return false;<a name="line.3251"></a>
<span class="sourceLineNo">3252</span>        }<a name="line.3252"></a>
<span class="sourceLineNo">3253</span>        else<a name="line.3253"></a>
<span class="sourceLineNo">3254</span>        {<a name="line.3254"></a>
<span class="sourceLineNo">3255</span>            if (par2 &gt;= 0 &amp;&amp; par2 &lt; 256 &amp;&amp; this.getSavedLightValue(EnumSkyBlock.Block, par1, par2, par3) &lt; 10)<a name="line.3255"></a>
<span class="sourceLineNo">3256</span>            {<a name="line.3256"></a>
<span class="sourceLineNo">3257</span>                int l = this.getBlockId(par1, par2, par3);<a name="line.3257"></a>
<span class="sourceLineNo">3258</span><a name="line.3258"></a>
<span class="sourceLineNo">3259</span>                if ((l == Block.waterStill.blockID || l == Block.waterMoving.blockID) &amp;&amp; this.getBlockMetadata(par1, par2, par3) == 0)<a name="line.3259"></a>
<span class="sourceLineNo">3260</span>                {<a name="line.3260"></a>
<span class="sourceLineNo">3261</span>                    if (!par4)<a name="line.3261"></a>
<span class="sourceLineNo">3262</span>                    {<a name="line.3262"></a>
<span class="sourceLineNo">3263</span>                        return true;<a name="line.3263"></a>
<span class="sourceLineNo">3264</span>                    }<a name="line.3264"></a>
<span class="sourceLineNo">3265</span><a name="line.3265"></a>
<span class="sourceLineNo">3266</span>                    boolean flag1 = true;<a name="line.3266"></a>
<span class="sourceLineNo">3267</span><a name="line.3267"></a>
<span class="sourceLineNo">3268</span>                    if (flag1 &amp;&amp; this.getBlockMaterial(par1 - 1, par2, par3) != Material.water)<a name="line.3268"></a>
<span class="sourceLineNo">3269</span>                    {<a name="line.3269"></a>
<span class="sourceLineNo">3270</span>                        flag1 = false;<a name="line.3270"></a>
<span class="sourceLineNo">3271</span>                    }<a name="line.3271"></a>
<span class="sourceLineNo">3272</span><a name="line.3272"></a>
<span class="sourceLineNo">3273</span>                    if (flag1 &amp;&amp; this.getBlockMaterial(par1 + 1, par2, par3) != Material.water)<a name="line.3273"></a>
<span class="sourceLineNo">3274</span>                    {<a name="line.3274"></a>
<span class="sourceLineNo">3275</span>                        flag1 = false;<a name="line.3275"></a>
<span class="sourceLineNo">3276</span>                    }<a name="line.3276"></a>
<span class="sourceLineNo">3277</span><a name="line.3277"></a>
<span class="sourceLineNo">3278</span>                    if (flag1 &amp;&amp; this.getBlockMaterial(par1, par2, par3 - 1) != Material.water)<a name="line.3278"></a>
<span class="sourceLineNo">3279</span>                    {<a name="line.3279"></a>
<span class="sourceLineNo">3280</span>                        flag1 = false;<a name="line.3280"></a>
<span class="sourceLineNo">3281</span>                    }<a name="line.3281"></a>
<span class="sourceLineNo">3282</span><a name="line.3282"></a>
<span class="sourceLineNo">3283</span>                    if (flag1 &amp;&amp; this.getBlockMaterial(par1, par2, par3 + 1) != Material.water)<a name="line.3283"></a>
<span class="sourceLineNo">3284</span>                    {<a name="line.3284"></a>
<span class="sourceLineNo">3285</span>                        flag1 = false;<a name="line.3285"></a>
<span class="sourceLineNo">3286</span>                    }<a name="line.3286"></a>
<span class="sourceLineNo">3287</span><a name="line.3287"></a>
<span class="sourceLineNo">3288</span>                    if (!flag1)<a name="line.3288"></a>
<span class="sourceLineNo">3289</span>                    {<a name="line.3289"></a>
<span class="sourceLineNo">3290</span>                        return true;<a name="line.3290"></a>
<span class="sourceLineNo">3291</span>                    }<a name="line.3291"></a>
<span class="sourceLineNo">3292</span>                }<a name="line.3292"></a>
<span class="sourceLineNo">3293</span>            }<a name="line.3293"></a>
<span class="sourceLineNo">3294</span><a name="line.3294"></a>
<span class="sourceLineNo">3295</span>            return false;<a name="line.3295"></a>
<span class="sourceLineNo">3296</span>        }<a name="line.3296"></a>
<span class="sourceLineNo">3297</span>    }<a name="line.3297"></a>
<span class="sourceLineNo">3298</span><a name="line.3298"></a>
<span class="sourceLineNo">3299</span>    /**<a name="line.3299"></a>
<span class="sourceLineNo">3300</span>     * Tests whether or not snow can be placed at a given location<a name="line.3300"></a>
<span class="sourceLineNo">3301</span>     */<a name="line.3301"></a>
<span class="sourceLineNo">3302</span>    public boolean canSnowAt(int par1, int par2, int par3)<a name="line.3302"></a>
<span class="sourceLineNo">3303</span>    {<a name="line.3303"></a>
<span class="sourceLineNo">3304</span>        return provider.canSnowAt(par1, par2, par3);<a name="line.3304"></a>
<span class="sourceLineNo">3305</span>    }<a name="line.3305"></a>
<span class="sourceLineNo">3306</span><a name="line.3306"></a>
<span class="sourceLineNo">3307</span>    public boolean canSnowAtBody(int par1, int par2, int par3)<a name="line.3307"></a>
<span class="sourceLineNo">3308</span>    {<a name="line.3308"></a>
<span class="sourceLineNo">3309</span>        BiomeGenBase biomegenbase = this.getBiomeGenForCoords(par1, par3);<a name="line.3309"></a>
<span class="sourceLineNo">3310</span>        float f = biomegenbase.getFloatTemperature();<a name="line.3310"></a>
<span class="sourceLineNo">3311</span><a name="line.3311"></a>
<span class="sourceLineNo">3312</span>        if (f &gt; 0.15F)<a name="line.3312"></a>
<span class="sourceLineNo">3313</span>        {<a name="line.3313"></a>
<span class="sourceLineNo">3314</span>            return false;<a name="line.3314"></a>
<span class="sourceLineNo">3315</span>        }<a name="line.3315"></a>
<span class="sourceLineNo">3316</span>        else<a name="line.3316"></a>
<span class="sourceLineNo">3317</span>        {<a name="line.3317"></a>
<span class="sourceLineNo">3318</span>            if (par2 &gt;= 0 &amp;&amp; par2 &lt; 256 &amp;&amp; this.getSavedLightValue(EnumSkyBlock.Block, par1, par2, par3) &lt; 10)<a name="line.3318"></a>
<span class="sourceLineNo">3319</span>            {<a name="line.3319"></a>
<span class="sourceLineNo">3320</span>                int l = this.getBlockId(par1, par2 - 1, par3);<a name="line.3320"></a>
<span class="sourceLineNo">3321</span>                int i1 = this.getBlockId(par1, par2, par3);<a name="line.3321"></a>
<span class="sourceLineNo">3322</span><a name="line.3322"></a>
<span class="sourceLineNo">3323</span>                if (i1 == 0 &amp;&amp; Block.snow.canPlaceBlockAt(this, par1, par2, par3) &amp;&amp; l != 0 &amp;&amp; l != Block.ice.blockID &amp;&amp; Block.blocksList[l].blockMaterial.blocksMovement())<a name="line.3323"></a>
<span class="sourceLineNo">3324</span>                {<a name="line.3324"></a>
<span class="sourceLineNo">3325</span>                    return true;<a name="line.3325"></a>
<span class="sourceLineNo">3326</span>                }<a name="line.3326"></a>
<span class="sourceLineNo">3327</span>            }<a name="line.3327"></a>
<span class="sourceLineNo">3328</span><a name="line.3328"></a>
<span class="sourceLineNo">3329</span>            return false;<a name="line.3329"></a>
<span class="sourceLineNo">3330</span>        }<a name="line.3330"></a>
<span class="sourceLineNo">3331</span>    }<a name="line.3331"></a>
<span class="sourceLineNo">3332</span><a name="line.3332"></a>
<span class="sourceLineNo">3333</span>    public void updateAllLightTypes(int par1, int par2, int par3)<a name="line.3333"></a>
<span class="sourceLineNo">3334</span>    {<a name="line.3334"></a>
<span class="sourceLineNo">3335</span>        if (!this.provider.hasNoSky)<a name="line.3335"></a>
<span class="sourceLineNo">3336</span>        {<a name="line.3336"></a>
<span class="sourceLineNo">3337</span>            this.updateLightByType(EnumSkyBlock.Sky, par1, par2, par3);<a name="line.3337"></a>
<span class="sourceLineNo">3338</span>        }<a name="line.3338"></a>
<span class="sourceLineNo">3339</span><a name="line.3339"></a>
<span class="sourceLineNo">3340</span>        this.updateLightByType(EnumSkyBlock.Block, par1, par2, par3);<a name="line.3340"></a>
<span class="sourceLineNo">3341</span>    }<a name="line.3341"></a>
<span class="sourceLineNo">3342</span><a name="line.3342"></a>
<span class="sourceLineNo">3343</span>    private int func_98179_a(int par1, int par2, int par3, EnumSkyBlock par4EnumSkyBlock)<a name="line.3343"></a>
<span class="sourceLineNo">3344</span>    {<a name="line.3344"></a>
<span class="sourceLineNo">3345</span>        if (par4EnumSkyBlock == EnumSkyBlock.Sky &amp;&amp; this.canBlockSeeTheSky(par1, par2, par3))<a name="line.3345"></a>
<span class="sourceLineNo">3346</span>        {<a name="line.3346"></a>
<span class="sourceLineNo">3347</span>            return 15;<a name="line.3347"></a>
<span class="sourceLineNo">3348</span>        }<a name="line.3348"></a>
<span class="sourceLineNo">3349</span>        else<a name="line.3349"></a>
<span class="sourceLineNo">3350</span>        {<a name="line.3350"></a>
<span class="sourceLineNo">3351</span>            int l = this.getBlockId(par1, par2, par3);<a name="line.3351"></a>
<span class="sourceLineNo">3352</span>            Block block = Block.blocksList[l];<a name="line.3352"></a>
<span class="sourceLineNo">3353</span>            int blockLight = (block == null ? 0 : block.getLightValue(this, par1, par2, par3));<a name="line.3353"></a>
<span class="sourceLineNo">3354</span>            int i1 = par4EnumSkyBlock == EnumSkyBlock.Sky ? 0 : blockLight;<a name="line.3354"></a>
<span class="sourceLineNo">3355</span>            int j1 = (block == null ? 0 : block.getLightOpacity(this, par1, par2, par3));<a name="line.3355"></a>
<span class="sourceLineNo">3356</span><a name="line.3356"></a>
<span class="sourceLineNo">3357</span>            if (j1 &gt;= 15 &amp;&amp; blockLight &gt; 0)<a name="line.3357"></a>
<span class="sourceLineNo">3358</span>            {<a name="line.3358"></a>
<span class="sourceLineNo">3359</span>                j1 = 1;<a name="line.3359"></a>
<span class="sourceLineNo">3360</span>            }<a name="line.3360"></a>
<span class="sourceLineNo">3361</span><a name="line.3361"></a>
<span class="sourceLineNo">3362</span>            if (j1 &lt; 1)<a name="line.3362"></a>
<span class="sourceLineNo">3363</span>            {<a name="line.3363"></a>
<span class="sourceLineNo">3364</span>                j1 = 1;<a name="line.3364"></a>
<span class="sourceLineNo">3365</span>            }<a name="line.3365"></a>
<span class="sourceLineNo">3366</span><a name="line.3366"></a>
<span class="sourceLineNo">3367</span>            if (j1 &gt;= 15)<a name="line.3367"></a>
<span class="sourceLineNo">3368</span>            {<a name="line.3368"></a>
<span class="sourceLineNo">3369</span>                return 0;<a name="line.3369"></a>
<span class="sourceLineNo">3370</span>            }<a name="line.3370"></a>
<span class="sourceLineNo">3371</span>            else if (i1 &gt;= 14)<a name="line.3371"></a>
<span class="sourceLineNo">3372</span>            {<a name="line.3372"></a>
<span class="sourceLineNo">3373</span>                return i1;<a name="line.3373"></a>
<span class="sourceLineNo">3374</span>            }<a name="line.3374"></a>
<span class="sourceLineNo">3375</span>            else<a name="line.3375"></a>
<span class="sourceLineNo">3376</span>            {<a name="line.3376"></a>
<span class="sourceLineNo">3377</span>                for (int k1 = 0; k1 &lt; 6; ++k1)<a name="line.3377"></a>
<span class="sourceLineNo">3378</span>                {<a name="line.3378"></a>
<span class="sourceLineNo">3379</span>                    int l1 = par1 + Facing.offsetsXForSide[k1];<a name="line.3379"></a>
<span class="sourceLineNo">3380</span>                    int i2 = par2 + Facing.offsetsYForSide[k1];<a name="line.3380"></a>
<span class="sourceLineNo">3381</span>                    int j2 = par3 + Facing.offsetsZForSide[k1];<a name="line.3381"></a>
<span class="sourceLineNo">3382</span>                    int k2 = this.getSavedLightValue(par4EnumSkyBlock, l1, i2, j2) - j1;<a name="line.3382"></a>
<span class="sourceLineNo">3383</span><a name="line.3383"></a>
<span class="sourceLineNo">3384</span>                    if (k2 &gt; i1)<a name="line.3384"></a>
<span class="sourceLineNo">3385</span>                    {<a name="line.3385"></a>
<span class="sourceLineNo">3386</span>                        i1 = k2;<a name="line.3386"></a>
<span class="sourceLineNo">3387</span>                    }<a name="line.3387"></a>
<span class="sourceLineNo">3388</span><a name="line.3388"></a>
<span class="sourceLineNo">3389</span>                    if (i1 &gt;= 14)<a name="line.3389"></a>
<span class="sourceLineNo">3390</span>                    {<a name="line.3390"></a>
<span class="sourceLineNo">3391</span>                        return i1;<a name="line.3391"></a>
<span class="sourceLineNo">3392</span>                    }<a name="line.3392"></a>
<span class="sourceLineNo">3393</span>                }<a name="line.3393"></a>
<span class="sourceLineNo">3394</span><a name="line.3394"></a>
<span class="sourceLineNo">3395</span>                return i1;<a name="line.3395"></a>
<span class="sourceLineNo">3396</span>            }<a name="line.3396"></a>
<span class="sourceLineNo">3397</span>        }<a name="line.3397"></a>
<span class="sourceLineNo">3398</span>    }<a name="line.3398"></a>
<span class="sourceLineNo">3399</span><a name="line.3399"></a>
<span class="sourceLineNo">3400</span>    public void updateLightByType(EnumSkyBlock par1EnumSkyBlock, int par2, int par3, int par4)<a name="line.3400"></a>
<span class="sourceLineNo">3401</span>    {<a name="line.3401"></a>
<span class="sourceLineNo">3402</span>        if (this.doChunksNearChunkExist(par2, par3, par4, 17))<a name="line.3402"></a>
<span class="sourceLineNo">3403</span>        {<a name="line.3403"></a>
<span class="sourceLineNo">3404</span>            int l = 0;<a name="line.3404"></a>
<span class="sourceLineNo">3405</span>            int i1 = 0;<a name="line.3405"></a>
<span class="sourceLineNo">3406</span>            this.theProfiler.startSection("getBrightness");<a name="line.3406"></a>
<span class="sourceLineNo">3407</span>            int j1 = this.getSavedLightValue(par1EnumSkyBlock, par2, par3, par4);<a name="line.3407"></a>
<span class="sourceLineNo">3408</span>            int k1 = this.func_98179_a(par2, par3, par4, par1EnumSkyBlock);<a name="line.3408"></a>
<span class="sourceLineNo">3409</span>            int l1;<a name="line.3409"></a>
<span class="sourceLineNo">3410</span>            int i2;<a name="line.3410"></a>
<span class="sourceLineNo">3411</span>            int j2;<a name="line.3411"></a>
<span class="sourceLineNo">3412</span>            int k2;<a name="line.3412"></a>
<span class="sourceLineNo">3413</span>            int l2;<a name="line.3413"></a>
<span class="sourceLineNo">3414</span>            int i3;<a name="line.3414"></a>
<span class="sourceLineNo">3415</span>            int j3;<a name="line.3415"></a>
<span class="sourceLineNo">3416</span>            int k3;<a name="line.3416"></a>
<span class="sourceLineNo">3417</span>            int l3;<a name="line.3417"></a>
<span class="sourceLineNo">3418</span><a name="line.3418"></a>
<span class="sourceLineNo">3419</span>            if (k1 &gt; j1)<a name="line.3419"></a>
<span class="sourceLineNo">3420</span>            {<a name="line.3420"></a>
<span class="sourceLineNo">3421</span>                this.lightUpdateBlockList[i1++] = 133152;<a name="line.3421"></a>
<span class="sourceLineNo">3422</span>            }<a name="line.3422"></a>
<span class="sourceLineNo">3423</span>            else if (k1 &lt; j1)<a name="line.3423"></a>
<span class="sourceLineNo">3424</span>            {<a name="line.3424"></a>
<span class="sourceLineNo">3425</span>                this.lightUpdateBlockList[i1++] = 133152 | j1 &lt;&lt; 18;<a name="line.3425"></a>
<span class="sourceLineNo">3426</span><a name="line.3426"></a>
<span class="sourceLineNo">3427</span>                while (l &lt; i1)<a name="line.3427"></a>
<span class="sourceLineNo">3428</span>                {<a name="line.3428"></a>
<span class="sourceLineNo">3429</span>                    l1 = this.lightUpdateBlockList[l++];<a name="line.3429"></a>
<span class="sourceLineNo">3430</span>                    i2 = (l1 &amp; 63) - 32 + par2;<a name="line.3430"></a>
<span class="sourceLineNo">3431</span>                    j2 = (l1 &gt;&gt; 6 &amp; 63) - 32 + par3;<a name="line.3431"></a>
<span class="sourceLineNo">3432</span>                    k2 = (l1 &gt;&gt; 12 &amp; 63) - 32 + par4;<a name="line.3432"></a>
<span class="sourceLineNo">3433</span>                    l2 = l1 &gt;&gt; 18 &amp; 15;<a name="line.3433"></a>
<span class="sourceLineNo">3434</span>                    i3 = this.getSavedLightValue(par1EnumSkyBlock, i2, j2, k2);<a name="line.3434"></a>
<span class="sourceLineNo">3435</span><a name="line.3435"></a>
<span class="sourceLineNo">3436</span>                    if (i3 == l2)<a name="line.3436"></a>
<span class="sourceLineNo">3437</span>                    {<a name="line.3437"></a>
<span class="sourceLineNo">3438</span>                        this.setLightValue(par1EnumSkyBlock, i2, j2, k2, 0);<a name="line.3438"></a>
<span class="sourceLineNo">3439</span><a name="line.3439"></a>
<span class="sourceLineNo">3440</span>                        if (l2 &gt; 0)<a name="line.3440"></a>
<span class="sourceLineNo">3441</span>                        {<a name="line.3441"></a>
<span class="sourceLineNo">3442</span>                            j3 = MathHelper.abs_int(i2 - par2);<a name="line.3442"></a>
<span class="sourceLineNo">3443</span>                            l3 = MathHelper.abs_int(j2 - par3);<a name="line.3443"></a>
<span class="sourceLineNo">3444</span>                            k3 = MathHelper.abs_int(k2 - par4);<a name="line.3444"></a>
<span class="sourceLineNo">3445</span><a name="line.3445"></a>
<span class="sourceLineNo">3446</span>                            if (j3 + l3 + k3 &lt; 17)<a name="line.3446"></a>
<span class="sourceLineNo">3447</span>                            {<a name="line.3447"></a>
<span class="sourceLineNo">3448</span>                                for (int i4 = 0; i4 &lt; 6; ++i4)<a name="line.3448"></a>
<span class="sourceLineNo">3449</span>                                {<a name="line.3449"></a>
<span class="sourceLineNo">3450</span>                                    int j4 = i2 + Facing.offsetsXForSide[i4];<a name="line.3450"></a>
<span class="sourceLineNo">3451</span>                                    int k4 = j2 + Facing.offsetsYForSide[i4];<a name="line.3451"></a>
<span class="sourceLineNo">3452</span>                                    int l4 = k2 + Facing.offsetsZForSide[i4];<a name="line.3452"></a>
<span class="sourceLineNo">3453</span>                                    Block block = Block.blocksList[getBlockId(j4, k4, l4)];<a name="line.3453"></a>
<span class="sourceLineNo">3454</span>                                    int blockOpacity = (block == null ? 0 : block.getLightOpacity(this, j4, k4, l4));<a name="line.3454"></a>
<span class="sourceLineNo">3455</span>                                    int i5 = Math.max(1, blockOpacity);<a name="line.3455"></a>
<span class="sourceLineNo">3456</span>                                    i3 = this.getSavedLightValue(par1EnumSkyBlock, j4, k4, l4);<a name="line.3456"></a>
<span class="sourceLineNo">3457</span><a name="line.3457"></a>
<span class="sourceLineNo">3458</span>                                    if (i3 == l2 - i5 &amp;&amp; i1 &lt; this.lightUpdateBlockList.length)<a name="line.3458"></a>
<span class="sourceLineNo">3459</span>                                    {<a name="line.3459"></a>
<span class="sourceLineNo">3460</span>                                        this.lightUpdateBlockList[i1++] = j4 - par2 + 32 | k4 - par3 + 32 &lt;&lt; 6 | l4 - par4 + 32 &lt;&lt; 12 | l2 - i5 &lt;&lt; 18;<a name="line.3460"></a>
<span class="sourceLineNo">3461</span>                                    }<a name="line.3461"></a>
<span class="sourceLineNo">3462</span>                                }<a name="line.3462"></a>
<span class="sourceLineNo">3463</span>                            }<a name="line.3463"></a>
<span class="sourceLineNo">3464</span>                        }<a name="line.3464"></a>
<span class="sourceLineNo">3465</span>                    }<a name="line.3465"></a>
<span class="sourceLineNo">3466</span>                }<a name="line.3466"></a>
<span class="sourceLineNo">3467</span><a name="line.3467"></a>
<span class="sourceLineNo">3468</span>                l = 0;<a name="line.3468"></a>
<span class="sourceLineNo">3469</span>            }<a name="line.3469"></a>
<span class="sourceLineNo">3470</span><a name="line.3470"></a>
<span class="sourceLineNo">3471</span>            this.theProfiler.endSection();<a name="line.3471"></a>
<span class="sourceLineNo">3472</span>            this.theProfiler.startSection("checkedPosition &lt; toCheckCount");<a name="line.3472"></a>
<span class="sourceLineNo">3473</span><a name="line.3473"></a>
<span class="sourceLineNo">3474</span>            while (l &lt; i1)<a name="line.3474"></a>
<span class="sourceLineNo">3475</span>            {<a name="line.3475"></a>
<span class="sourceLineNo">3476</span>                l1 = this.lightUpdateBlockList[l++];<a name="line.3476"></a>
<span class="sourceLineNo">3477</span>                i2 = (l1 &amp; 63) - 32 + par2;<a name="line.3477"></a>
<span class="sourceLineNo">3478</span>                j2 = (l1 &gt;&gt; 6 &amp; 63) - 32 + par3;<a name="line.3478"></a>
<span class="sourceLineNo">3479</span>                k2 = (l1 &gt;&gt; 12 &amp; 63) - 32 + par4;<a name="line.3479"></a>
<span class="sourceLineNo">3480</span>                l2 = this.getSavedLightValue(par1EnumSkyBlock, i2, j2, k2);<a name="line.3480"></a>
<span class="sourceLineNo">3481</span>                i3 = this.func_98179_a(i2, j2, k2, par1EnumSkyBlock);<a name="line.3481"></a>
<span class="sourceLineNo">3482</span><a name="line.3482"></a>
<span class="sourceLineNo">3483</span>                if (i3 != l2)<a name="line.3483"></a>
<span class="sourceLineNo">3484</span>                {<a name="line.3484"></a>
<span class="sourceLineNo">3485</span>                    this.setLightValue(par1EnumSkyBlock, i2, j2, k2, i3);<a name="line.3485"></a>
<span class="sourceLineNo">3486</span><a name="line.3486"></a>
<span class="sourceLineNo">3487</span>                    if (i3 &gt; l2)<a name="line.3487"></a>
<span class="sourceLineNo">3488</span>                    {<a name="line.3488"></a>
<span class="sourceLineNo">3489</span>                        j3 = Math.abs(i2 - par2);<a name="line.3489"></a>
<span class="sourceLineNo">3490</span>                        l3 = Math.abs(j2 - par3);<a name="line.3490"></a>
<span class="sourceLineNo">3491</span>                        k3 = Math.abs(k2 - par4);<a name="line.3491"></a>
<span class="sourceLineNo">3492</span>                        boolean flag = i1 &lt; this.lightUpdateBlockList.length - 6;<a name="line.3492"></a>
<span class="sourceLineNo">3493</span><a name="line.3493"></a>
<span class="sourceLineNo">3494</span>                        if (j3 + l3 + k3 &lt; 17 &amp;&amp; flag)<a name="line.3494"></a>
<span class="sourceLineNo">3495</span>                        {<a name="line.3495"></a>
<span class="sourceLineNo">3496</span>                            if (this.getSavedLightValue(par1EnumSkyBlock, i2 - 1, j2, k2) &lt; i3)<a name="line.3496"></a>
<span class="sourceLineNo">3497</span>                            {<a name="line.3497"></a>
<span class="sourceLineNo">3498</span>                                this.lightUpdateBlockList[i1++] = i2 - 1 - par2 + 32 + (j2 - par3 + 32 &lt;&lt; 6) + (k2 - par4 + 32 &lt;&lt; 12);<a name="line.3498"></a>
<span class="sourceLineNo">3499</span>                            }<a name="line.3499"></a>
<span class="sourceLineNo">3500</span><a name="line.3500"></a>
<span class="sourceLineNo">3501</span>                            if (this.getSavedLightValue(par1EnumSkyBlock, i2 + 1, j2, k2) &lt; i3)<a name="line.3501"></a>
<span class="sourceLineNo">3502</span>                            {<a name="line.3502"></a>
<span class="sourceLineNo">3503</span>                                this.lightUpdateBlockList[i1++] = i2 + 1 - par2 + 32 + (j2 - par3 + 32 &lt;&lt; 6) + (k2 - par4 + 32 &lt;&lt; 12);<a name="line.3503"></a>
<span class="sourceLineNo">3504</span>                            }<a name="line.3504"></a>
<span class="sourceLineNo">3505</span><a name="line.3505"></a>
<span class="sourceLineNo">3506</span>                            if (this.getSavedLightValue(par1EnumSkyBlock, i2, j2 - 1, k2) &lt; i3)<a name="line.3506"></a>
<span class="sourceLineNo">3507</span>                            {<a name="line.3507"></a>
<span class="sourceLineNo">3508</span>                                this.lightUpdateBlockList[i1++] = i2 - par2 + 32 + (j2 - 1 - par3 + 32 &lt;&lt; 6) + (k2 - par4 + 32 &lt;&lt; 12);<a name="line.3508"></a>
<span class="sourceLineNo">3509</span>                            }<a name="line.3509"></a>
<span class="sourceLineNo">3510</span><a name="line.3510"></a>
<span class="sourceLineNo">3511</span>                            if (this.getSavedLightValue(par1EnumSkyBlock, i2, j2 + 1, k2) &lt; i3)<a name="line.3511"></a>
<span class="sourceLineNo">3512</span>                            {<a name="line.3512"></a>
<span class="sourceLineNo">3513</span>                                this.lightUpdateBlockList[i1++] = i2 - par2 + 32 + (j2 + 1 - par3 + 32 &lt;&lt; 6) + (k2 - par4 + 32 &lt;&lt; 12);<a name="line.3513"></a>
<span class="sourceLineNo">3514</span>                            }<a name="line.3514"></a>
<span class="sourceLineNo">3515</span><a name="line.3515"></a>
<span class="sourceLineNo">3516</span>                            if (this.getSavedLightValue(par1EnumSkyBlock, i2, j2, k2 - 1) &lt; i3)<a name="line.3516"></a>
<span class="sourceLineNo">3517</span>                            {<a name="line.3517"></a>
<span class="sourceLineNo">3518</span>                                this.lightUpdateBlockList[i1++] = i2 - par2 + 32 + (j2 - par3 + 32 &lt;&lt; 6) + (k2 - 1 - par4 + 32 &lt;&lt; 12);<a name="line.3518"></a>
<span class="sourceLineNo">3519</span>                            }<a name="line.3519"></a>
<span class="sourceLineNo">3520</span><a name="line.3520"></a>
<span class="sourceLineNo">3521</span>                            if (this.getSavedLightValue(par1EnumSkyBlock, i2, j2, k2 + 1) &lt; i3)<a name="line.3521"></a>
<span class="sourceLineNo">3522</span>                            {<a name="line.3522"></a>
<span class="sourceLineNo">3523</span>                                this.lightUpdateBlockList[i1++] = i2 - par2 + 32 + (j2 - par3 + 32 &lt;&lt; 6) + (k2 + 1 - par4 + 32 &lt;&lt; 12);<a name="line.3523"></a>
<span class="sourceLineNo">3524</span>                            }<a name="line.3524"></a>
<span class="sourceLineNo">3525</span>                        }<a name="line.3525"></a>
<span class="sourceLineNo">3526</span>                    }<a name="line.3526"></a>
<span class="sourceLineNo">3527</span>                }<a name="line.3527"></a>
<span class="sourceLineNo">3528</span>            }<a name="line.3528"></a>
<span class="sourceLineNo">3529</span><a name="line.3529"></a>
<span class="sourceLineNo">3530</span>            this.theProfiler.endSection();<a name="line.3530"></a>
<span class="sourceLineNo">3531</span>        }<a name="line.3531"></a>
<span class="sourceLineNo">3532</span>    }<a name="line.3532"></a>
<span class="sourceLineNo">3533</span><a name="line.3533"></a>
<span class="sourceLineNo">3534</span>    /**<a name="line.3534"></a>
<span class="sourceLineNo">3535</span>     * Runs through the list of updates to run and ticks them<a name="line.3535"></a>
<span class="sourceLineNo">3536</span>     */<a name="line.3536"></a>
<span class="sourceLineNo">3537</span>    public boolean tickUpdates(boolean par1)<a name="line.3537"></a>
<span class="sourceLineNo">3538</span>    {<a name="line.3538"></a>
<span class="sourceLineNo">3539</span>        return false;<a name="line.3539"></a>
<span class="sourceLineNo">3540</span>    }<a name="line.3540"></a>
<span class="sourceLineNo">3541</span><a name="line.3541"></a>
<span class="sourceLineNo">3542</span>    public List getPendingBlockUpdates(Chunk par1Chunk, boolean par2)<a name="line.3542"></a>
<span class="sourceLineNo">3543</span>    {<a name="line.3543"></a>
<span class="sourceLineNo">3544</span>        return null;<a name="line.3544"></a>
<span class="sourceLineNo">3545</span>    }<a name="line.3545"></a>
<span class="sourceLineNo">3546</span><a name="line.3546"></a>
<span class="sourceLineNo">3547</span>    /**<a name="line.3547"></a>
<span class="sourceLineNo">3548</span>     * Will get all entities within the specified AABB excluding the one passed into it. Args: entityToExclude, aabb<a name="line.3548"></a>
<span class="sourceLineNo">3549</span>     */<a name="line.3549"></a>
<span class="sourceLineNo">3550</span>    public List getEntitiesWithinAABBExcludingEntity(Entity par1Entity, AxisAlignedBB par2AxisAlignedBB)<a name="line.3550"></a>
<span class="sourceLineNo">3551</span>    {<a name="line.3551"></a>
<span class="sourceLineNo">3552</span>        return this.func_94576_a(par1Entity, par2AxisAlignedBB, (IEntitySelector)null);<a name="line.3552"></a>
<span class="sourceLineNo">3553</span>    }<a name="line.3553"></a>
<span class="sourceLineNo">3554</span><a name="line.3554"></a>
<span class="sourceLineNo">3555</span>    public List func_94576_a(Entity par1Entity, AxisAlignedBB par2AxisAlignedBB, IEntitySelector par3IEntitySelector)<a name="line.3555"></a>
<span class="sourceLineNo">3556</span>    {<a name="line.3556"></a>
<span class="sourceLineNo">3557</span>        ArrayList arraylist = new ArrayList();<a name="line.3557"></a>
<span class="sourceLineNo">3558</span>        int i = MathHelper.floor_double((par2AxisAlignedBB.minX - MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3558"></a>
<span class="sourceLineNo">3559</span>        int j = MathHelper.floor_double((par2AxisAlignedBB.maxX + MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3559"></a>
<span class="sourceLineNo">3560</span>        int k = MathHelper.floor_double((par2AxisAlignedBB.minZ - MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3560"></a>
<span class="sourceLineNo">3561</span>        int l = MathHelper.floor_double((par2AxisAlignedBB.maxZ + MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3561"></a>
<span class="sourceLineNo">3562</span><a name="line.3562"></a>
<span class="sourceLineNo">3563</span>        for (int i1 = i; i1 &lt;= j; ++i1)<a name="line.3563"></a>
<span class="sourceLineNo">3564</span>        {<a name="line.3564"></a>
<span class="sourceLineNo">3565</span>            for (int j1 = k; j1 &lt;= l; ++j1)<a name="line.3565"></a>
<span class="sourceLineNo">3566</span>            {<a name="line.3566"></a>
<span class="sourceLineNo">3567</span>                if (this.chunkExists(i1, j1))<a name="line.3567"></a>
<span class="sourceLineNo">3568</span>                {<a name="line.3568"></a>
<span class="sourceLineNo">3569</span>                    this.getChunkFromChunkCoords(i1, j1).getEntitiesWithinAABBForEntity(par1Entity, par2AxisAlignedBB, arraylist, par3IEntitySelector);<a name="line.3569"></a>
<span class="sourceLineNo">3570</span>                }<a name="line.3570"></a>
<span class="sourceLineNo">3571</span>            }<a name="line.3571"></a>
<span class="sourceLineNo">3572</span>        }<a name="line.3572"></a>
<span class="sourceLineNo">3573</span><a name="line.3573"></a>
<span class="sourceLineNo">3574</span>        return arraylist;<a name="line.3574"></a>
<span class="sourceLineNo">3575</span>    }<a name="line.3575"></a>
<span class="sourceLineNo">3576</span><a name="line.3576"></a>
<span class="sourceLineNo">3577</span>    /**<a name="line.3577"></a>
<span class="sourceLineNo">3578</span>     * Returns all entities of the specified class type which intersect with the AABB. Args: entityClass, aabb<a name="line.3578"></a>
<span class="sourceLineNo">3579</span>     */<a name="line.3579"></a>
<span class="sourceLineNo">3580</span>    public List getEntitiesWithinAABB(Class par1Class, AxisAlignedBB par2AxisAlignedBB)<a name="line.3580"></a>
<span class="sourceLineNo">3581</span>    {<a name="line.3581"></a>
<span class="sourceLineNo">3582</span>        return this.selectEntitiesWithinAABB(par1Class, par2AxisAlignedBB, (IEntitySelector)null);<a name="line.3582"></a>
<span class="sourceLineNo">3583</span>    }<a name="line.3583"></a>
<span class="sourceLineNo">3584</span><a name="line.3584"></a>
<span class="sourceLineNo">3585</span>    public List selectEntitiesWithinAABB(Class par1Class, AxisAlignedBB par2AxisAlignedBB, IEntitySelector par3IEntitySelector)<a name="line.3585"></a>
<span class="sourceLineNo">3586</span>    {<a name="line.3586"></a>
<span class="sourceLineNo">3587</span>        int i = MathHelper.floor_double((par2AxisAlignedBB.minX - MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3587"></a>
<span class="sourceLineNo">3588</span>        int j = MathHelper.floor_double((par2AxisAlignedBB.maxX + MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3588"></a>
<span class="sourceLineNo">3589</span>        int k = MathHelper.floor_double((par2AxisAlignedBB.minZ - MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3589"></a>
<span class="sourceLineNo">3590</span>        int l = MathHelper.floor_double((par2AxisAlignedBB.maxZ + MAX_ENTITY_RADIUS) / 16.0D);<a name="line.3590"></a>
<span class="sourceLineNo">3591</span>        ArrayList arraylist = new ArrayList();<a name="line.3591"></a>
<span class="sourceLineNo">3592</span><a name="line.3592"></a>
<span class="sourceLineNo">3593</span>        for (int i1 = i; i1 &lt;= j; ++i1)<a name="line.3593"></a>
<span class="sourceLineNo">3594</span>        {<a name="line.3594"></a>
<span class="sourceLineNo">3595</span>            for (int j1 = k; j1 &lt;= l; ++j1)<a name="line.3595"></a>
<span class="sourceLineNo">3596</span>            {<a name="line.3596"></a>
<span class="sourceLineNo">3597</span>                if (this.chunkExists(i1, j1))<a name="line.3597"></a>
<span class="sourceLineNo">3598</span>                {<a name="line.3598"></a>
<span class="sourceLineNo">3599</span>                    this.getChunkFromChunkCoords(i1, j1).getEntitiesOfTypeWithinAAAB(par1Class, par2AxisAlignedBB, arraylist, par3IEntitySelector);<a name="line.3599"></a>
<span class="sourceLineNo">3600</span>                }<a name="line.3600"></a>
<span class="sourceLineNo">3601</span>            }<a name="line.3601"></a>
<span class="sourceLineNo">3602</span>        }<a name="line.3602"></a>
<span class="sourceLineNo">3603</span><a name="line.3603"></a>
<span class="sourceLineNo">3604</span>        return arraylist;<a name="line.3604"></a>
<span class="sourceLineNo">3605</span>    }<a name="line.3605"></a>
<span class="sourceLineNo">3606</span><a name="line.3606"></a>
<span class="sourceLineNo">3607</span>    public Entity findNearestEntityWithinAABB(Class par1Class, AxisAlignedBB par2AxisAlignedBB, Entity par3Entity)<a name="line.3607"></a>
<span class="sourceLineNo">3608</span>    {<a name="line.3608"></a>
<span class="sourceLineNo">3609</span>        List list = this.getEntitiesWithinAABB(par1Class, par2AxisAlignedBB);<a name="line.3609"></a>
<span class="sourceLineNo">3610</span>        Entity entity1 = null;<a name="line.3610"></a>
<span class="sourceLineNo">3611</span>        double d0 = Double.MAX_VALUE;<a name="line.3611"></a>
<span class="sourceLineNo">3612</span><a name="line.3612"></a>
<span class="sourceLineNo">3613</span>        for (int i = 0; i &lt; list.size(); ++i)<a name="line.3613"></a>
<span class="sourceLineNo">3614</span>        {<a name="line.3614"></a>
<span class="sourceLineNo">3615</span>            Entity entity2 = (Entity)list.get(i);<a name="line.3615"></a>
<span class="sourceLineNo">3616</span><a name="line.3616"></a>
<span class="sourceLineNo">3617</span>            if (entity2 != par3Entity)<a name="line.3617"></a>
<span class="sourceLineNo">3618</span>            {<a name="line.3618"></a>
<span class="sourceLineNo">3619</span>                double d1 = par3Entity.getDistanceSqToEntity(entity2);<a name="line.3619"></a>
<span class="sourceLineNo">3620</span><a name="line.3620"></a>
<span class="sourceLineNo">3621</span>                if (d1 &lt;= d0)<a name="line.3621"></a>
<span class="sourceLineNo">3622</span>                {<a name="line.3622"></a>
<span class="sourceLineNo">3623</span>                    entity1 = entity2;<a name="line.3623"></a>
<span class="sourceLineNo">3624</span>                    d0 = d1;<a name="line.3624"></a>
<span class="sourceLineNo">3625</span>                }<a name="line.3625"></a>
<span class="sourceLineNo">3626</span>            }<a name="line.3626"></a>
<span class="sourceLineNo">3627</span>        }<a name="line.3627"></a>
<span class="sourceLineNo">3628</span><a name="line.3628"></a>
<span class="sourceLineNo">3629</span>        return entity1;<a name="line.3629"></a>
<span class="sourceLineNo">3630</span>    }<a name="line.3630"></a>
<span class="sourceLineNo">3631</span><a name="line.3631"></a>
<span class="sourceLineNo">3632</span>    /**<a name="line.3632"></a>
<span class="sourceLineNo">3633</span>     * Returns the Entity with the given ID, or null if it doesn't exist in this World.<a name="line.3633"></a>
<span class="sourceLineNo">3634</span>     */<a name="line.3634"></a>
<span class="sourceLineNo">3635</span>    public abstract Entity getEntityByID(int i);<a name="line.3635"></a>
<span class="sourceLineNo">3636</span><a name="line.3636"></a>
<span class="sourceLineNo">3637</span>    @SideOnly(Side.CLIENT)<a name="line.3637"></a>
<span class="sourceLineNo">3638</span><a name="line.3638"></a>
<span class="sourceLineNo">3639</span>    /**<a name="line.3639"></a>
<span class="sourceLineNo">3640</span>     * Accessor for world Loaded Entity List<a name="line.3640"></a>
<span class="sourceLineNo">3641</span>     */<a name="line.3641"></a>
<span class="sourceLineNo">3642</span>    public List getLoadedEntityList()<a name="line.3642"></a>
<span class="sourceLineNo">3643</span>    {<a name="line.3643"></a>
<span class="sourceLineNo">3644</span>        return this.loadedEntityList;<a name="line.3644"></a>
<span class="sourceLineNo">3645</span>    }<a name="line.3645"></a>
<span class="sourceLineNo">3646</span><a name="line.3646"></a>
<span class="sourceLineNo">3647</span>    /**<a name="line.3647"></a>
<span class="sourceLineNo">3648</span>     * marks the chunk that contains this tilentity as modified and then calls worldAccesses.doNothingWithTileEntity<a name="line.3648"></a>
<span class="sourceLineNo">3649</span>     */<a name="line.3649"></a>
<span class="sourceLineNo">3650</span>    public void updateTileEntityChunkAndDoNothing(int par1, int par2, int par3, TileEntity par4TileEntity)<a name="line.3650"></a>
<span class="sourceLineNo">3651</span>    {<a name="line.3651"></a>
<span class="sourceLineNo">3652</span>        if (this.blockExists(par1, par2, par3))<a name="line.3652"></a>
<span class="sourceLineNo">3653</span>        {<a name="line.3653"></a>
<span class="sourceLineNo">3654</span>            this.getChunkFromBlockCoords(par1, par3).setChunkModified();<a name="line.3654"></a>
<span class="sourceLineNo">3655</span>        }<a name="line.3655"></a>
<span class="sourceLineNo">3656</span>    }<a name="line.3656"></a>
<span class="sourceLineNo">3657</span><a name="line.3657"></a>
<span class="sourceLineNo">3658</span>    /**<a name="line.3658"></a>
<span class="sourceLineNo">3659</span>     * Counts how many entities of an entity class exist in the world. Args: entityClass<a name="line.3659"></a>
<span class="sourceLineNo">3660</span>     */<a name="line.3660"></a>
<span class="sourceLineNo">3661</span>    public int countEntities(Class par1Class)<a name="line.3661"></a>
<span class="sourceLineNo">3662</span>    {<a name="line.3662"></a>
<span class="sourceLineNo">3663</span>        int i = 0;<a name="line.3663"></a>
<span class="sourceLineNo">3664</span><a name="line.3664"></a>
<span class="sourceLineNo">3665</span>        for (int j = 0; j &lt; this.loadedEntityList.size(); ++j)<a name="line.3665"></a>
<span class="sourceLineNo">3666</span>        {<a name="line.3666"></a>
<span class="sourceLineNo">3667</span>            Entity entity = (Entity)this.loadedEntityList.get(j);<a name="line.3667"></a>
<span class="sourceLineNo">3668</span><a name="line.3668"></a>
<span class="sourceLineNo">3669</span>            if (par1Class.isAssignableFrom(entity.getClass()))<a name="line.3669"></a>
<span class="sourceLineNo">3670</span>            {<a name="line.3670"></a>
<span class="sourceLineNo">3671</span>                ++i;<a name="line.3671"></a>
<span class="sourceLineNo">3672</span>            }<a name="line.3672"></a>
<span class="sourceLineNo">3673</span>        }<a name="line.3673"></a>
<span class="sourceLineNo">3674</span><a name="line.3674"></a>
<span class="sourceLineNo">3675</span>        return i;<a name="line.3675"></a>
<span class="sourceLineNo">3676</span>    }<a name="line.3676"></a>
<span class="sourceLineNo">3677</span><a name="line.3677"></a>
<span class="sourceLineNo">3678</span>    /**<a name="line.3678"></a>
<span class="sourceLineNo">3679</span>     * adds entities to the loaded entities list, and loads thier skins.<a name="line.3679"></a>
<span class="sourceLineNo">3680</span>     */<a name="line.3680"></a>
<span class="sourceLineNo">3681</span>    public void addLoadedEntities(List par1List)<a name="line.3681"></a>
<span class="sourceLineNo">3682</span>    {<a name="line.3682"></a>
<span class="sourceLineNo">3683</span>        for (int i = 0; i &lt; par1List.size(); ++i)<a name="line.3683"></a>
<span class="sourceLineNo">3684</span>        {<a name="line.3684"></a>
<span class="sourceLineNo">3685</span>            Entity entity = (Entity)par1List.get(i);<a name="line.3685"></a>
<span class="sourceLineNo">3686</span>            if (!MinecraftForge.EVENT_BUS.post(new EntityJoinWorldEvent(entity, this)))<a name="line.3686"></a>
<span class="sourceLineNo">3687</span>            {<a name="line.3687"></a>
<span class="sourceLineNo">3688</span>                loadedEntityList.add(entity);<a name="line.3688"></a>
<span class="sourceLineNo">3689</span>                this.obtainEntitySkin(entity);<a name="line.3689"></a>
<span class="sourceLineNo">3690</span>            }<a name="line.3690"></a>
<span class="sourceLineNo">3691</span>        }<a name="line.3691"></a>
<span class="sourceLineNo">3692</span>    }<a name="line.3692"></a>
<span class="sourceLineNo">3693</span><a name="line.3693"></a>
<span class="sourceLineNo">3694</span>    /**<a name="line.3694"></a>
<span class="sourceLineNo">3695</span>     * Adds a list of entities to be unloaded on the next pass of World.updateEntities()<a name="line.3695"></a>
<span class="sourceLineNo">3696</span>     */<a name="line.3696"></a>
<span class="sourceLineNo">3697</span>    public void unloadEntities(List par1List)<a name="line.3697"></a>
<span class="sourceLineNo">3698</span>    {<a name="line.3698"></a>
<span class="sourceLineNo">3699</span>        this.unloadedEntityList.addAll(par1List);<a name="line.3699"></a>
<span class="sourceLineNo">3700</span>    }<a name="line.3700"></a>
<span class="sourceLineNo">3701</span><a name="line.3701"></a>
<span class="sourceLineNo">3702</span>    /**<a name="line.3702"></a>
<span class="sourceLineNo">3703</span>     * Returns true if the given Entity can be placed on the given side of the given block position.<a name="line.3703"></a>
<span class="sourceLineNo">3704</span>     */<a name="line.3704"></a>
<span class="sourceLineNo">3705</span>    public boolean canPlaceEntityOnSide(int par1, int par2, int par3, int par4, boolean par5, int par6, Entity par7Entity, ItemStack par8ItemStack)<a name="line.3705"></a>
<span class="sourceLineNo">3706</span>    {<a name="line.3706"></a>
<span class="sourceLineNo">3707</span>        int j1 = this.getBlockId(par2, par3, par4);<a name="line.3707"></a>
<span class="sourceLineNo">3708</span>        Block block = Block.blocksList[j1];<a name="line.3708"></a>
<span class="sourceLineNo">3709</span>        Block block1 = Block.blocksList[par1];<a name="line.3709"></a>
<span class="sourceLineNo">3710</span>        AxisAlignedBB axisalignedbb = block1.getCollisionBoundingBoxFromPool(this, par2, par3, par4);<a name="line.3710"></a>
<span class="sourceLineNo">3711</span><a name="line.3711"></a>
<span class="sourceLineNo">3712</span>        if (par5)<a name="line.3712"></a>
<span class="sourceLineNo">3713</span>        {<a name="line.3713"></a>
<span class="sourceLineNo">3714</span>            axisalignedbb = null;<a name="line.3714"></a>
<span class="sourceLineNo">3715</span>        }<a name="line.3715"></a>
<span class="sourceLineNo">3716</span><a name="line.3716"></a>
<span class="sourceLineNo">3717</span>        if (axisalignedbb != null &amp;&amp; !this.checkIfAABBIsClearExcludingEntity(axisalignedbb, par7Entity))<a name="line.3717"></a>
<span class="sourceLineNo">3718</span>        {<a name="line.3718"></a>
<span class="sourceLineNo">3719</span>            return false;<a name="line.3719"></a>
<span class="sourceLineNo">3720</span>        }<a name="line.3720"></a>
<span class="sourceLineNo">3721</span>        else<a name="line.3721"></a>
<span class="sourceLineNo">3722</span>        {<a name="line.3722"></a>
<span class="sourceLineNo">3723</span>            if (block != null &amp;&amp; (block == Block.waterMoving || block == Block.waterStill || block == Block.lavaMoving || block == Block.lavaStill || block == Block.fire || block.blockMaterial.isReplaceable()))<a name="line.3723"></a>
<span class="sourceLineNo">3724</span>            {<a name="line.3724"></a>
<span class="sourceLineNo">3725</span>                block = null;<a name="line.3725"></a>
<span class="sourceLineNo">3726</span>            }<a name="line.3726"></a>
<span class="sourceLineNo">3727</span><a name="line.3727"></a>
<span class="sourceLineNo">3728</span>            if (block != null &amp;&amp; block.isBlockReplaceable(this, par2, par3, par4))<a name="line.3728"></a>
<span class="sourceLineNo">3729</span>            {<a name="line.3729"></a>
<span class="sourceLineNo">3730</span>                block = null;<a name="line.3730"></a>
<span class="sourceLineNo">3731</span>            }<a name="line.3731"></a>
<span class="sourceLineNo">3732</span><a name="line.3732"></a>
<span class="sourceLineNo">3733</span>            return block != null &amp;&amp; block.blockMaterial == Material.circuits &amp;&amp; block1 == Block.anvil ? true : par1 &gt; 0 &amp;&amp; block == null &amp;&amp; block1.func_94331_a(this, par2, par3, par4, par6, par8ItemStack);<a name="line.3733"></a>
<span class="sourceLineNo">3734</span>        }<a name="line.3734"></a>
<span class="sourceLineNo">3735</span>    }<a name="line.3735"></a>
<span class="sourceLineNo">3736</span><a name="line.3736"></a>
<span class="sourceLineNo">3737</span>    public PathEntity getPathEntityToEntity(Entity par1Entity, Entity par2Entity, float par3, boolean par4, boolean par5, boolean par6, boolean par7)<a name="line.3737"></a>
<span class="sourceLineNo">3738</span>    {<a name="line.3738"></a>
<span class="sourceLineNo">3739</span>        this.theProfiler.startSection("pathfind");<a name="line.3739"></a>
<span class="sourceLineNo">3740</span>        int i = MathHelper.floor_double(par1Entity.posX);<a name="line.3740"></a>
<span class="sourceLineNo">3741</span>        int j = MathHelper.floor_double(par1Entity.posY + 1.0D);<a name="line.3741"></a>
<span class="sourceLineNo">3742</span>        int k = MathHelper.floor_double(par1Entity.posZ);<a name="line.3742"></a>
<span class="sourceLineNo">3743</span>        int l = (int)(par3 + 16.0F);<a name="line.3743"></a>
<span class="sourceLineNo">3744</span>        int i1 = i - l;<a name="line.3744"></a>
<span class="sourceLineNo">3745</span>        int j1 = j - l;<a name="line.3745"></a>
<span class="sourceLineNo">3746</span>        int k1 = k - l;<a name="line.3746"></a>
<span class="sourceLineNo">3747</span>        int l1 = i + l;<a name="line.3747"></a>
<span class="sourceLineNo">3748</span>        int i2 = j + l;<a name="line.3748"></a>
<span class="sourceLineNo">3749</span>        int j2 = k + l;<a name="line.3749"></a>
<span class="sourceLineNo">3750</span>        ChunkCache chunkcache = new ChunkCache(this, i1, j1, k1, l1, i2, j2);<a name="line.3750"></a>
<span class="sourceLineNo">3751</span>        PathEntity pathentity = (new PathFinder(chunkcache, par4, par5, par6, par7)).createEntityPathTo(par1Entity, par2Entity, par3);<a name="line.3751"></a>
<span class="sourceLineNo">3752</span>        this.theProfiler.endSection();<a name="line.3752"></a>
<span class="sourceLineNo">3753</span>        return pathentity;<a name="line.3753"></a>
<span class="sourceLineNo">3754</span>    }<a name="line.3754"></a>
<span class="sourceLineNo">3755</span><a name="line.3755"></a>
<span class="sourceLineNo">3756</span>    public PathEntity getEntityPathToXYZ(Entity par1Entity, int par2, int par3, int par4, float par5, boolean par6, boolean par7, boolean par8, boolean par9)<a name="line.3756"></a>
<span class="sourceLineNo">3757</span>    {<a name="line.3757"></a>
<span class="sourceLineNo">3758</span>        this.theProfiler.startSection("pathfind");<a name="line.3758"></a>
<span class="sourceLineNo">3759</span>        int l = MathHelper.floor_double(par1Entity.posX);<a name="line.3759"></a>
<span class="sourceLineNo">3760</span>        int i1 = MathHelper.floor_double(par1Entity.posY);<a name="line.3760"></a>
<span class="sourceLineNo">3761</span>        int j1 = MathHelper.floor_double(par1Entity.posZ);<a name="line.3761"></a>
<span class="sourceLineNo">3762</span>        int k1 = (int)(par5 + 8.0F);<a name="line.3762"></a>
<span class="sourceLineNo">3763</span>        int l1 = l - k1;<a name="line.3763"></a>
<span class="sourceLineNo">3764</span>        int i2 = i1 - k1;<a name="line.3764"></a>
<span class="sourceLineNo">3765</span>        int j2 = j1 - k1;<a name="line.3765"></a>
<span class="sourceLineNo">3766</span>        int k2 = l + k1;<a name="line.3766"></a>
<span class="sourceLineNo">3767</span>        int l2 = i1 + k1;<a name="line.3767"></a>
<span class="sourceLineNo">3768</span>        int i3 = j1 + k1;<a name="line.3768"></a>
<span class="sourceLineNo">3769</span>        ChunkCache chunkcache = new ChunkCache(this, l1, i2, j2, k2, l2, i3);<a name="line.3769"></a>
<span class="sourceLineNo">3770</span>        PathEntity pathentity = (new PathFinder(chunkcache, par6, par7, par8, par9)).createEntityPathTo(par1Entity, par2, par3, par4, par5);<a name="line.3770"></a>
<span class="sourceLineNo">3771</span>        this.theProfiler.endSection();<a name="line.3771"></a>
<span class="sourceLineNo">3772</span>        return pathentity;<a name="line.3772"></a>
<span class="sourceLineNo">3773</span>    }<a name="line.3773"></a>
<span class="sourceLineNo">3774</span><a name="line.3774"></a>
<span class="sourceLineNo">3775</span>    /**<a name="line.3775"></a>
<span class="sourceLineNo">3776</span>     * Is this block powering in the specified direction Args: x, y, z, direction<a name="line.3776"></a>
<span class="sourceLineNo">3777</span>     */<a name="line.3777"></a>
<span class="sourceLineNo">3778</span>    public int isBlockProvidingPowerTo(int par1, int par2, int par3, int par4)<a name="line.3778"></a>
<span class="sourceLineNo">3779</span>    {<a name="line.3779"></a>
<span class="sourceLineNo">3780</span>        int i1 = this.getBlockId(par1, par2, par3);<a name="line.3780"></a>
<span class="sourceLineNo">3781</span>        return i1 == 0 ? 0 : Block.blocksList[i1].isProvidingStrongPower(this, par1, par2, par3, par4);<a name="line.3781"></a>
<span class="sourceLineNo">3782</span>    }<a name="line.3782"></a>
<span class="sourceLineNo">3783</span><a name="line.3783"></a>
<span class="sourceLineNo">3784</span>    public int func_94577_B(int par1, int par2, int par3)<a name="line.3784"></a>
<span class="sourceLineNo">3785</span>    {<a name="line.3785"></a>
<span class="sourceLineNo">3786</span>        byte b0 = 0;<a name="line.3786"></a>
<span class="sourceLineNo">3787</span>        int l = Math.max(b0, this.isBlockProvidingPowerTo(par1, par2 - 1, par3, 0));<a name="line.3787"></a>
<span class="sourceLineNo">3788</span><a name="line.3788"></a>
<span class="sourceLineNo">3789</span>        if (l &gt;= 15)<a name="line.3789"></a>
<span class="sourceLineNo">3790</span>        {<a name="line.3790"></a>
<span class="sourceLineNo">3791</span>            return l;<a name="line.3791"></a>
<span class="sourceLineNo">3792</span>        }<a name="line.3792"></a>
<span class="sourceLineNo">3793</span>        else<a name="line.3793"></a>
<span class="sourceLineNo">3794</span>        {<a name="line.3794"></a>
<span class="sourceLineNo">3795</span>            l = Math.max(l, this.isBlockProvidingPowerTo(par1, par2 + 1, par3, 1));<a name="line.3795"></a>
<span class="sourceLineNo">3796</span><a name="line.3796"></a>
<span class="sourceLineNo">3797</span>            if (l &gt;= 15)<a name="line.3797"></a>
<span class="sourceLineNo">3798</span>            {<a name="line.3798"></a>
<span class="sourceLineNo">3799</span>                return l;<a name="line.3799"></a>
<span class="sourceLineNo">3800</span>            }<a name="line.3800"></a>
<span class="sourceLineNo">3801</span>            else<a name="line.3801"></a>
<span class="sourceLineNo">3802</span>            {<a name="line.3802"></a>
<span class="sourceLineNo">3803</span>                l = Math.max(l, this.isBlockProvidingPowerTo(par1, par2, par3 - 1, 2));<a name="line.3803"></a>
<span class="sourceLineNo">3804</span><a name="line.3804"></a>
<span class="sourceLineNo">3805</span>                if (l &gt;= 15)<a name="line.3805"></a>
<span class="sourceLineNo">3806</span>                {<a name="line.3806"></a>
<span class="sourceLineNo">3807</span>                    return l;<a name="line.3807"></a>
<span class="sourceLineNo">3808</span>                }<a name="line.3808"></a>
<span class="sourceLineNo">3809</span>                else<a name="line.3809"></a>
<span class="sourceLineNo">3810</span>                {<a name="line.3810"></a>
<span class="sourceLineNo">3811</span>                    l = Math.max(l, this.isBlockProvidingPowerTo(par1, par2, par3 + 1, 3));<a name="line.3811"></a>
<span class="sourceLineNo">3812</span><a name="line.3812"></a>
<span class="sourceLineNo">3813</span>                    if (l &gt;= 15)<a name="line.3813"></a>
<span class="sourceLineNo">3814</span>                    {<a name="line.3814"></a>
<span class="sourceLineNo">3815</span>                        return l;<a name="line.3815"></a>
<span class="sourceLineNo">3816</span>                    }<a name="line.3816"></a>
<span class="sourceLineNo">3817</span>                    else<a name="line.3817"></a>
<span class="sourceLineNo">3818</span>                    {<a name="line.3818"></a>
<span class="sourceLineNo">3819</span>                        l = Math.max(l, this.isBlockProvidingPowerTo(par1 - 1, par2, par3, 4));<a name="line.3819"></a>
<span class="sourceLineNo">3820</span><a name="line.3820"></a>
<span class="sourceLineNo">3821</span>                        if (l &gt;= 15)<a name="line.3821"></a>
<span class="sourceLineNo">3822</span>                        {<a name="line.3822"></a>
<span class="sourceLineNo">3823</span>                            return l;<a name="line.3823"></a>
<span class="sourceLineNo">3824</span>                        }<a name="line.3824"></a>
<span class="sourceLineNo">3825</span>                        else<a name="line.3825"></a>
<span class="sourceLineNo">3826</span>                        {<a name="line.3826"></a>
<span class="sourceLineNo">3827</span>                            l = Math.max(l, this.isBlockProvidingPowerTo(par1 + 1, par2, par3, 5));<a name="line.3827"></a>
<span class="sourceLineNo">3828</span>                            return l &gt;= 15 ? l : l;<a name="line.3828"></a>
<span class="sourceLineNo">3829</span>                        }<a name="line.3829"></a>
<span class="sourceLineNo">3830</span>                    }<a name="line.3830"></a>
<span class="sourceLineNo">3831</span>                }<a name="line.3831"></a>
<span class="sourceLineNo">3832</span>            }<a name="line.3832"></a>
<span class="sourceLineNo">3833</span>        }<a name="line.3833"></a>
<span class="sourceLineNo">3834</span>    }<a name="line.3834"></a>
<span class="sourceLineNo">3835</span><a name="line.3835"></a>
<span class="sourceLineNo">3836</span>    public boolean func_94574_k(int par1, int par2, int par3, int par4)<a name="line.3836"></a>
<span class="sourceLineNo">3837</span>    {<a name="line.3837"></a>
<span class="sourceLineNo">3838</span>        return this.isBlockIndirectlyProvidingPowerTo(par1, par2, par3, par4) &gt; 0;<a name="line.3838"></a>
<span class="sourceLineNo">3839</span>    }<a name="line.3839"></a>
<span class="sourceLineNo">3840</span><a name="line.3840"></a>
<span class="sourceLineNo">3841</span>    /**<a name="line.3841"></a>
<span class="sourceLineNo">3842</span>     * Is a block next to you getting powered (if its an attachable block) or is it providing power directly to you.<a name="line.3842"></a>
<span class="sourceLineNo">3843</span>     * Args: x, y, z, direction<a name="line.3843"></a>
<span class="sourceLineNo">3844</span>     */<a name="line.3844"></a>
<span class="sourceLineNo">3845</span>    public int isBlockIndirectlyProvidingPowerTo(int par1, int par2, int par3, int par4)<a name="line.3845"></a>
<span class="sourceLineNo">3846</span>    {<a name="line.3846"></a>
<span class="sourceLineNo">3847</span>        if (this.isBlockNormalCube(par1, par2, par3))<a name="line.3847"></a>
<span class="sourceLineNo">3848</span>        {<a name="line.3848"></a>
<span class="sourceLineNo">3849</span>            return this.func_94577_B(par1, par2, par3);<a name="line.3849"></a>
<span class="sourceLineNo">3850</span>        }<a name="line.3850"></a>
<span class="sourceLineNo">3851</span>        else<a name="line.3851"></a>
<span class="sourceLineNo">3852</span>        {<a name="line.3852"></a>
<span class="sourceLineNo">3853</span>            int i1 = this.getBlockId(par1, par2, par3);<a name="line.3853"></a>
<span class="sourceLineNo">3854</span>            return i1 == 0 ? 0 : Block.blocksList[i1].isProvidingWeakPower(this, par1, par2, par3, par4);<a name="line.3854"></a>
<span class="sourceLineNo">3855</span>        }<a name="line.3855"></a>
<span class="sourceLineNo">3856</span>    }<a name="line.3856"></a>
<span class="sourceLineNo">3857</span><a name="line.3857"></a>
<span class="sourceLineNo">3858</span>    /**<a name="line.3858"></a>
<span class="sourceLineNo">3859</span>     * Used to see if one of the blocks next to you or your block is getting power from a neighboring block. Used by<a name="line.3859"></a>
<span class="sourceLineNo">3860</span>     * items like TNT or Doors so they don't have redstone going straight into them.  Args: x, y, z<a name="line.3860"></a>
<span class="sourceLineNo">3861</span>     */<a name="line.3861"></a>
<span class="sourceLineNo">3862</span>    public boolean isBlockIndirectlyGettingPowered(int par1, int par2, int par3)<a name="line.3862"></a>
<span class="sourceLineNo">3863</span>    {<a name="line.3863"></a>
<span class="sourceLineNo">3864</span>        return this.isBlockIndirectlyProvidingPowerTo(par1, par2 - 1, par3, 0) &gt; 0 ? true : (this.isBlockIndirectlyProvidingPowerTo(par1, par2 + 1, par3, 1) &gt; 0 ? true : (this.isBlockIndirectlyProvidingPowerTo(par1, par2, par3 - 1, 2) &gt; 0 ? true : (this.isBlockIndirectlyProvidingPowerTo(par1, par2, par3 + 1, 3) &gt; 0 ? true : (this.isBlockIndirectlyProvidingPowerTo(par1 - 1, par2, par3, 4) &gt; 0 ? true : this.isBlockIndirectlyProvidingPowerTo(par1 + 1, par2, par3, 5) &gt; 0))));<a name="line.3864"></a>
<span class="sourceLineNo">3865</span>    }<a name="line.3865"></a>
<span class="sourceLineNo">3866</span><a name="line.3866"></a>
<span class="sourceLineNo">3867</span>    public int func_94572_D(int par1, int par2, int par3)<a name="line.3867"></a>
<span class="sourceLineNo">3868</span>    {<a name="line.3868"></a>
<span class="sourceLineNo">3869</span>        int l = 0;<a name="line.3869"></a>
<span class="sourceLineNo">3870</span><a name="line.3870"></a>
<span class="sourceLineNo">3871</span>        for (int i1 = 0; i1 &lt; 6; ++i1)<a name="line.3871"></a>
<span class="sourceLineNo">3872</span>        {<a name="line.3872"></a>
<span class="sourceLineNo">3873</span>            int j1 = this.isBlockIndirectlyProvidingPowerTo(par1 + Facing.offsetsXForSide[i1], par2 + Facing.offsetsYForSide[i1], par3 + Facing.offsetsZForSide[i1], i1);<a name="line.3873"></a>
<span class="sourceLineNo">3874</span><a name="line.3874"></a>
<span class="sourceLineNo">3875</span>            if (j1 &gt;= 15)<a name="line.3875"></a>
<span class="sourceLineNo">3876</span>            {<a name="line.3876"></a>
<span class="sourceLineNo">3877</span>                return 15;<a name="line.3877"></a>
<span class="sourceLineNo">3878</span>            }<a name="line.3878"></a>
<span class="sourceLineNo">3879</span><a name="line.3879"></a>
<span class="sourceLineNo">3880</span>            if (j1 &gt; l)<a name="line.3880"></a>
<span class="sourceLineNo">3881</span>            {<a name="line.3881"></a>
<span class="sourceLineNo">3882</span>                l = j1;<a name="line.3882"></a>
<span class="sourceLineNo">3883</span>            }<a name="line.3883"></a>
<span class="sourceLineNo">3884</span>        }<a name="line.3884"></a>
<span class="sourceLineNo">3885</span><a name="line.3885"></a>
<span class="sourceLineNo">3886</span>        return l;<a name="line.3886"></a>
<span class="sourceLineNo">3887</span>    }<a name="line.3887"></a>
<span class="sourceLineNo">3888</span><a name="line.3888"></a>
<span class="sourceLineNo">3889</span>    /**<a name="line.3889"></a>
<span class="sourceLineNo">3890</span>     * Gets the closest player to the entity within the specified distance (if distance is less than 0 then ignored).<a name="line.3890"></a>
<span class="sourceLineNo">3891</span>     * Args: entity, dist<a name="line.3891"></a>
<span class="sourceLineNo">3892</span>     */<a name="line.3892"></a>
<span class="sourceLineNo">3893</span>    public EntityPlayer getClosestPlayerToEntity(Entity par1Entity, double par2)<a name="line.3893"></a>
<span class="sourceLineNo">3894</span>    {<a name="line.3894"></a>
<span class="sourceLineNo">3895</span>        return this.getClosestPlayer(par1Entity.posX, par1Entity.posY, par1Entity.posZ, par2);<a name="line.3895"></a>
<span class="sourceLineNo">3896</span>    }<a name="line.3896"></a>
<span class="sourceLineNo">3897</span><a name="line.3897"></a>
<span class="sourceLineNo">3898</span>    /**<a name="line.3898"></a>
<span class="sourceLineNo">3899</span>     * Gets the closest player to the point within the specified distance (distance can be set to less than 0 to not<a name="line.3899"></a>
<span class="sourceLineNo">3900</span>     * limit the distance). Args: x, y, z, dist<a name="line.3900"></a>
<span class="sourceLineNo">3901</span>     */<a name="line.3901"></a>
<span class="sourceLineNo">3902</span>    public EntityPlayer getClosestPlayer(double par1, double par3, double par5, double par7)<a name="line.3902"></a>
<span class="sourceLineNo">3903</span>    {<a name="line.3903"></a>
<span class="sourceLineNo">3904</span>        double d4 = -1.0D;<a name="line.3904"></a>
<span class="sourceLineNo">3905</span>        EntityPlayer entityplayer = null;<a name="line.3905"></a>
<span class="sourceLineNo">3906</span><a name="line.3906"></a>
<span class="sourceLineNo">3907</span>        for (int i = 0; i &lt; this.playerEntities.size(); ++i)<a name="line.3907"></a>
<span class="sourceLineNo">3908</span>        {<a name="line.3908"></a>
<span class="sourceLineNo">3909</span>            EntityPlayer entityplayer1 = (EntityPlayer)this.playerEntities.get(i);<a name="line.3909"></a>
<span class="sourceLineNo">3910</span>            double d5 = entityplayer1.getDistanceSq(par1, par3, par5);<a name="line.3910"></a>
<span class="sourceLineNo">3911</span><a name="line.3911"></a>
<span class="sourceLineNo">3912</span>            if ((par7 &lt; 0.0D || d5 &lt; par7 * par7) &amp;&amp; (d4 == -1.0D || d5 &lt; d4))<a name="line.3912"></a>
<span class="sourceLineNo">3913</span>            {<a name="line.3913"></a>
<span class="sourceLineNo">3914</span>                d4 = d5;<a name="line.3914"></a>
<span class="sourceLineNo">3915</span>                entityplayer = entityplayer1;<a name="line.3915"></a>
<span class="sourceLineNo">3916</span>            }<a name="line.3916"></a>
<span class="sourceLineNo">3917</span>        }<a name="line.3917"></a>
<span class="sourceLineNo">3918</span><a name="line.3918"></a>
<span class="sourceLineNo">3919</span>        return entityplayer;<a name="line.3919"></a>
<span class="sourceLineNo">3920</span>    }<a name="line.3920"></a>
<span class="sourceLineNo">3921</span><a name="line.3921"></a>
<span class="sourceLineNo">3922</span>    /**<a name="line.3922"></a>
<span class="sourceLineNo">3923</span>     * Returns the closest vulnerable player to this entity within the given radius, or null if none is found<a name="line.3923"></a>
<span class="sourceLineNo">3924</span>     */<a name="line.3924"></a>
<span class="sourceLineNo">3925</span>    public EntityPlayer getClosestVulnerablePlayerToEntity(Entity par1Entity, double par2)<a name="line.3925"></a>
<span class="sourceLineNo">3926</span>    {<a name="line.3926"></a>
<span class="sourceLineNo">3927</span>        return this.getClosestVulnerablePlayer(par1Entity.posX, par1Entity.posY, par1Entity.posZ, par2);<a name="line.3927"></a>
<span class="sourceLineNo">3928</span>    }<a name="line.3928"></a>
<span class="sourceLineNo">3929</span><a name="line.3929"></a>
<span class="sourceLineNo">3930</span>    /**<a name="line.3930"></a>
<span class="sourceLineNo">3931</span>     * Returns the closest vulnerable player within the given radius, or null if none is found.<a name="line.3931"></a>
<span class="sourceLineNo">3932</span>     */<a name="line.3932"></a>
<span class="sourceLineNo">3933</span>    public EntityPlayer getClosestVulnerablePlayer(double par1, double par3, double par5, double par7)<a name="line.3933"></a>
<span class="sourceLineNo">3934</span>    {<a name="line.3934"></a>
<span class="sourceLineNo">3935</span>        double d4 = -1.0D;<a name="line.3935"></a>
<span class="sourceLineNo">3936</span>        EntityPlayer entityplayer = null;<a name="line.3936"></a>
<span class="sourceLineNo">3937</span><a name="line.3937"></a>
<span class="sourceLineNo">3938</span>        for (int i = 0; i &lt; this.playerEntities.size(); ++i)<a name="line.3938"></a>
<span class="sourceLineNo">3939</span>        {<a name="line.3939"></a>
<span class="sourceLineNo">3940</span>            EntityPlayer entityplayer1 = (EntityPlayer)this.playerEntities.get(i);<a name="line.3940"></a>
<span class="sourceLineNo">3941</span><a name="line.3941"></a>
<span class="sourceLineNo">3942</span>            if (!entityplayer1.capabilities.disableDamage &amp;&amp; entityplayer1.isEntityAlive())<a name="line.3942"></a>
<span class="sourceLineNo">3943</span>            {<a name="line.3943"></a>
<span class="sourceLineNo">3944</span>                double d5 = entityplayer1.getDistanceSq(par1, par3, par5);<a name="line.3944"></a>
<span class="sourceLineNo">3945</span>                double d6 = par7;<a name="line.3945"></a>
<span class="sourceLineNo">3946</span><a name="line.3946"></a>
<span class="sourceLineNo">3947</span>                if (entityplayer1.isSneaking())<a name="line.3947"></a>
<span class="sourceLineNo">3948</span>                {<a name="line.3948"></a>
<span class="sourceLineNo">3949</span>                    d6 = par7 * 0.800000011920929D;<a name="line.3949"></a>
<span class="sourceLineNo">3950</span>                }<a name="line.3950"></a>
<span class="sourceLineNo">3951</span><a name="line.3951"></a>
<span class="sourceLineNo">3952</span>                if (entityplayer1.getHasActivePotion())<a name="line.3952"></a>
<span class="sourceLineNo">3953</span>                {<a name="line.3953"></a>
<span class="sourceLineNo">3954</span>                    float f = entityplayer1.func_82243_bO();<a name="line.3954"></a>
<span class="sourceLineNo">3955</span><a name="line.3955"></a>
<span class="sourceLineNo">3956</span>                    if (f &lt; 0.1F)<a name="line.3956"></a>
<span class="sourceLineNo">3957</span>                    {<a name="line.3957"></a>
<span class="sourceLineNo">3958</span>                        f = 0.1F;<a name="line.3958"></a>
<span class="sourceLineNo">3959</span>                    }<a name="line.3959"></a>
<span class="sourceLineNo">3960</span><a name="line.3960"></a>
<span class="sourceLineNo">3961</span>                    d6 *= (double)(0.7F * f);<a name="line.3961"></a>
<span class="sourceLineNo">3962</span>                }<a name="line.3962"></a>
<span class="sourceLineNo">3963</span><a name="line.3963"></a>
<span class="sourceLineNo">3964</span>                if ((par7 &lt; 0.0D || d5 &lt; d6 * d6) &amp;&amp; (d4 == -1.0D || d5 &lt; d4))<a name="line.3964"></a>
<span class="sourceLineNo">3965</span>                {<a name="line.3965"></a>
<span class="sourceLineNo">3966</span>                    d4 = d5;<a name="line.3966"></a>
<span class="sourceLineNo">3967</span>                    entityplayer = entityplayer1;<a name="line.3967"></a>
<span class="sourceLineNo">3968</span>                }<a name="line.3968"></a>
<span class="sourceLineNo">3969</span>            }<a name="line.3969"></a>
<span class="sourceLineNo">3970</span>        }<a name="line.3970"></a>
<span class="sourceLineNo">3971</span><a name="line.3971"></a>
<span class="sourceLineNo">3972</span>        return entityplayer;<a name="line.3972"></a>
<span class="sourceLineNo">3973</span>    }<a name="line.3973"></a>
<span class="sourceLineNo">3974</span><a name="line.3974"></a>
<span class="sourceLineNo">3975</span>    /**<a name="line.3975"></a>
<span class="sourceLineNo">3976</span>     * Find a player by name in this world.<a name="line.3976"></a>
<span class="sourceLineNo">3977</span>     */<a name="line.3977"></a>
<span class="sourceLineNo">3978</span>    public EntityPlayer getPlayerEntityByName(String par1Str)<a name="line.3978"></a>
<span class="sourceLineNo">3979</span>    {<a name="line.3979"></a>
<span class="sourceLineNo">3980</span>        for (int i = 0; i &lt; this.playerEntities.size(); ++i)<a name="line.3980"></a>
<span class="sourceLineNo">3981</span>        {<a name="line.3981"></a>
<span class="sourceLineNo">3982</span>            if (par1Str.equals(((EntityPlayer)this.playerEntities.get(i)).username))<a name="line.3982"></a>
<span class="sourceLineNo">3983</span>            {<a name="line.3983"></a>
<span class="sourceLineNo">3984</span>                return (EntityPlayer)this.playerEntities.get(i);<a name="line.3984"></a>
<span class="sourceLineNo">3985</span>            }<a name="line.3985"></a>
<span class="sourceLineNo">3986</span>        }<a name="line.3986"></a>
<span class="sourceLineNo">3987</span><a name="line.3987"></a>
<span class="sourceLineNo">3988</span>        return null;<a name="line.3988"></a>
<span class="sourceLineNo">3989</span>    }<a name="line.3989"></a>
<span class="sourceLineNo">3990</span><a name="line.3990"></a>
<span class="sourceLineNo">3991</span>    @SideOnly(Side.CLIENT)<a name="line.3991"></a>
<span class="sourceLineNo">3992</span><a name="line.3992"></a>
<span class="sourceLineNo">3993</span>    /**<a name="line.3993"></a>
<span class="sourceLineNo">3994</span>     * If on MP, sends a quitting packet.<a name="line.3994"></a>
<span class="sourceLineNo">3995</span>     */<a name="line.3995"></a>
<span class="sourceLineNo">3996</span>    public void sendQuittingDisconnectingPacket() {}<a name="line.3996"></a>
<span class="sourceLineNo">3997</span><a name="line.3997"></a>
<span class="sourceLineNo">3998</span>    /**<a name="line.3998"></a>
<span class="sourceLineNo">3999</span>     * Checks whether the session lock file was modified by another process<a name="line.3999"></a>
<span class="sourceLineNo">4000</span>     */<a name="line.4000"></a>
<span class="sourceLineNo">4001</span>    public void checkSessionLock() throws MinecraftException<a name="line.4001"></a>
<span class="sourceLineNo">4002</span>    {<a name="line.4002"></a>
<span class="sourceLineNo">4003</span>        this.saveHandler.checkSessionLock();<a name="line.4003"></a>
<span class="sourceLineNo">4004</span>    }<a name="line.4004"></a>
<span class="sourceLineNo">4005</span><a name="line.4005"></a>
<span class="sourceLineNo">4006</span>    @SideOnly(Side.CLIENT)<a name="line.4006"></a>
<span class="sourceLineNo">4007</span>    public void func_82738_a(long par1)<a name="line.4007"></a>
<span class="sourceLineNo">4008</span>    {<a name="line.4008"></a>
<span class="sourceLineNo">4009</span>        this.worldInfo.incrementTotalWorldTime(par1);<a name="line.4009"></a>
<span class="sourceLineNo">4010</span>    }<a name="line.4010"></a>
<span class="sourceLineNo">4011</span><a name="line.4011"></a>
<span class="sourceLineNo">4012</span>    /**<a name="line.4012"></a>
<span class="sourceLineNo">4013</span>     * Retrieve the world seed from level.dat<a name="line.4013"></a>
<span class="sourceLineNo">4014</span>     */<a name="line.4014"></a>
<span class="sourceLineNo">4015</span>    public long getSeed()<a name="line.4015"></a>
<span class="sourceLineNo">4016</span>    {<a name="line.4016"></a>
<span class="sourceLineNo">4017</span>        return provider.getSeed();<a name="line.4017"></a>
<span class="sourceLineNo">4018</span>    }<a name="line.4018"></a>
<span class="sourceLineNo">4019</span><a name="line.4019"></a>
<span class="sourceLineNo">4020</span>    public long getTotalWorldTime()<a name="line.4020"></a>
<span class="sourceLineNo">4021</span>    {<a name="line.4021"></a>
<span class="sourceLineNo">4022</span>        return this.worldInfo.getWorldTotalTime();<a name="line.4022"></a>
<span class="sourceLineNo">4023</span>    }<a name="line.4023"></a>
<span class="sourceLineNo">4024</span><a name="line.4024"></a>
<span class="sourceLineNo">4025</span>    public long getWorldTime()<a name="line.4025"></a>
<span class="sourceLineNo">4026</span>    {<a name="line.4026"></a>
<span class="sourceLineNo">4027</span>        return provider.getWorldTime();<a name="line.4027"></a>
<span class="sourceLineNo">4028</span>    }<a name="line.4028"></a>
<span class="sourceLineNo">4029</span><a name="line.4029"></a>
<span class="sourceLineNo">4030</span>    /**<a name="line.4030"></a>
<span class="sourceLineNo">4031</span>     * Sets the world time.<a name="line.4031"></a>
<span class="sourceLineNo">4032</span>     */<a name="line.4032"></a>
<span class="sourceLineNo">4033</span>    public void setWorldTime(long par1)<a name="line.4033"></a>
<span class="sourceLineNo">4034</span>    {<a name="line.4034"></a>
<span class="sourceLineNo">4035</span>        provider.setWorldTime(par1);<a name="line.4035"></a>
<span class="sourceLineNo">4036</span>    }<a name="line.4036"></a>
<span class="sourceLineNo">4037</span><a name="line.4037"></a>
<span class="sourceLineNo">4038</span>    /**<a name="line.4038"></a>
<span class="sourceLineNo">4039</span>     * Returns the coordinates of the spawn point<a name="line.4039"></a>
<span class="sourceLineNo">4040</span>     */<a name="line.4040"></a>
<span class="sourceLineNo">4041</span>    public ChunkCoordinates getSpawnPoint()<a name="line.4041"></a>
<span class="sourceLineNo">4042</span>    {<a name="line.4042"></a>
<span class="sourceLineNo">4043</span>        return provider.getSpawnPoint();<a name="line.4043"></a>
<span class="sourceLineNo">4044</span>    }<a name="line.4044"></a>
<span class="sourceLineNo">4045</span><a name="line.4045"></a>
<span class="sourceLineNo">4046</span>    @SideOnly(Side.CLIENT)<a name="line.4046"></a>
<span class="sourceLineNo">4047</span>    public void setSpawnLocation(int par1, int par2, int par3)<a name="line.4047"></a>
<span class="sourceLineNo">4048</span>    {<a name="line.4048"></a>
<span class="sourceLineNo">4049</span>        provider.setSpawnPoint(par1, par2, par3);<a name="line.4049"></a>
<span class="sourceLineNo">4050</span>    }<a name="line.4050"></a>
<span class="sourceLineNo">4051</span><a name="line.4051"></a>
<span class="sourceLineNo">4052</span>    @SideOnly(Side.CLIENT)<a name="line.4052"></a>
<span class="sourceLineNo">4053</span><a name="line.4053"></a>
<span class="sourceLineNo">4054</span>    /**<a name="line.4054"></a>
<span class="sourceLineNo">4055</span>     * spwans an entity and loads surrounding chunks<a name="line.4055"></a>
<span class="sourceLineNo">4056</span>     */<a name="line.4056"></a>
<span class="sourceLineNo">4057</span>    public void joinEntityInSurroundings(Entity par1Entity)<a name="line.4057"></a>
<span class="sourceLineNo">4058</span>    {<a name="line.4058"></a>
<span class="sourceLineNo">4059</span>        int i = MathHelper.floor_double(par1Entity.posX / 16.0D);<a name="line.4059"></a>
<span class="sourceLineNo">4060</span>        int j = MathHelper.floor_double(par1Entity.posZ / 16.0D);<a name="line.4060"></a>
<span class="sourceLineNo">4061</span>        byte b0 = 2;<a name="line.4061"></a>
<span class="sourceLineNo">4062</span><a name="line.4062"></a>
<span class="sourceLineNo">4063</span>        for (int k = i - b0; k &lt;= i + b0; ++k)<a name="line.4063"></a>
<span class="sourceLineNo">4064</span>        {<a name="line.4064"></a>
<span class="sourceLineNo">4065</span>            for (int l = j - b0; l &lt;= j + b0; ++l)<a name="line.4065"></a>
<span class="sourceLineNo">4066</span>            {<a name="line.4066"></a>
<span class="sourceLineNo">4067</span>                this.getChunkFromChunkCoords(k, l);<a name="line.4067"></a>
<span class="sourceLineNo">4068</span>            }<a name="line.4068"></a>
<span class="sourceLineNo">4069</span>        }<a name="line.4069"></a>
<span class="sourceLineNo">4070</span><a name="line.4070"></a>
<span class="sourceLineNo">4071</span>        if (!this.loadedEntityList.contains(par1Entity))<a name="line.4071"></a>
<span class="sourceLineNo">4072</span>        {<a name="line.4072"></a>
<span class="sourceLineNo">4073</span>            if (!MinecraftForge.EVENT_BUS.post(new EntityJoinWorldEvent(par1Entity, this)))<a name="line.4073"></a>
<span class="sourceLineNo">4074</span>            {<a name="line.4074"></a>
<span class="sourceLineNo">4075</span>                loadedEntityList.add(par1Entity);<a name="line.4075"></a>
<span class="sourceLineNo">4076</span>            }<a name="line.4076"></a>
<span class="sourceLineNo">4077</span>        }<a name="line.4077"></a>
<span class="sourceLineNo">4078</span>    }<a name="line.4078"></a>
<span class="sourceLineNo">4079</span><a name="line.4079"></a>
<span class="sourceLineNo">4080</span>    /**<a name="line.4080"></a>
<span class="sourceLineNo">4081</span>     * Called when checking if a certain block can be mined or not. The 'spawn safe zone' check is located here.<a name="line.4081"></a>
<span class="sourceLineNo">4082</span>     */<a name="line.4082"></a>
<span class="sourceLineNo">4083</span>    public boolean canMineBlock(EntityPlayer par1EntityPlayer, int par2, int par3, int par4)<a name="line.4083"></a>
<span class="sourceLineNo">4084</span>    {<a name="line.4084"></a>
<span class="sourceLineNo">4085</span>        return provider.canMineBlock(par1EntityPlayer, par2, par3, par4);<a name="line.4085"></a>
<span class="sourceLineNo">4086</span>    }<a name="line.4086"></a>
<span class="sourceLineNo">4087</span><a name="line.4087"></a>
<span class="sourceLineNo">4088</span>    public boolean canMineBlockBody(EntityPlayer par1EntityPlayer, int par2, int par3, int par4)<a name="line.4088"></a>
<span class="sourceLineNo">4089</span>    {<a name="line.4089"></a>
<span class="sourceLineNo">4090</span>        return true;<a name="line.4090"></a>
<span class="sourceLineNo">4091</span>    }<a name="line.4091"></a>
<span class="sourceLineNo">4092</span><a name="line.4092"></a>
<span class="sourceLineNo">4093</span>    /**<a name="line.4093"></a>
<span class="sourceLineNo">4094</span>     * sends a Packet 38 (Entity Status) to all tracked players of that entity<a name="line.4094"></a>
<span class="sourceLineNo">4095</span>     */<a name="line.4095"></a>
<span class="sourceLineNo">4096</span>    public void setEntityState(Entity par1Entity, byte par2) {}<a name="line.4096"></a>
<span class="sourceLineNo">4097</span><a name="line.4097"></a>
<span class="sourceLineNo">4098</span>    /**<a name="line.4098"></a>
<span class="sourceLineNo">4099</span>     * gets the IChunkProvider this world uses.<a name="line.4099"></a>
<span class="sourceLineNo">4100</span>     */<a name="line.4100"></a>
<span class="sourceLineNo">4101</span>    public IChunkProvider getChunkProvider()<a name="line.4101"></a>
<span class="sourceLineNo">4102</span>    {<a name="line.4102"></a>
<span class="sourceLineNo">4103</span>        return this.chunkProvider;<a name="line.4103"></a>
<span class="sourceLineNo">4104</span>    }<a name="line.4104"></a>
<span class="sourceLineNo">4105</span><a name="line.4105"></a>
<span class="sourceLineNo">4106</span>    /**<a name="line.4106"></a>
<span class="sourceLineNo">4107</span>     * Adds a block event with the given Args to the blockEventCache. During the next tick(), the block specified will<a name="line.4107"></a>
<span class="sourceLineNo">4108</span>     * have its onBlockEvent handler called with the given parameters. Args: X,Y,Z, BlockID, EventID, EventParameter<a name="line.4108"></a>
<span class="sourceLineNo">4109</span>     */<a name="line.4109"></a>
<span class="sourceLineNo">4110</span>    public void addBlockEvent(int par1, int par2, int par3, int par4, int par5, int par6)<a name="line.4110"></a>
<span class="sourceLineNo">4111</span>    {<a name="line.4111"></a>
<span class="sourceLineNo">4112</span>        if (par4 &gt; 0)<a name="line.4112"></a>
<span class="sourceLineNo">4113</span>        {<a name="line.4113"></a>
<span class="sourceLineNo">4114</span>            Block.blocksList[par4].onBlockEventReceived(this, par1, par2, par3, par5, par6);<a name="line.4114"></a>
<span class="sourceLineNo">4115</span>        }<a name="line.4115"></a>
<span class="sourceLineNo">4116</span>    }<a name="line.4116"></a>
<span class="sourceLineNo">4117</span><a name="line.4117"></a>
<span class="sourceLineNo">4118</span>    /**<a name="line.4118"></a>
<span class="sourceLineNo">4119</span>     * Returns this world's current save handler<a name="line.4119"></a>
<span class="sourceLineNo">4120</span>     */<a name="line.4120"></a>
<span class="sourceLineNo">4121</span>    public ISaveHandler getSaveHandler()<a name="line.4121"></a>
<span class="sourceLineNo">4122</span>    {<a name="line.4122"></a>
<span class="sourceLineNo">4123</span>        return this.saveHandler;<a name="line.4123"></a>
<span class="sourceLineNo">4124</span>    }<a name="line.4124"></a>
<span class="sourceLineNo">4125</span><a name="line.4125"></a>
<span class="sourceLineNo">4126</span>    /**<a name="line.4126"></a>
<span class="sourceLineNo">4127</span>     * Gets the World's WorldInfo instance<a name="line.4127"></a>
<span class="sourceLineNo">4128</span>     */<a name="line.4128"></a>
<span class="sourceLineNo">4129</span>    public WorldInfo getWorldInfo()<a name="line.4129"></a>
<span class="sourceLineNo">4130</span>    {<a name="line.4130"></a>
<span class="sourceLineNo">4131</span>        return this.worldInfo;<a name="line.4131"></a>
<span class="sourceLineNo">4132</span>    }<a name="line.4132"></a>
<span class="sourceLineNo">4133</span><a name="line.4133"></a>
<span class="sourceLineNo">4134</span>    /**<a name="line.4134"></a>
<span class="sourceLineNo">4135</span>     * Gets the GameRules instance.<a name="line.4135"></a>
<span class="sourceLineNo">4136</span>     */<a name="line.4136"></a>
<span class="sourceLineNo">4137</span>    public GameRules getGameRules()<a name="line.4137"></a>
<span class="sourceLineNo">4138</span>    {<a name="line.4138"></a>
<span class="sourceLineNo">4139</span>        return this.worldInfo.getGameRulesInstance();<a name="line.4139"></a>
<span class="sourceLineNo">4140</span>    }<a name="line.4140"></a>
<span class="sourceLineNo">4141</span><a name="line.4141"></a>
<span class="sourceLineNo">4142</span>    /**<a name="line.4142"></a>
<span class="sourceLineNo">4143</span>     * Updates the flag that indicates whether or not all players in the world are sleeping.<a name="line.4143"></a>
<span class="sourceLineNo">4144</span>     */<a name="line.4144"></a>
<span class="sourceLineNo">4145</span>    public void updateAllPlayersSleepingFlag() {}<a name="line.4145"></a>
<span class="sourceLineNo">4146</span><a name="line.4146"></a>
<span class="sourceLineNo">4147</span>    public float getWeightedThunderStrength(float par1)<a name="line.4147"></a>
<span class="sourceLineNo">4148</span>    {<a name="line.4148"></a>
<span class="sourceLineNo">4149</span>        return (this.prevThunderingStrength + (this.thunderingStrength - this.prevThunderingStrength) * par1) * this.getRainStrength(par1);<a name="line.4149"></a>
<span class="sourceLineNo">4150</span>    }<a name="line.4150"></a>
<span class="sourceLineNo">4151</span><a name="line.4151"></a>
<span class="sourceLineNo">4152</span>    /**<a name="line.4152"></a>
<span class="sourceLineNo">4153</span>     * Not sure about this actually. Reverting this one myself.<a name="line.4153"></a>
<span class="sourceLineNo">4154</span>     */<a name="line.4154"></a>
<span class="sourceLineNo">4155</span>    public float getRainStrength(float par1)<a name="line.4155"></a>
<span class="sourceLineNo">4156</span>    {<a name="line.4156"></a>
<span class="sourceLineNo">4157</span>        return this.prevRainingStrength + (this.rainingStrength - this.prevRainingStrength) * par1;<a name="line.4157"></a>
<span class="sourceLineNo">4158</span>    }<a name="line.4158"></a>
<span class="sourceLineNo">4159</span><a name="line.4159"></a>
<span class="sourceLineNo">4160</span>    @SideOnly(Side.CLIENT)<a name="line.4160"></a>
<span class="sourceLineNo">4161</span>    public void setRainStrength(float par1)<a name="line.4161"></a>
<span class="sourceLineNo">4162</span>    {<a name="line.4162"></a>
<span class="sourceLineNo">4163</span>        this.prevRainingStrength = par1;<a name="line.4163"></a>
<span class="sourceLineNo">4164</span>        this.rainingStrength = par1;<a name="line.4164"></a>
<span class="sourceLineNo">4165</span>    }<a name="line.4165"></a>
<span class="sourceLineNo">4166</span><a name="line.4166"></a>
<span class="sourceLineNo">4167</span>    /**<a name="line.4167"></a>
<span class="sourceLineNo">4168</span>     * Returns true if the current thunder strength (weighted with the rain strength) is greater than 0.9<a name="line.4168"></a>
<span class="sourceLineNo">4169</span>     */<a name="line.4169"></a>
<span class="sourceLineNo">4170</span>    public boolean isThundering()<a name="line.4170"></a>
<span class="sourceLineNo">4171</span>    {<a name="line.4171"></a>
<span class="sourceLineNo">4172</span>        return (double)this.getWeightedThunderStrength(1.0F) &gt; 0.9D;<a name="line.4172"></a>
<span class="sourceLineNo">4173</span>    }<a name="line.4173"></a>
<span class="sourceLineNo">4174</span><a name="line.4174"></a>
<span class="sourceLineNo">4175</span>    /**<a name="line.4175"></a>
<span class="sourceLineNo">4176</span>     * Returns true if the current rain strength is greater than 0.2<a name="line.4176"></a>
<span class="sourceLineNo">4177</span>     */<a name="line.4177"></a>
<span class="sourceLineNo">4178</span>    public boolean isRaining()<a name="line.4178"></a>
<span class="sourceLineNo">4179</span>    {<a name="line.4179"></a>
<span class="sourceLineNo">4180</span>        return (double)this.getRainStrength(1.0F) &gt; 0.2D;<a name="line.4180"></a>
<span class="sourceLineNo">4181</span>    }<a name="line.4181"></a>
<span class="sourceLineNo">4182</span><a name="line.4182"></a>
<span class="sourceLineNo">4183</span>    public boolean canLightningStrikeAt(int par1, int par2, int par3)<a name="line.4183"></a>
<span class="sourceLineNo">4184</span>    {<a name="line.4184"></a>
<span class="sourceLineNo">4185</span>        if (!this.isRaining())<a name="line.4185"></a>
<span class="sourceLineNo">4186</span>        {<a name="line.4186"></a>
<span class="sourceLineNo">4187</span>            return false;<a name="line.4187"></a>
<span class="sourceLineNo">4188</span>        }<a name="line.4188"></a>
<span class="sourceLineNo">4189</span>        else if (!this.canBlockSeeTheSky(par1, par2, par3))<a name="line.4189"></a>
<span class="sourceLineNo">4190</span>        {<a name="line.4190"></a>
<span class="sourceLineNo">4191</span>            return false;<a name="line.4191"></a>
<span class="sourceLineNo">4192</span>        }<a name="line.4192"></a>
<span class="sourceLineNo">4193</span>        else if (this.getPrecipitationHeight(par1, par3) &gt; par2)<a name="line.4193"></a>
<span class="sourceLineNo">4194</span>        {<a name="line.4194"></a>
<span class="sourceLineNo">4195</span>            return false;<a name="line.4195"></a>
<span class="sourceLineNo">4196</span>        }<a name="line.4196"></a>
<span class="sourceLineNo">4197</span>        else<a name="line.4197"></a>
<span class="sourceLineNo">4198</span>        {<a name="line.4198"></a>
<span class="sourceLineNo">4199</span>            BiomeGenBase biomegenbase = this.getBiomeGenForCoords(par1, par3);<a name="line.4199"></a>
<span class="sourceLineNo">4200</span>            return biomegenbase.getEnableSnow() ? false : biomegenbase.canSpawnLightningBolt();<a name="line.4200"></a>
<span class="sourceLineNo">4201</span>        }<a name="line.4201"></a>
<span class="sourceLineNo">4202</span>    }<a name="line.4202"></a>
<span class="sourceLineNo">4203</span><a name="line.4203"></a>
<span class="sourceLineNo">4204</span>    /**<a name="line.4204"></a>
<span class="sourceLineNo">4205</span>     * Checks to see if the biome rainfall values for a given x,y,z coordinate set are extremely high<a name="line.4205"></a>
<span class="sourceLineNo">4206</span>     */<a name="line.4206"></a>
<span class="sourceLineNo">4207</span>    public boolean isBlockHighHumidity(int par1, int par2, int par3)<a name="line.4207"></a>
<span class="sourceLineNo">4208</span>    {<a name="line.4208"></a>
<span class="sourceLineNo">4209</span>        return provider.isBlockHighHumidity(par1, par2, par3);<a name="line.4209"></a>
<span class="sourceLineNo">4210</span>    }<a name="line.4210"></a>
<span class="sourceLineNo">4211</span><a name="line.4211"></a>
<span class="sourceLineNo">4212</span>    /**<a name="line.4212"></a>
<span class="sourceLineNo">4213</span>     * Assigns the given String id to the given MapDataBase using the MapStorage, removing any existing ones of the same<a name="line.4213"></a>
<span class="sourceLineNo">4214</span>     * id.<a name="line.4214"></a>
<span class="sourceLineNo">4215</span>     */<a name="line.4215"></a>
<span class="sourceLineNo">4216</span>    public void setItemData(String par1Str, WorldSavedData par2WorldSavedData)<a name="line.4216"></a>
<span class="sourceLineNo">4217</span>    {<a name="line.4217"></a>
<span class="sourceLineNo">4218</span>        this.mapStorage.setData(par1Str, par2WorldSavedData);<a name="line.4218"></a>
<span class="sourceLineNo">4219</span>    }<a name="line.4219"></a>
<span class="sourceLineNo">4220</span><a name="line.4220"></a>
<span class="sourceLineNo">4221</span>    /**<a name="line.4221"></a>
<span class="sourceLineNo">4222</span>     * Loads an existing MapDataBase corresponding to the given String id from disk using the MapStorage, instantiating<a name="line.4222"></a>
<span class="sourceLineNo">4223</span>     * the given Class, or returns null if none such file exists. args: Class to instantiate, String dataid<a name="line.4223"></a>
<span class="sourceLineNo">4224</span>     */<a name="line.4224"></a>
<span class="sourceLineNo">4225</span>    public WorldSavedData loadItemData(Class par1Class, String par2Str)<a name="line.4225"></a>
<span class="sourceLineNo">4226</span>    {<a name="line.4226"></a>
<span class="sourceLineNo">4227</span>        return this.mapStorage.loadData(par1Class, par2Str);<a name="line.4227"></a>
<span class="sourceLineNo">4228</span>    }<a name="line.4228"></a>
<span class="sourceLineNo">4229</span><a name="line.4229"></a>
<span class="sourceLineNo">4230</span>    /**<a name="line.4230"></a>
<span class="sourceLineNo">4231</span>     * Returns an unique new data id from the MapStorage for the given prefix and saves the idCounts map to the<a name="line.4231"></a>
<span class="sourceLineNo">4232</span>     * 'idcounts' file.<a name="line.4232"></a>
<span class="sourceLineNo">4233</span>     */<a name="line.4233"></a>
<span class="sourceLineNo">4234</span>    public int getUniqueDataId(String par1Str)<a name="line.4234"></a>
<span class="sourceLineNo">4235</span>    {<a name="line.4235"></a>
<span class="sourceLineNo">4236</span>        return this.mapStorage.getUniqueDataId(par1Str);<a name="line.4236"></a>
<span class="sourceLineNo">4237</span>    }<a name="line.4237"></a>
<span class="sourceLineNo">4238</span><a name="line.4238"></a>
<span class="sourceLineNo">4239</span>    public void func_82739_e(int par1, int par2, int par3, int par4, int par5)<a name="line.4239"></a>
<span class="sourceLineNo">4240</span>    {<a name="line.4240"></a>
<span class="sourceLineNo">4241</span>        for (int j1 = 0; j1 &lt; this.worldAccesses.size(); ++j1)<a name="line.4241"></a>
<span class="sourceLineNo">4242</span>        {<a name="line.4242"></a>
<span class="sourceLineNo">4243</span>            ((IWorldAccess)this.worldAccesses.get(j1)).broadcastSound(par1, par2, par3, par4, par5);<a name="line.4243"></a>
<span class="sourceLineNo">4244</span>        }<a name="line.4244"></a>
<span class="sourceLineNo">4245</span>    }<a name="line.4245"></a>
<span class="sourceLineNo">4246</span><a name="line.4246"></a>
<span class="sourceLineNo">4247</span>    /**<a name="line.4247"></a>
<span class="sourceLineNo">4248</span>     * See description for playAuxSFX.<a name="line.4248"></a>
<span class="sourceLineNo">4249</span>     */<a name="line.4249"></a>
<span class="sourceLineNo">4250</span>    public void playAuxSFX(int par1, int par2, int par3, int par4, int par5)<a name="line.4250"></a>
<span class="sourceLineNo">4251</span>    {<a name="line.4251"></a>
<span class="sourceLineNo">4252</span>        this.playAuxSFXAtEntity((EntityPlayer)null, par1, par2, par3, par4, par5);<a name="line.4252"></a>
<span class="sourceLineNo">4253</span>    }<a name="line.4253"></a>
<span class="sourceLineNo">4254</span><a name="line.4254"></a>
<span class="sourceLineNo">4255</span>    /**<a name="line.4255"></a>
<span class="sourceLineNo">4256</span>     * See description for playAuxSFX.<a name="line.4256"></a>
<span class="sourceLineNo">4257</span>     */<a name="line.4257"></a>
<span class="sourceLineNo">4258</span>    public void playAuxSFXAtEntity(EntityPlayer par1EntityPlayer, int par2, int par3, int par4, int par5, int par6)<a name="line.4258"></a>
<span class="sourceLineNo">4259</span>    {<a name="line.4259"></a>
<span class="sourceLineNo">4260</span>        try<a name="line.4260"></a>
<span class="sourceLineNo">4261</span>        {<a name="line.4261"></a>
<span class="sourceLineNo">4262</span>            for (int j1 = 0; j1 &lt; this.worldAccesses.size(); ++j1)<a name="line.4262"></a>
<span class="sourceLineNo">4263</span>            {<a name="line.4263"></a>
<span class="sourceLineNo">4264</span>                ((IWorldAccess)this.worldAccesses.get(j1)).playAuxSFX(par1EntityPlayer, par2, par3, par4, par5, par6);<a name="line.4264"></a>
<span class="sourceLineNo">4265</span>            }<a name="line.4265"></a>
<span class="sourceLineNo">4266</span>        }<a name="line.4266"></a>
<span class="sourceLineNo">4267</span>        catch (Throwable throwable)<a name="line.4267"></a>
<span class="sourceLineNo">4268</span>        {<a name="line.4268"></a>
<span class="sourceLineNo">4269</span>            CrashReport crashreport = CrashReport.makeCrashReport(throwable, "Playing level event");<a name="line.4269"></a>
<span class="sourceLineNo">4270</span>            CrashReportCategory crashreportcategory = crashreport.makeCategory("Level event being played");<a name="line.4270"></a>
<span class="sourceLineNo">4271</span>            crashreportcategory.addCrashSection("Block coordinates", CrashReportCategory.func_85071_a(par3, par4, par5));<a name="line.4271"></a>
<span class="sourceLineNo">4272</span>            crashreportcategory.addCrashSection("Event source", par1EntityPlayer);<a name="line.4272"></a>
<span class="sourceLineNo">4273</span>            crashreportcategory.addCrashSection("Event type", Integer.valueOf(par2));<a name="line.4273"></a>
<span class="sourceLineNo">4274</span>            crashreportcategory.addCrashSection("Event data", Integer.valueOf(par6));<a name="line.4274"></a>
<span class="sourceLineNo">4275</span>            throw new ReportedException(crashreport);<a name="line.4275"></a>
<span class="sourceLineNo">4276</span>        }<a name="line.4276"></a>
<span class="sourceLineNo">4277</span>    }<a name="line.4277"></a>
<span class="sourceLineNo">4278</span><a name="line.4278"></a>
<span class="sourceLineNo">4279</span>    /**<a name="line.4279"></a>
<span class="sourceLineNo">4280</span>     * Returns current world height.<a name="line.4280"></a>
<span class="sourceLineNo">4281</span>     */<a name="line.4281"></a>
<span class="sourceLineNo">4282</span>    public int getHeight()<a name="line.4282"></a>
<span class="sourceLineNo">4283</span>    {<a name="line.4283"></a>
<span class="sourceLineNo">4284</span>        return provider.getHeight();<a name="line.4284"></a>
<span class="sourceLineNo">4285</span>    }<a name="line.4285"></a>
<span class="sourceLineNo">4286</span><a name="line.4286"></a>
<span class="sourceLineNo">4287</span>    /**<a name="line.4287"></a>
<span class="sourceLineNo">4288</span>     * Returns current world height.<a name="line.4288"></a>
<span class="sourceLineNo">4289</span>     */<a name="line.4289"></a>
<span class="sourceLineNo">4290</span>    public int getActualHeight()<a name="line.4290"></a>
<span class="sourceLineNo">4291</span>    {<a name="line.4291"></a>
<span class="sourceLineNo">4292</span>        return provider.getActualHeight();<a name="line.4292"></a>
<span class="sourceLineNo">4293</span>    }<a name="line.4293"></a>
<span class="sourceLineNo">4294</span><a name="line.4294"></a>
<span class="sourceLineNo">4295</span>    public IUpdatePlayerListBox func_82735_a(EntityMinecart par1EntityMinecart)<a name="line.4295"></a>
<span class="sourceLineNo">4296</span>    {<a name="line.4296"></a>
<span class="sourceLineNo">4297</span>        return null;<a name="line.4297"></a>
<span class="sourceLineNo">4298</span>    }<a name="line.4298"></a>
<span class="sourceLineNo">4299</span><a name="line.4299"></a>
<span class="sourceLineNo">4300</span>    /**<a name="line.4300"></a>
<span class="sourceLineNo">4301</span>     * puts the World Random seed to a specific state dependant on the inputs<a name="line.4301"></a>
<span class="sourceLineNo">4302</span>     */<a name="line.4302"></a>
<span class="sourceLineNo">4303</span>    public Random setRandomSeed(int par1, int par2, int par3)<a name="line.4303"></a>
<span class="sourceLineNo">4304</span>    {<a name="line.4304"></a>
<span class="sourceLineNo">4305</span>        long l = (long)par1 * 341873128712L + (long)par2 * 132897987541L + this.getWorldInfo().getSeed() + (long)par3;<a name="line.4305"></a>
<span class="sourceLineNo">4306</span>        this.rand.setSeed(l);<a name="line.4306"></a>
<span class="sourceLineNo">4307</span>        return this.rand;<a name="line.4307"></a>
<span class="sourceLineNo">4308</span>    }<a name="line.4308"></a>
<span class="sourceLineNo">4309</span><a name="line.4309"></a>
<span class="sourceLineNo">4310</span>    /**<a name="line.4310"></a>
<span class="sourceLineNo">4311</span>     * Returns the location of the closest structure of the specified type. If not found returns null.<a name="line.4311"></a>
<span class="sourceLineNo">4312</span>     */<a name="line.4312"></a>
<span class="sourceLineNo">4313</span>    public ChunkPosition findClosestStructure(String par1Str, int par2, int par3, int par4)<a name="line.4313"></a>
<span class="sourceLineNo">4314</span>    {<a name="line.4314"></a>
<span class="sourceLineNo">4315</span>        return this.getChunkProvider().findClosestStructure(this, par1Str, par2, par3, par4);<a name="line.4315"></a>
<span class="sourceLineNo">4316</span>    }<a name="line.4316"></a>
<span class="sourceLineNo">4317</span><a name="line.4317"></a>
<span class="sourceLineNo">4318</span>    @SideOnly(Side.CLIENT)<a name="line.4318"></a>
<span class="sourceLineNo">4319</span><a name="line.4319"></a>
<span class="sourceLineNo">4320</span>    /**<a name="line.4320"></a>
<span class="sourceLineNo">4321</span>     * set by !chunk.getAreLevelsEmpty<a name="line.4321"></a>
<span class="sourceLineNo">4322</span>     */<a name="line.4322"></a>
<span class="sourceLineNo">4323</span>    public boolean extendedLevelsInChunkCache()<a name="line.4323"></a>
<span class="sourceLineNo">4324</span>    {<a name="line.4324"></a>
<span class="sourceLineNo">4325</span>        return false;<a name="line.4325"></a>
<span class="sourceLineNo">4326</span>    }<a name="line.4326"></a>
<span class="sourceLineNo">4327</span><a name="line.4327"></a>
<span class="sourceLineNo">4328</span>    @SideOnly(Side.CLIENT)<a name="line.4328"></a>
<span class="sourceLineNo">4329</span><a name="line.4329"></a>
<span class="sourceLineNo">4330</span>    /**<a name="line.4330"></a>
<span class="sourceLineNo">4331</span>     * Returns horizon height for use in rendering the sky.<a name="line.4331"></a>
<span class="sourceLineNo">4332</span>     */<a name="line.4332"></a>
<span class="sourceLineNo">4333</span>    public double getHorizon()<a name="line.4333"></a>
<span class="sourceLineNo">4334</span>    {<a name="line.4334"></a>
<span class="sourceLineNo">4335</span>        return provider.getHorizon();<a name="line.4335"></a>
<span class="sourceLineNo">4336</span>    }<a name="line.4336"></a>
<span class="sourceLineNo">4337</span><a name="line.4337"></a>
<span class="sourceLineNo">4338</span>    /**<a name="line.4338"></a>
<span class="sourceLineNo">4339</span>     * Adds some basic stats of the world to the given crash report.<a name="line.4339"></a>
<span class="sourceLineNo">4340</span>     */<a name="line.4340"></a>
<span class="sourceLineNo">4341</span>    public CrashReportCategory addWorldInfoToCrashReport(CrashReport par1CrashReport)<a name="line.4341"></a>
<span class="sourceLineNo">4342</span>    {<a name="line.4342"></a>
<span class="sourceLineNo">4343</span>        CrashReportCategory crashreportcategory = par1CrashReport.makeCategoryDepth("Affected level", 1);<a name="line.4343"></a>
<span class="sourceLineNo">4344</span>        crashreportcategory.addCrashSection("Level name", this.worldInfo == null ? "????" : this.worldInfo.getWorldName());<a name="line.4344"></a>
<span class="sourceLineNo">4345</span>        crashreportcategory.addCrashSectionCallable("All players", new CallableLvl2(this));<a name="line.4345"></a>
<span class="sourceLineNo">4346</span>        crashreportcategory.addCrashSectionCallable("Chunk stats", new CallableLvl3(this));<a name="line.4346"></a>
<span class="sourceLineNo">4347</span><a name="line.4347"></a>
<span class="sourceLineNo">4348</span>        try<a name="line.4348"></a>
<span class="sourceLineNo">4349</span>        {<a name="line.4349"></a>
<span class="sourceLineNo">4350</span>            this.worldInfo.addToCrashReport(crashreportcategory);<a name="line.4350"></a>
<span class="sourceLineNo">4351</span>        }<a name="line.4351"></a>
<span class="sourceLineNo">4352</span>        catch (Throwable throwable)<a name="line.4352"></a>
<span class="sourceLineNo">4353</span>        {<a name="line.4353"></a>
<span class="sourceLineNo">4354</span>            crashreportcategory.addCrashSectionThrowable("Level Data Unobtainable", throwable);<a name="line.4354"></a>
<span class="sourceLineNo">4355</span>        }<a name="line.4355"></a>
<span class="sourceLineNo">4356</span><a name="line.4356"></a>
<span class="sourceLineNo">4357</span>        return crashreportcategory;<a name="line.4357"></a>
<span class="sourceLineNo">4358</span>    }<a name="line.4358"></a>
<span class="sourceLineNo">4359</span><a name="line.4359"></a>
<span class="sourceLineNo">4360</span>    /**<a name="line.4360"></a>
<span class="sourceLineNo">4361</span>     * Starts (or continues) destroying a block with given ID at the given coordinates for the given partially destroyed<a name="line.4361"></a>
<span class="sourceLineNo">4362</span>     * value<a name="line.4362"></a>
<span class="sourceLineNo">4363</span>     */<a name="line.4363"></a>
<span class="sourceLineNo">4364</span>    public void destroyBlockInWorldPartially(int par1, int par2, int par3, int par4, int par5)<a name="line.4364"></a>
<span class="sourceLineNo">4365</span>    {<a name="line.4365"></a>
<span class="sourceLineNo">4366</span>        for (int j1 = 0; j1 &lt; this.worldAccesses.size(); ++j1)<a name="line.4366"></a>
<span class="sourceLineNo">4367</span>        {<a name="line.4367"></a>
<span class="sourceLineNo">4368</span>            IWorldAccess iworldaccess = (IWorldAccess)this.worldAccesses.get(j1);<a name="line.4368"></a>
<span class="sourceLineNo">4369</span>            iworldaccess.destroyBlockPartially(par1, par2, par3, par4, par5);<a name="line.4369"></a>
<span class="sourceLineNo">4370</span>        }<a name="line.4370"></a>
<span class="sourceLineNo">4371</span>    }<a name="line.4371"></a>
<span class="sourceLineNo">4372</span><a name="line.4372"></a>
<span class="sourceLineNo">4373</span>    /**<a name="line.4373"></a>
<span class="sourceLineNo">4374</span>     * Return the Vec3Pool object for this world.<a name="line.4374"></a>
<span class="sourceLineNo">4375</span>     */<a name="line.4375"></a>
<span class="sourceLineNo">4376</span>    public Vec3Pool getWorldVec3Pool()<a name="line.4376"></a>
<span class="sourceLineNo">4377</span>    {<a name="line.4377"></a>
<span class="sourceLineNo">4378</span>        return this.vecPool;<a name="line.4378"></a>
<span class="sourceLineNo">4379</span>    }<a name="line.4379"></a>
<span class="sourceLineNo">4380</span><a name="line.4380"></a>
<span class="sourceLineNo">4381</span>    /**<a name="line.4381"></a>
<span class="sourceLineNo">4382</span>     * returns a calendar object containing the current date<a name="line.4382"></a>
<span class="sourceLineNo">4383</span>     */<a name="line.4383"></a>
<span class="sourceLineNo">4384</span>    public Calendar getCurrentDate()<a name="line.4384"></a>
<span class="sourceLineNo">4385</span>    {<a name="line.4385"></a>
<span class="sourceLineNo">4386</span>        if (this.getTotalWorldTime() % 600L == 0L)<a name="line.4386"></a>
<span class="sourceLineNo">4387</span>        {<a name="line.4387"></a>
<span class="sourceLineNo">4388</span>            this.theCalendar.setTimeInMillis(System.currentTimeMillis());<a name="line.4388"></a>
<span class="sourceLineNo">4389</span>        }<a name="line.4389"></a>
<span class="sourceLineNo">4390</span><a name="line.4390"></a>
<span class="sourceLineNo">4391</span>        return this.theCalendar;<a name="line.4391"></a>
<span class="sourceLineNo">4392</span>    }<a name="line.4392"></a>
<span class="sourceLineNo">4393</span><a name="line.4393"></a>
<span class="sourceLineNo">4394</span>    @SideOnly(Side.CLIENT)<a name="line.4394"></a>
<span class="sourceLineNo">4395</span>    public void func_92088_a(double par1, double par3, double par5, double par7, double par9, double par11, NBTTagCompound par13NBTTagCompound) {}<a name="line.4395"></a>
<span class="sourceLineNo">4396</span><a name="line.4396"></a>
<span class="sourceLineNo">4397</span>    public Scoreboard func_96441_U()<a name="line.4397"></a>
<span class="sourceLineNo">4398</span>    {<a name="line.4398"></a>
<span class="sourceLineNo">4399</span>        return this.field_96442_D;<a name="line.4399"></a>
<span class="sourceLineNo">4400</span>    }<a name="line.4400"></a>
<span class="sourceLineNo">4401</span><a name="line.4401"></a>
<span class="sourceLineNo">4402</span>    public void func_96440_m(int par1, int par2, int par3, int par4)<a name="line.4402"></a>
<span class="sourceLineNo">4403</span>    {<a name="line.4403"></a>
<span class="sourceLineNo">4404</span>        for (int i1 = 0; i1 &lt; 4; ++i1)<a name="line.4404"></a>
<span class="sourceLineNo">4405</span>        {<a name="line.4405"></a>
<span class="sourceLineNo">4406</span>            int j1 = par1 + Direction.offsetX[i1];<a name="line.4406"></a>
<span class="sourceLineNo">4407</span>            int k1 = par3 + Direction.offsetZ[i1];<a name="line.4407"></a>
<span class="sourceLineNo">4408</span>            int l1 = this.getBlockId(j1, par2, k1);<a name="line.4408"></a>
<span class="sourceLineNo">4409</span><a name="line.4409"></a>
<span class="sourceLineNo">4410</span>            if (l1 != 0)<a name="line.4410"></a>
<span class="sourceLineNo">4411</span>            {<a name="line.4411"></a>
<span class="sourceLineNo">4412</span>                Block block = Block.blocksList[l1];<a name="line.4412"></a>
<span class="sourceLineNo">4413</span><a name="line.4413"></a>
<span class="sourceLineNo">4414</span>                if (Block.field_94346_cn.func_94487_f(l1))<a name="line.4414"></a>
<span class="sourceLineNo">4415</span>                {<a name="line.4415"></a>
<span class="sourceLineNo">4416</span>                    block.onNeighborBlockChange(this, j1, par2, k1, par4);<a name="line.4416"></a>
<span class="sourceLineNo">4417</span>                }<a name="line.4417"></a>
<span class="sourceLineNo">4418</span>                else if (Block.isNormalCube(l1))<a name="line.4418"></a>
<span class="sourceLineNo">4419</span>                {<a name="line.4419"></a>
<span class="sourceLineNo">4420</span>                    j1 += Direction.offsetX[i1];<a name="line.4420"></a>
<span class="sourceLineNo">4421</span>                    k1 += Direction.offsetZ[i1];<a name="line.4421"></a>
<span class="sourceLineNo">4422</span>                    l1 = this.getBlockId(j1, par2, k1);<a name="line.4422"></a>
<span class="sourceLineNo">4423</span>                    block = Block.blocksList[l1];<a name="line.4423"></a>
<span class="sourceLineNo">4424</span><a name="line.4424"></a>
<span class="sourceLineNo">4425</span>                    if (Block.field_94346_cn.func_94487_f(l1))<a name="line.4425"></a>
<span class="sourceLineNo">4426</span>                    {<a name="line.4426"></a>
<span class="sourceLineNo">4427</span>                        block.onNeighborBlockChange(this, j1, par2, k1, par4);<a name="line.4427"></a>
<span class="sourceLineNo">4428</span>                    }<a name="line.4428"></a>
<span class="sourceLineNo">4429</span>                }<a name="line.4429"></a>
<span class="sourceLineNo">4430</span>            }<a name="line.4430"></a>
<span class="sourceLineNo">4431</span>        }<a name="line.4431"></a>
<span class="sourceLineNo">4432</span>    }<a name="line.4432"></a>
<span class="sourceLineNo">4433</span><a name="line.4433"></a>
<span class="sourceLineNo">4434</span>    public ILogAgent func_98180_V()<a name="line.4434"></a>
<span class="sourceLineNo">4435</span>    {<a name="line.4435"></a>
<span class="sourceLineNo">4436</span>        return this.field_98181_L;<a name="line.4436"></a>
<span class="sourceLineNo">4437</span>    }<a name="line.4437"></a>
<span class="sourceLineNo">4438</span><a name="line.4438"></a>
<span class="sourceLineNo">4439</span>    /**<a name="line.4439"></a>
<span class="sourceLineNo">4440</span>     * Adds a single TileEntity to the world.<a name="line.4440"></a>
<span class="sourceLineNo">4441</span>     * @param entity The TileEntity to be added.<a name="line.4441"></a>
<span class="sourceLineNo">4442</span>     */<a name="line.4442"></a>
<span class="sourceLineNo">4443</span>    public void addTileEntity(TileEntity entity)<a name="line.4443"></a>
<span class="sourceLineNo">4444</span>    {<a name="line.4444"></a>
<span class="sourceLineNo">4445</span>        List dest = scanningTileEntities ? addedTileEntityList : loadedTileEntityList;<a name="line.4445"></a>
<span class="sourceLineNo">4446</span>        if(entity.canUpdate())<a name="line.4446"></a>
<span class="sourceLineNo">4447</span>        {<a name="line.4447"></a>
<span class="sourceLineNo">4448</span>            dest.add(entity);<a name="line.4448"></a>
<span class="sourceLineNo">4449</span>        }<a name="line.4449"></a>
<span class="sourceLineNo">4450</span>    }<a name="line.4450"></a>
<span class="sourceLineNo">4451</span><a name="line.4451"></a>
<span class="sourceLineNo">4452</span>    /**<a name="line.4452"></a>
<span class="sourceLineNo">4453</span>     * Determine if the given block is considered solid on the<a name="line.4453"></a>
<span class="sourceLineNo">4454</span>     * specified side.  Used by placement logic.<a name="line.4454"></a>
<span class="sourceLineNo">4455</span>     *<a name="line.4455"></a>
<span class="sourceLineNo">4456</span>     * @param x Block X Position<a name="line.4456"></a>
<span class="sourceLineNo">4457</span>     * @param y Block Y Position<a name="line.4457"></a>
<span class="sourceLineNo">4458</span>     * @param z Block Z Position<a name="line.4458"></a>
<span class="sourceLineNo">4459</span>     * @param side The Side in question<a name="line.4459"></a>
<span class="sourceLineNo">4460</span>     * @return True if the side is solid<a name="line.4460"></a>
<span class="sourceLineNo">4461</span>     */<a name="line.4461"></a>
<span class="sourceLineNo">4462</span>    public boolean isBlockSolidOnSide(int x, int y, int z, ForgeDirection side)<a name="line.4462"></a>
<span class="sourceLineNo">4463</span>    {<a name="line.4463"></a>
<span class="sourceLineNo">4464</span>        return isBlockSolidOnSide(x, y, z, side, false);<a name="line.4464"></a>
<span class="sourceLineNo">4465</span>    }<a name="line.4465"></a>
<span class="sourceLineNo">4466</span><a name="line.4466"></a>
<span class="sourceLineNo">4467</span>    /**<a name="line.4467"></a>
<span class="sourceLineNo">4468</span>     * Determine if the given block is considered solid on the<a name="line.4468"></a>
<span class="sourceLineNo">4469</span>     * specified side.  Used by placement logic.<a name="line.4469"></a>
<span class="sourceLineNo">4470</span>     *<a name="line.4470"></a>
<span class="sourceLineNo">4471</span>     * @param x Block X Position<a name="line.4471"></a>
<span class="sourceLineNo">4472</span>     * @param y Block Y Position<a name="line.4472"></a>
<span class="sourceLineNo">4473</span>     * @param z Block Z Position<a name="line.4473"></a>
<span class="sourceLineNo">4474</span>     * @param side The Side in question<a name="line.4474"></a>
<span class="sourceLineNo">4475</span>     * @param _default The defult to return if the block doesn't exist.<a name="line.4475"></a>
<span class="sourceLineNo">4476</span>     * @return True if the side is solid<a name="line.4476"></a>
<span class="sourceLineNo">4477</span>     */<a name="line.4477"></a>
<span class="sourceLineNo">4478</span>    public boolean isBlockSolidOnSide(int x, int y, int z, ForgeDirection side, boolean _default)<a name="line.4478"></a>
<span class="sourceLineNo">4479</span>    {<a name="line.4479"></a>
<span class="sourceLineNo">4480</span>        if (x &lt; -30000000 || z &lt; -30000000 || x &gt;= 30000000 || z &gt;= 30000000)<a name="line.4480"></a>
<span class="sourceLineNo">4481</span>        {<a name="line.4481"></a>
<span class="sourceLineNo">4482</span>            return _default;<a name="line.4482"></a>
<span class="sourceLineNo">4483</span>        }<a name="line.4483"></a>
<span class="sourceLineNo">4484</span><a name="line.4484"></a>
<span class="sourceLineNo">4485</span>        Chunk chunk = this.chunkProvider.provideChunk(x &gt;&gt; 4, z &gt;&gt; 4);<a name="line.4485"></a>
<span class="sourceLineNo">4486</span>        if (chunk == null || chunk.isEmpty())<a name="line.4486"></a>
<span class="sourceLineNo">4487</span>        {<a name="line.4487"></a>
<span class="sourceLineNo">4488</span>            return _default;<a name="line.4488"></a>
<span class="sourceLineNo">4489</span>        }<a name="line.4489"></a>
<span class="sourceLineNo">4490</span><a name="line.4490"></a>
<span class="sourceLineNo">4491</span>        Block block = Block.blocksList[getBlockId(x, y, z)];<a name="line.4491"></a>
<span class="sourceLineNo">4492</span>        if(block == null)<a name="line.4492"></a>
<span class="sourceLineNo">4493</span>        {<a name="line.4493"></a>
<span class="sourceLineNo">4494</span>            return false;<a name="line.4494"></a>
<span class="sourceLineNo">4495</span>        }<a name="line.4495"></a>
<span class="sourceLineNo">4496</span><a name="line.4496"></a>
<span class="sourceLineNo">4497</span>        return block.isBlockSolidOnSide(this, x, y, z, side);<a name="line.4497"></a>
<span class="sourceLineNo">4498</span>    }<a name="line.4498"></a>
<span class="sourceLineNo">4499</span><a name="line.4499"></a>
<span class="sourceLineNo">4500</span>    /**<a name="line.4500"></a>
<span class="sourceLineNo">4501</span>     * Get the persistent chunks for this world<a name="line.4501"></a>
<span class="sourceLineNo">4502</span>     *<a name="line.4502"></a>
<span class="sourceLineNo">4503</span>     * @return<a name="line.4503"></a>
<span class="sourceLineNo">4504</span>     */<a name="line.4504"></a>
<span class="sourceLineNo">4505</span>    public ImmutableSetMultimap&lt;ChunkCoordIntPair, Ticket&gt; getPersistentChunks()<a name="line.4505"></a>
<span class="sourceLineNo">4506</span>    {<a name="line.4506"></a>
<span class="sourceLineNo">4507</span>        return ForgeChunkManager.getPersistentChunksFor(this);<a name="line.4507"></a>
<span class="sourceLineNo">4508</span>    }<a name="line.4508"></a>
<span class="sourceLineNo">4509</span><a name="line.4509"></a>
<span class="sourceLineNo">4510</span>    /**<a name="line.4510"></a>
<span class="sourceLineNo">4511</span>     * Readded as it was removed, very useful helper function<a name="line.4511"></a>
<span class="sourceLineNo">4512</span>     * <a name="line.4512"></a>
<span class="sourceLineNo">4513</span>     * @param x X position<a name="line.4513"></a>
<span class="sourceLineNo">4514</span>     * @param y Y Position<a name="line.4514"></a>
<span class="sourceLineNo">4515</span>     * @param z Z Position<a name="line.4515"></a>
<span class="sourceLineNo">4516</span>     * @return The blocks light opacity<a name="line.4516"></a>
<span class="sourceLineNo">4517</span>     */<a name="line.4517"></a>
<span class="sourceLineNo">4518</span>    public int getBlockLightOpacity(int x, int y, int z)<a name="line.4518"></a>
<span class="sourceLineNo">4519</span>    {<a name="line.4519"></a>
<span class="sourceLineNo">4520</span>        if (x &lt; -30000000 || z &lt; -30000000 || x &gt;= 30000000 || z &gt;= 30000000)<a name="line.4520"></a>
<span class="sourceLineNo">4521</span>        {<a name="line.4521"></a>
<span class="sourceLineNo">4522</span>            return 0;<a name="line.4522"></a>
<span class="sourceLineNo">4523</span>        }<a name="line.4523"></a>
<span class="sourceLineNo">4524</span><a name="line.4524"></a>
<span class="sourceLineNo">4525</span>        if (y &lt; 0 || y &gt;= 256)<a name="line.4525"></a>
<span class="sourceLineNo">4526</span>        {<a name="line.4526"></a>
<span class="sourceLineNo">4527</span>            return 0;<a name="line.4527"></a>
<span class="sourceLineNo">4528</span>        }<a name="line.4528"></a>
<span class="sourceLineNo">4529</span><a name="line.4529"></a>
<span class="sourceLineNo">4530</span>        return getChunkFromChunkCoords(x &gt;&gt; 4, z &gt;&gt; 4).getBlockLightOpacity(x &amp; 15, y, z &amp; 15);<a name="line.4530"></a>
<span class="sourceLineNo">4531</span>    }<a name="line.4531"></a>
<span class="sourceLineNo">4532</span><a name="line.4532"></a>
<span class="sourceLineNo">4533</span>    /**<a name="line.4533"></a>
<span class="sourceLineNo">4534</span>     * Returns a count of entities that classify themselves as the specified creature type.<a name="line.4534"></a>
<span class="sourceLineNo">4535</span>     */<a name="line.4535"></a>
<span class="sourceLineNo">4536</span>    public int countEntities(EnumCreatureType type, boolean forSpawnCount)<a name="line.4536"></a>
<span class="sourceLineNo">4537</span>    {<a name="line.4537"></a>
<span class="sourceLineNo">4538</span>        int count = 0;<a name="line.4538"></a>
<span class="sourceLineNo">4539</span>        for (int x = 0; x &lt; loadedEntityList.size(); x++)<a name="line.4539"></a>
<span class="sourceLineNo">4540</span>        {<a name="line.4540"></a>
<span class="sourceLineNo">4541</span>            if (((Entity)loadedEntityList.get(x)).isCreatureType(type, forSpawnCount))<a name="line.4541"></a>
<span class="sourceLineNo">4542</span>            {<a name="line.4542"></a>
<span class="sourceLineNo">4543</span>                count++;<a name="line.4543"></a>
<span class="sourceLineNo">4544</span>            }<a name="line.4544"></a>
<span class="sourceLineNo">4545</span>        }<a name="line.4545"></a>
<span class="sourceLineNo">4546</span>        return count;<a name="line.4546"></a>
<span class="sourceLineNo">4547</span>    }<a name="line.4547"></a>
<span class="sourceLineNo">4548</span>}<a name="line.4548"></a>




























































</pre>
</div>
</body>
</html>
